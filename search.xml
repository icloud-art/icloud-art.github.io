<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Dartè¯­è¨€è¦ç‚¹]]></title>
    <url>%2F2020%2F03%2F01%2FDart%E8%AF%AD%E8%A8%80%E8%A6%81%E7%82%B9%2F</url>
    <content type="text"><![CDATA[å¯¹è±¡ã€æŽ¥å£ã€ç±»ä¸Žmixinå¯¹è±¡çš„åˆ›å»ºæ¯ä¸ªç±»è‡³å°‘æœ‰ä¸€ä¸ªæž„é€ å‡½æ•°ï¼Œæž„é€ å‡½æ•°å¯ä»¥ç”±å¼€å‘è€…æ˜Žç¡®çš„å£°æ˜Žï¼Œæˆ–è€…ä¹Ÿå¯ä»¥éšå¼çš„äº§ç”Ÿã€‚åœ¨æ²¡æœ‰æ˜Žç¡®çš„æž„é€ å‡½æ•°è¢«å£°æ˜Žæ—¶ï¼Œéšå¼æž„é€ å‡½æ•°è®²è¢«åˆ›å»ºï¼Œå®ƒä»¬æ²¡æœ‰å‚æ•°å’Œå‡½æ•°ä½“ã€‚ Dartå®žä¾‹å˜é‡åˆå§‹åŒ–çš„å‡ ç§æ–¹å¼ï¼š 123class Point &#123; var x = 0, y = 0;&#125; æˆ–è€…ä½¿ç”¨æž„é€ å‡½æ•°åˆå§‹åŒ–æ–¹å¼ï¼š 1234class Point &#123; var x , y; Point(this.x, this.y);&#125; æˆ–è€…é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨ï¼š 1234class Point &#123; var x, y; Point(a,b) : x = a, y = b;&#125; æˆ–è€…åœ¨æž„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ï¼š 1234class Point &#123; var x , y ; Point(a,b) &#123;x = a; y = b;&#125;&#125; å¯¹äºŽä¸€ä¸ªæ™®é€šçš„å®žä¾‹å˜é‡ï¼Œå¯ä»¥é€‰æ‹©ä»¥ä¸Šä»»æ„ä¸€ç§æ–¹å¼ï¼Œä½†æ˜¯æœ€åŽä¸€ç§æ–¹å¼ä¸é€‚ç”¨äºŽfinalå®žä¾‹å˜é‡ï¼Œå› ä¸ºfinalå˜é‡æ²¡æœ‰setteræ–¹æ³•ã€‚finalå˜é‡åªèƒ½è¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼Œæ‰€ä»¥å®ƒåªèƒ½åœ¨å‰ä¸‰ç§æ–¹å¼ä¸­é€‰æ‹©ä¸€ç§ã€‚ å®žä¾‹çš„åˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ‰§è¡Œé¡ºåºæŒ‰ç…§ç®­å¤´çš„æ–¹å‘ï¼š ä¸€ä¸ªæž„é€ å‡½æ•°çš„å‡½æ•°ä½“åœ¨å¼€å§‹å‰æ€»æ˜¯éšå«åœ°è¿è¡Œçˆ¶ç±» æž„é€ å‡½æ•°çš„å‡½æ•°ä½“ã€‚ é‡å®šå‘æž„é€ å‡½æ•°é‡å®šå‘æž„é€ å‡½æ•°çš„ç›®çš„æ˜¯æŠŠæ‰§è¡Œé‡å®šå‘åˆ°å¦ä¸€ä¸ªæž„é€ å‡½æ•°ï¼Œåœ¨é‡å®šå‘æž„é€ å‡½æ•°ä¸­ï¼Œå‚æ•°åˆ—è¡¨è·Ÿåœ¨ä¸€ä¸ªå†’å·åŽé¢ï¼Œå¹¶ä»¥this.id(â€¦)çš„å½¢å¼æŒ‡å®šé‡å®šå‘åˆ°å“ªä¸ªæž„é€ å‡½æ•°ã€‚ 123456class Point&#123; var rho, thera; Point.polar(this.rho, this.theta); Point(a, b) : this.polar(sqrt(a * a + b * b), atan(a/b)); ...&#125; å·¥åŽ‚æž„é€ å‡½æ•°åœ¨Dartä¸­ï¼Œä»»æ„æž„é€ å‡½æ•°éƒ½å¯ä»¥è¢«æ›¿æ¢ä¸ºå·¥åŽ‚æ–¹æ³•ï¼Œå¹¶ä¸”å¯¹å®¢æˆ·æ˜¯å®Œå…¨é€æ˜Žçš„ã€‚å·¥åŽ‚æž„é€ å‡½æ•°ç”±factoryå‰ç¼€å¼€å¤´ï¼Œå®ƒçœ‹èµ·æ¥åƒæ™®é€šæž„é€ å‡½æ•°ï¼Œä½†ä»–ä»¬å¯èƒ½æ²¡æœ‰åˆå§‹åŒ–åˆ—è¡¨æˆ–è€…åˆå§‹åŒ–å½¢å¼å‚æ•°ã€‚ç›¸åï¼Œå®ƒä»¬å¿…é¡»æœ‰ä¸€ä¸ªè¿”å›žå¯¹è±¡çš„å‡½æ•°ä½“ã€‚å·¥åŽ‚æž„é€ å‡½æ•°å¯ä»¥ä»Žç¼“å­˜ä¸­è¿”å›žå¯¹è±¡ï¼Œæˆ–é€‰æ‹©åˆ†é…ä¸€ä¸ªå®žä¾‹ã€‚å®ƒç”šè‡³å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸åŒç±»çš„å®žä¾‹ã€‚åªè¦ç”Ÿæˆçš„å¯¹è±¡ç¬¦åˆå½“å‰ç±»çš„æŽ¥å£ï¼Œåˆ™éƒ½ä¼šæŒ‰é¢„æœŸæ‰§è¡Œã€‚ noSuchMethod()Dartä¸­è®¡ç®—éƒ½æ˜¯å›´ç»•å¯¹è±¡æ–¹æ³•çš„è°ƒç”¨ã€‚å¦‚æžœè°ƒç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œåˆ™é»˜è®¤çš„è¡Œä¸ºæ˜¯æŠ›å‡ºNoSuchMethodErroré”™è¯¯ã€‚ä½†æ˜¯ï¼Œå¹¶éžæ€»æ˜¯å¦‚æ­¤ã€‚ å½“è°ƒç”¨ä¸€ä¸ªå®žä¾‹ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ï¼ŒDartè¿è¡Œæ—¶ä¼šè°ƒç”¨å½“å‰å¯¹è±¡çš„noSuchMethod()æ–¹æ³•ã€‚å› ä¸ºObjectç±»noSuchMethod()æ–¹æ³•çš„å®žçŽ°å°±æ˜¯æŠ›å‡ºNoSuchMethodErroré”™è¯¯ã€‚ è¿™ä¸ªæ–¹æ¡ˆçš„æœ‰ç‚¹åœ¨äºŽnoSuchMethod()èƒ½å¤Ÿè¢«é‡å†™ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœä½ è¦å®žçŽ°å¦ä¸ªä¸€å¯¹è±¡çš„ä»£ç†ï¼Œé‚£ä½ å¯ä»¥å®šä¹‰ä»£ç†çš„noSuchMethod()æ–¹æ³•ï¼Œå¹¶æŠŠæ‰€æœ‰çš„è°ƒç”¨éƒ½è½¬å‘ç»™ä»£ç†çš„ç›®æ ‡ã€‚ 1234567class Proxy &#123; final forwardee; Proxy(this.forwardee); noSuchMethod(inv)&#123; return runMethod(forwardee, inv); &#125;&#125; å¸¸é‡å¯¹è±¡ä¸Žå­—æ®µDartæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰çš„å¸¸é‡å¯¹è±¡ã€‚ 1234567class Point&#123; final x, y; const Point(this.x, this.y); ...&#125;const origin = const Point(0,0); ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å·²ç»å°†Pointçš„æž„é€ å‡½æ•°å£°æ˜Žä¸ºå¸¸é‡ã€‚ä¸€ä¸ªæž„é€ å‡½æ•°ä¸èƒ½æœ‰å‡½æ•°ä½“ï¼Œå®ƒå¯ä»¥æœ‰ä¸€ä¸ªåˆå§‹åŒ–åˆ—è¡¨ï¼Œå‰ææ˜¯åªè®¡ç®—å¸¸é‡ã€‚æˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨newè°ƒç”¨å¸¸é‡æž„é€ å‡½æ•°ï¼Œå¦‚æžœæˆ‘ä»¬é‚£æ ·åšï¼Œåˆ™æˆ‘ä»¬ä¼ é€’çš„å‚æ•°ä¸å†å—é™åˆ¶ï¼Œä½†ç»“æžœä¸å†æ˜¯å¸¸é‡ã€‚ ç±»æ–¹æ³•ç±»æ–¹æ³•æ˜¯ä¸ä¾èµ–ä¸Žä¸ªä½“å®žä¾‹çš„æ–¹æ³•ã€‚ç”¨æˆ·å®šä¹‰çš„ç±»æ–¹æ³•åœ¨å£°æ˜Žå®ƒçš„ç±»ä¸­æ˜¯å¯ç”¨çš„ï¼Œåœ¨ç±»å¤–åªèƒ½å°†ä»–ä»¬æ‰€åœ¨çš„ç±»ä½œä¸ºå‰ç¼€æ‰èƒ½è®¿é—®ï¼Œä¾‹å¦‚ï¼šPoint.distance(aPoint,anotherPoint)ã€‚åœ¨ç±»æ–¹æ³•ä¸­ä½¿ç”¨thiså°†å¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚å› ä¸ºä¸€ä¸ªç±»æ–¹æ³•ä¸ç‰¹å®šäºŽä»»æ„å®žä¾‹ï¼Œæ‰€ä»¥thisåœ¨å…¶å†…éƒ¨æ˜¯æœªå®šä¹‰çš„ã€‚ æœ‰ä¸€ç‚¹éœ€è¦è¯´æ˜Žï¼Œç±»å˜é‡ä»Žä¸è¢«ç»§æ‰¿ï¼š 12345678910class Point &#123; static distance()&#123; &#125;&#125;class ExtendedPoint extends Point&#123; var origin = new Point(0,0); get distanceFromOrigin =&gt; distance(origin, this);// æ­¤å¤„ä¼šæŠ›å‡ºNoSuchMethodError&#125; ä¸ºäº†ä½¿ä¸Šé¢çš„ä»£ç å·¥ä½œï¼Œéœ€åšå¦‚ä¸‹ä¿®æ”¹ï¼š 1get distanceFromOrigin =&gt; Point.distance(origin, this); å®žä¾‹åŠå®žä¾‹çš„ç±»ä¸Žå…ƒç±»æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªç±»çš„å®žä¾‹ï¼Œæ—¢ç„¶ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆç±»ä¹Ÿæ˜¯å¯¹è±¡ï¼›æ—¢ç„¶ç±»æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆä»–ä»¬æœ¬èº«ä¹Ÿæ˜¯æŸä¸ªç±»çš„å®žä¾‹ã€‚ç±»çš„ç±»é€šå¸¸è¢«ç§°ä¸ºå…ƒç±»ã€‚Dartè¯­è¨€æŒ‡å®šç±»çš„ç±»åž‹ä¸ºType,ä½†æ²¡æœ‰æŒ‡æ˜Žä»–ä»¬å±žäºŽå“ªä¸ªç±»ã€‚ ä¸Šå›¾ä¸­ï¼ŒaCæ˜¯ç±»Cçš„ä¸€ä¸ªå®žä¾‹ï¼Œç±»Cåˆæ˜¯_Typeçš„ä¸€ä¸ªå®žä¾‹ï¼Œ_Typeæ˜¯å®ƒè‡ªèº«çš„ä¸€ä¸ªå®žä¾‹ã€‚è¿™è§£å†³äº†å¯¹ç±»åž‹å¯èƒ½è¿›è¡Œæ— ç©·æ— å°½çš„è¿½æº¯ã€‚ Object ä¸Žå…¶æ–¹æ³•Objectç±»çš„æŽ¥å£å…¶å®žæ¯”è¾ƒå°‘ï¼Œåœ¨å‰é¢çš„å†…å®¹ä¸­æˆ‘ä»¬äº†è§£äº†æ“ä½œç¬¦æ–¹æ³• == ä»¥åŠ getteræ–¹æ³• hashCodeæ–¹æ³•ï¼Œè¿˜æœ‰runtimeTypeæ–¹æ³•ã€‚è€Œæœ€å¸¸ç”¨çš„å°±æ˜¯toString(),è¿™ä¸ªæ–¹æ³•è¿”å›žä¸€ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚æˆ‘ä»¬é€šå¸¸éƒ½ä¼šé‡å†™è¿™ä¸ªæ–¹æ³•ä»¥ä½¿å®ƒæ›´æœ‰æ„ä¹‰ã€‚æ‰€ä»¥ï¼ŒObjectç±»çš„è½®å»“ç±»ä¼¼äºŽè¿™æ ·ï¼š 12345678class Object &#123; external bool operator ==(other); external int get hashCode; external String toString(); external noSuchMethod(Invocation im); external Type get runtimeType;&#125; ä¸Šé¢çš„æ–¹æ³•éƒ½è¢«æ ‡è®°ä¸ºexternal,è¡¨æ˜Žä»–ä»¬çš„å®žçŽ°æ˜¯åœ¨å…¶ä»–åœ°æ–¹ã€‚externalæœºåˆ¶ç”¨äºŽå£°æ˜Žä»£ç çš„å®žçŽ°æ¥è‡ªäºŽå¤–éƒ¨ã€‚è¿™äº›å¤–éƒ¨ä»£ç å¯ä»¥æœ‰å¤šç§æä¾›æ–¹å¼ï¼šä½œä¸ºåº•å±‚å®žçŽ°åŸºç¡€çš„å¤–éƒ¨å‡½æ•°æŽ¥å£ï¼›æˆ–è€…ç”šè‡³å¯ä»¥åŠ¨æ€åœ°ç”Ÿæˆå®žçŽ°ã€‚ mixinDartæ”¯æŒåŸºäºŽminxinçš„ç»§æ‰¿ï¼šæ¯ä¸ªç±»éƒ½å¼•å…¥äº†ä¸€ä¸ªmxin æ€»ç»“ Dartæ˜¯ä¸€ç§åŸºäºŽç±»çš„çº¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ã€‚è¿™æ„å‘³ç€è¿è¡Œæ—¶å€¼éƒ½æ˜¯å¯¹è±¡ï¼Œä¸”æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯æŸä¸ªç±»çš„å®žä¾‹ã€‚ å¯¹è±¡æœ‰çŠ¶æ€å’Œè¡Œä¸ºã€‚çŠ¶æ€åªèƒ½é€šè¿‡ç‰¹æ®Šçš„accessorè®¿é—®ï¼šgetterå’Œsetterã€‚è¿™ç¡®ä¿äº†Dartå¯¹è±¡ä¸Šçš„æ‰€æœ‰è®¡ç®—éƒ½æ˜¯é€šè¿‡ç¨‹åºæŽ¥å£å®Œæˆçš„ã€‚ ç±»åœ¨è¿è¡Œæ—¶æ‰å…·ä½“åŒ–ï¼Œå¯¹è±¡æœ¬èº«ä¹Ÿå¿…é¡»å¦‚æ­¤ã€‚å› æ­¤ï¼Œæ¯ä¸ªç±»éƒ½æ˜¯ç±»åž‹ä¸ºTypeçš„å…ƒç±»çš„ä¸€ä¸ªå®žä¾‹ã€‚æ¯ä¸ªç±»éƒ½è‡³å°‘æœ‰ä¸€ä¸ªæž„é€ å‡½æ•°ï¼Œæž„é€ å‡½æ•°ç”¨äºŽåˆ›å»ºå¯¹è±¡ã€‚æŸäº›å¯¹è±¡æ˜¯å¸¸é‡ï¼Œè¿™æ„å‘³ç€ä»–ä»¬åœ¨ç¼–è¯‘æ—¶å°±å¯ä»¥é¢„å…ˆè®¡ç®—ã€‚ æ¯ä¸ªDartç±»éƒ½æœ‰å”¯ä¸€çš„çˆ¶ç±»ï¼Œé™¤äº†ç±»å±‚çº§ç»“æž„çš„æ ¹ï¼Œå³Objectã€‚æ‰€æœ‰Dartå¯¹è±¡éƒ½ä»ŽObjectç»§æ‰¿äº†å…±åŒçš„è¡Œä¸ºã€‚ Dartæ”¯æŒåŸºäºŽmixinçš„ç»§æ‰¿ï¼šæ¯ä¸ªç±»éƒ½å¼•å…¥äº†ä¸€ä¸ªmixin,å®ƒæ•èŽ·äº†ç±»æœ¬èº«å¯¹ç±»å±‚æ¬¡ç»“æž„æ‰€åšçš„ç‹¬ç‰¹è´¡çŒ®ã€‚mixinä½¿ç´¯çš„ä»£ç ä»¥æ¨¡å—åŒ–æ–¹å¼é‡ç”¨ï¼Œè€Œä¸ä¾èµ–äºŽä»–åœ¨ç±»å±‚çº§ç»“æž„ä¸­çš„ä½ç½®ã€‚ åº“Dartç¨‹åºæ˜¯ç”±è¢«ç§°ä¸ºåº“çš„æ¨¡å—åŒ–å•å…ƒç»„æˆçš„ã€‚ é¡¶å±‚é€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªåº“ç”±å¤šä¸ªé¡¶å±‚å£°æ˜Žç»„æˆï¼Œè¿™äº›å£°æ˜Žå¯èƒ½å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ã€å˜é‡åŠç±»åž‹ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„æ ˆåº“ï¼š 123456789library stack1;final _contents = [];get isEmplty =&gt; _contents.isEmtpy;get top =&gt; isEmpty ? throw 'Cannot get top of empty stack' : _contents.last;get pop =&gt; isEmpty ? trhow 'Cannot pop empty stack' : _contents.removeLast();push(e)&#123; _contents.add(e); return e;&#125; ä»£ç ä¸­çš„_contentså˜é‡ å°±æ˜¯ä¸€ä¸ªé¡¶å±‚å˜é‡ï¼Œå®ƒè¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªç©ºåˆ—è¡¨ã€‚ä¸Žå®žä¾‹å˜é‡å’Œç±»å˜é‡ä¸€æ ·ï¼Œé¡¶å±‚å˜é‡å¼•å…¥äº†éšå«çš„accessorã€‚é¡¶å±‚å˜é‡æ˜¯å»¶è¿Ÿåˆå§‹åŒ–çš„ï¼Œä¸Žç±»å˜é‡ä¸€æ ·ï¼Œåœ¨ä»–ä»¬çš„getterç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ‰æ‰§è¡Œåˆå§‹åŒ–ã€‚ é¡¶å±‚å˜é‡å’Œç±»å˜é‡ä¸€èµ·å‘—ç§°ä¸ºé™æ€å˜é‡ã€‚ä»–ä»¬çš„åŒºåˆ«åœ¨äºŽä½œç”¨åŸŸï¼Œç±»å˜é‡çš„ä½œç”¨åŸŸé™åˆ¶åœ¨å£°æ˜Žå®ƒçš„ç±»ä¸­ï¼Œé¡¶å±‚å˜é‡çš„ä½œç”¨åŸŸè¦†ç›–äº†å£°æ˜Žå®ƒçš„æ•´ä¸ªåº“ã€‚åº“çš„ä½œç”¨åŸŸé€šå¸¸ç”±å¤šä¸ªç±»å’Œå‡½æ•°æž„æˆã€‚ ä¸Žç±»å˜é‡ä¸€æ ·ï¼Œé¡¶å±‚å˜é‡å¯ä»¥å£°æ˜Žä¸ºfinal,è¿™ç§æƒ…å†µä¸‹ï¼Œä»–ä»¬æ²¡æœ‰å®šä¹‰setterä¸”å¿…é¡»åœ¨å£°æ˜Žæ—¶å°±åˆå§‹åŒ–ã€‚ä¹Ÿå¯ä»¥æŠŠé™æ€å˜é‡å£°æ˜Žä¸ºå¸¸é‡ï¼Œé‚£æ ·çš„è¯ï¼Œä»–ä»¬åªèƒ½è¢«èµ‹äºˆä¸€ä¸ªç¼–è¯‘æ—¶å¸¸é‡ä¸”è‡ªèº«è¢«è§†ä¸ºä¸å¯å˜ã€‚ é¡¶å±‚å‡½æ•°ï¼ˆå¸¸è¢«ç§°ä¸ºåº“æ–¹æ³•ï¼‰çš„ä½œç”¨åŸŸè§„åˆ™ä¸Žé¡¶å±‚å˜é‡ä¸€æ ·ï¼Œåœ¨æ•´ä¸ªåº“ä¸­éƒ½æ˜¯å¯ç”¨çš„ï¼Œå®ƒå¯ä»¥æ˜¯æ™®é€šå‡½æ•°ã€getterã€setterã€‚ é™¤äº†é¡¶å±‚å‡½æ•°ä¸Žå˜é‡ï¼Œä¹Ÿå¯ä»¥å£°æ˜Žé¡¶å±‚ç±»ã€‚åœ¨Dartä¸­ç±»å£°æ˜Žéƒ½æ˜¯é¡¶å±‚çš„ï¼Œå› ä¸ºDartä¸æ”¯æŒåµŒå¥—ç±»ã€‚ éšç§åº“æ˜¯Dartçš„åŸºç¡€å°è£…å•å…ƒï¼Œä»¥ä¸‹åˆ’çº¿_å¼€å¤´çš„æˆå‘˜éƒ½æ˜¯åº“ç§æœ‰çš„ã€‚å¦‚ä¸Šæ–‡ä¸­çš„_contents çœ‹ä»¥ä¸‹ä»£ç ï¼š 123456789class CachingClass&#123; var _cache; operator [](i)&#123; if(_cache[i] == null)&#123; _cache[i]=complicatedFunction(i); &#125; return _cache[i]; &#125;&#125; CachingClassæ‰€åœ¨çš„åº“ä¹‹å¤–çš„ä»£ç éƒ½æ— æ³•è®¿é—®_cacheå­—æ®µã€‚è¿™ç§æ–¹æ¡ˆä½¿ä½ ä¸å¿…æŸ¥çœ‹æŸä¸ªå˜é‡çš„å£°æ˜Žå°±å¯ä»¥è¯†åˆ«å®ƒæ˜¯å¦ç§æœ‰ã€‚ éšç§ä¸åº”è¯¥ä¸Žå®‰å…¨æ··æ·†ã€‚Dartä¸­çš„éšç§æ˜¯ä¸ºäº†æ”¯æŒè½¯ä»¶å·¥ç¨‹éœ€è¦ï¼Œè€Œä¸æ˜¯å®‰å…¨éœ€æ±‚ã€‚å”¯ä¸€å®‰å…¨çš„è¾¹ç•Œåœ¨isolateä¹‹é—´ã€‚ å¯¼å…¥Dartå¯¼å…¥è¯­å¥é€‚ç”¨äºŽä»»æ„URI(Universal Resource Indicators)ã€‚ä½†æ˜¯ä¸æŽ¨èä½¿ç”¨ï¼Œå› ä¸ºä½ç½®å‘ç”Ÿå˜åŒ–æ—¶éœ€è¦ä¿®æ”¹ä»£ç ã€‚1import 'http://staxRus/stack1.dart'; é€šå¸¸æˆ‘ä»¬ä¼šè¿™æ ·å¯¼å…¥ï¼š 1import 'package:stack1.dart'ï¼› è¿™ç§package: çš„å¯¼å…¥æ–¹å¼ä¼šæ‰§è¡Œä¸€ä¸ªå¸¸é©»çš„å°è£…äº†ä»£ç ä½ç½®ä¿¡æ¯çš„åŒ…ç®¡ç†å™¨ã€‚å¯¹äºŽå¹³å°è‡ªèº«çš„åº“æ²¡æœ‰å¿…è¦ä½¿ç”¨packageï¼šæ–¹å¼ï¼Œè¿™äº›åº“é€šå¸¸ç”¨dartï¼šæ¥è®¿é—®ï¼Œä¾‹å¦‚1import 'dart:io'; åº“å†…å¯ç”¨çš„å¯¹è±¡åŒ…å«äº†åº“æœ¬èº«æ‰€å£°æ˜Žçš„å¯¹è±¡åŠé€šè¿‡å¯¼å…¥è¯­å¥ä»Žå…¶ä»–åº“å¯¼å…¥çš„å¯¹è±¡ã€‚ åº“å†…çš„å¯ç”¨å¯¹è±¡ä¸Žå®ƒæä¾›ç»™å®¢æˆ·çš„å¯¹è±¡æ˜¯ä¸åŒçš„ã€‚ä»Žåº“å¤–éƒ¨å¯¼å…¥çš„å¯¹è±¡å¯¹åº“çš„ç”¨æˆ·æ˜¯ä¸å¯ç”¨çš„ã€‚æ­¤å¤–ï¼Œåº“çš„ç§æœ‰æˆå‘˜å¯¹åº“çš„è°ƒç”¨è€…æ˜¯ä¸å¯ç”¨çš„ã€‚ è§£å†³åº“å†…å€’å…¥çš„æˆå‘˜å†²çªçš„æ–¹æ³•æ˜¯ä¸ºè¿™äº›åº“æä¾›ä¸åŒçš„å‰ç¼€æ¥è¿›è¡ŒåŒºåˆ†ã€‚ 12import 'package:stack1.dart' as stack1;import 'package:stack2.dart' as stack2; å¯¼å…¥åº“çš„å‰ç¼€ä¸å¾—ä¸Žæœ¬åº“å†…å…¶ä»–é¡¶å±‚å˜é‡å£°æ˜Žå‘ç”Ÿå†²çªã€‚å¦åˆ™ç¼–è¯‘å™¨ä¼šæ ‡è®°é”™è¯¯ï¼Œå› ä¸ºæœ¬åœ°å˜é‡çš„ä¼˜å…ˆçº§é«˜äºŽæ‰€æœ‰å¯¼å…¥çš„å¯¹è±¡ã€‚ Dartæä¾›äº†é¢å¤–çš„æœºåˆ¶æ¥æŽ§åˆ¶å¯¼å…¥åˆ°åº“å†…çš„å¯¹è±¡ï¼šå‘½åç©ºé—´ç»„åˆå™¨showå’Œhideã€‚å‘½åç©ºé—´æ˜¯åç§°åˆ°å£°æ˜Žçš„æ˜ å°„ã€‚ hideç»„åˆå™¨æŽ¥æ”¶ä¸€ä¸ªå‘½åç©ºé—´å’Œä¸€ä¸ªæ ‡è¯†ç¬¦åˆ—è¡¨ï¼Œå¹¶å°†æ ‡è¯†ç¬¦åˆ—è¡¨ä¸­çš„å¯¹è±¡ä»Žå‘½åç©ºé—´ä¸­ä¸¢å¼ƒï¼Œç„¶åŽäº§ç”Ÿä¸€ä¸ªæ–°çš„å‘½åç©ºé—´ã€‚å¦‚ä¸‹ï¼š 12library lib1;import 'stack1.dart' hide isEmpty, top; hideæ“ä½œç¬¦è¢«åº”ç”¨åˆ°å¯¼å‡ºçš„å‘½åç©ºé—´ä¸­ï¼Œå°†isEmpty å’Œ top ç§»é™¤äº†ã€‚å®žé™…æä¾›ç»™å¯¼å…¥è¿™ä½œç”¨åŸŸçš„æ˜¯hideæ“ä½œç¬¦ç”¨ç”¨ä¹‹åŽçš„ç»“æžœã€‚showç»„åˆå™¨ç±»ä¼¼ï¼Œåªæœ‰åœ¨æ ‡è¯†ç¬¦åˆ—è¡¨ä¸­çš„å¯¹è±¡ä¼šè¢«ä¿ç•™ã€‚å¦‚ä¸‹ï¼š 12library lib1;import 'stack1.dart' show pop, push; å¦‚æžœä½ çœŸçš„æƒ³è®©è‡ªå·±çš„åº“å¥å£®ï¼Œé‚£ä¹ˆä½ åº”è¯¥ç»„åˆä½¿ç”¨å‰ç¼€å’Œshow,åªå¯¼å…¥ä½ å®žé™…ä½¿ç”¨çš„å…ƒç´ ï¼š 12library lib1;import 'stack1.dart' as stack1 show pop,push; ä½¿ç”¨showå°†é˜²æ­¢å¯¼å…¥çš„æ–°æˆå‘˜æœ‰æ„å¤–å†²çªã€‚è€Œé‡‡ç”¨ä¸Šé¢çš„æ–¹å¼ï¼Œå¯ä»¥è§£å†³ä¸åŒå€’å…¥æˆå‘˜ä¹‹é—´çš„å†²çªï¼Œå¹¶æé˜²å€’å…¥æˆå‘˜å’Œç»§æ‰¿æˆå‘˜ä¹‹é—´çš„å†²çªã€‚ å°†åº“æ‹†åˆ†æˆpartæœ‰æ—¶ï¼Œä¸€ä¸ªåº“å¯èƒ½å¤ªå¤§ï¼Œä¸èƒ½æ–¹ä¾¿çš„ä¿å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚Dartå…è®¸æŠŠåº“æ‹†åˆ†æˆè¾ƒå°çš„partç»„ä»¶ã€‚æ¯ä¸ªå­åŠŸèƒ½æˆ–è€…å­ç³»ç»Ÿéƒ½æ”¾åœ¨å„è‡ªçš„æ–‡ä»¶ä¸­ï¼Œè€Œåº“é€šè¿‡ä½¿ç”¨partæŒ‡ä»¤æ¥å¼•ç”¨ä»–ä»¬ã€‚ partæŒ‡ä»¤çœ‹èµ·æ¥è·ŸCè¯­è¨€çš„#includeç±»ä¼¼ã€‚ä½†äº‹å®žå¹¶éžå¦‚æ­¤ï¼Œæ¯ä¸€ä¸ªpartéƒ½å¿…é¡»ä»¥ä¸€ä¸ªpartå¤´æ¥æŒ‡å®šå®ƒå±žäºŽå“ªä¸€ä¸ªåº“ã€‚ä¾‹å¦‚ï¼š 1234part of ide;// é¡¶å±‚å£°æ˜Ž class ClassBrowser...... partçš„å¤´éƒ¨ä½¿ç”¨åº“åç§°æ¥æŒ‡æ˜Žå®ƒæ‰€åœ¨çš„åº“ã€‚ä¸æ˜¯æ‰€æœ‰çš„åº“éƒ½æœ‰åç§°ï¼Œä½†æ˜¯å¦‚æžœä½¿ç”¨partæ¥æž„å»ºåº“ï¼Œé‚£ä¹ˆåº“æœ¬èº«å¿…é¡»è¦å‘½åã€‚å„ä¸ªpartåº”è¯¥æœ‰å¾ˆå¥½çš„ç»“æž„ï¼Œå¹¶ä¸”æŒ‰ç…§é€»è¾‘åˆ†ç»„ï¼Œè€Œä¸æ˜¯çº¯ç²¹çš„å †ç§¯ä»£ç ã€‚ ä¸€èˆ¬çš„è§„åˆ™æ˜¯ï¼Œå¦‚æžœåº“é€šè¿‡URIå¼•ç”¨æŸä¸ªpart,è€ŒURIçš„å†…å®¹å¹¶ä¸æ˜¯ä¸€ä¸ªpart,é‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªç¼–è¯‘é”™è¯¯ï¼Œè€Œå¦‚æžœpartæœ¬èº«ä¸æŒ‡å‘åŒä¸€ä¸ªåº“ï¼Œé‚£ä¹ˆä¼šäº§ç”Ÿä¸€ä¸ªè­¦å‘Šã€‚ å¯¼å‡ºå¯¼å‡ºæŒ‡ä»¤å…è®¸ä¸€ä¸ªåº“ä½¿ç”¨æ¥è‡ªå…¶ä»–å‘½åç©ºé—´çš„å¯¹è±¡æ¥æ‰©å……è‡ªå·±çš„å¯¼å‡ºå‘½åç©ºé—´ã€‚ export &#39;browsing.dart&#39; è¿˜å¯ä»¥ä½¿ç”¨showå’Œhideå¯¹åº“çš„å‘½åç©ºé—´è¿›è¡Œåˆç†çš„è¿‡æ»¤ã€‚ export &#39;vcs.dart show RepositoryBrowser&#39;; å¯¼å‡ºçš„è§„åˆ™ä¸Žå¯¼å…¥ã€partçš„è§„åˆ™ç›¸åŒã€‚ é’»çŸ³å¯¼å…¥ä»Žå¤šä¸ªèšåˆæ€§APIå¯¼å…¥æ—¶ï¼Œå¯èƒ½ä¼šä»Žä¸åŒçš„è·¯å¾„å¯¼å…¥ç›¸åŒçš„å¯¹è±¡ï¼Œè¿™ç§æƒ…å†µè¢«ç§°ä¸ºé’»çŸ³å¯¼å…¥ã€‚Dartä¼šå¯¹é’»çŸ³å¯¼å…¥å‘å‡ºè­¦å‘Šã€‚ å»¶è¿ŸåŠ è½½å»¶è¿ŸåŠ è½½çš„ä½œç”¨ï¼šä¸€æ˜¯åº”ç”¨å¿«é€Ÿå¯åŠ¨ä¸”ä¿æŒä¸‹è½½é‡å°½å¯èƒ½çš„å°ã€‚å¦å¤–ï¼Œåœ¨æ‹¥æœ‰è¯¸å¤šåŠŸèƒ½çš„å¤§åž‹åº”ç”¨ä¸­ï¼Œå»¶è¿ŸåŠ è½½å¯ä»¥å‡å°‘å†…å­˜çš„ä½¿ç”¨ã€‚ 1import &apos;rarelyUsed.dart&apos; deferred as rarelyUsed; å»¶è¿ŸåŠ è½½çš„å¯¼å…¥å¿…é¡»æä¾›å‰ç¼€ï¼Œä¸”å‰ç¼€ä¸èƒ½è¢«åº“ä¸­çš„å…¶ä»–å¯¼å…¥ä½¿ç”¨ã€‚è¿åè¿™äº›è§„åˆ™å°†ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚ æ€»ç»“Dartç¨‹åºç”±åº“ç»„æˆã€‚åº“èšåˆç±»ã€å‡½æ•°å’Œå˜é‡ã€‚Dartçš„åº“æ˜¯é’ˆå¯¹éšç§è€Œä¸æ˜¯å®‰å…¨æ€§å°è£…å•å…ƒã€‚ Dartç¨‹åºçš„æ‰§è¡Œæ€»æ˜¯ä»Žè„šæœ¬çš„main()å‡½æ•°å¼€å§‹çš„ã€‚ä¸€ä¸ªåº“å¯ä»¥è¢«æ‹†åˆ†æˆå¤šä¸ªpartã€‚Dartåº“é€šè¿‡å¯¼å…¥æ¥æŽ¥å…¥ä»–ä»¬è‡ªèº«çš„ä¾èµ–ï¼Œå¹¶èƒ½é€šè¿‡æ‰§è¡Œå‘½åç©ºé—´ç»„åˆå™¨æ¥é€‰æ‹©æ€§åœ°å¯¼å…¥å…¶ä»–åº“çš„å¯¹è±¡ï¼Œä¹Ÿèƒ½å¤Ÿé€šè¿‡æ·»åŠ å‰ç¼€æ¥åŒºåˆ†å„ä¸ªå¯¼å…¥ã€‚åº“é€šè¿‡å‘½åç©ºé—´ç»„åˆå™¨ä¹Ÿèƒ½å°†å…¶ä»–åº“æˆ–è‡ªå·±çš„éƒ¨åˆ†å†…å®¹é‡æ–°å¯¼å…¥ã€‚åº“å¯ä»¥å»¶è¿Ÿåˆ°è¿è¡Œæ—¶åŠ è½½ï¼Œä»¥æ”¹å–„å¯åŠ¨æ—¶é—´åŠå‡å°‘ä¸å¿…è¦çš„å†…å­˜å¼€é”€ã€‚ å‡½æ•°å‡½æ•°æ˜¯Dartçš„ä¸»åŠ›ï¼Œæ‰€æœ‰è®¡ç®—éƒ½æ˜¯ç”±å‡½æ•°æ¥æ‰§è¡Œã€‚æˆ‘ä»¬å°†æ‰€æœ‰è¯­æ³•å½¢å¼çš„å‡½æ•°ä¸Žæ–¹æ³•ç»Ÿç§°ä¸ºå‡½æ•°ã€‚ å‡½æ•°æ˜¯Dartå­˜å‚¨åœ¨å˜é‡ä¸­çš„ä¸€ç­‰å€¼ï¼Œå®ƒèƒ½ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œä½œä¸ºå‡½æ•°çš„è¿”å›žå€¼ã€‚å‡½æ•°åŒæ ·æ˜¯å¯¹è±¡ã€‚ å‚æ•°å‡½æ•°æ€»æ˜¯æœ‰ä¸€ä¸ªå½¢å¼å‚æ•°åˆ—è¡¨ï¼Œè¿™ä¸ªåˆ—è¡¨é¡µå¯ä»¥ä¸ºç©ºã€‚å‚æ•°è¦ä¹ˆæ˜¯ä½ç½®åž‹çš„ï¼Œè¦ä¹ˆæ˜¯å‘½ååž‹çš„ã€‚ ä½ç½®å‚æ•°ä½ç½®å‚æ•°å¯ä»¥æ˜¯å¿…å¡«çš„æˆ–å¯é€‰çš„ã€‚å¯é€‰å‚æ•°å¿…é¡»æŽ’åˆ—åœ¨ä¸€èµ·æ”¾ç½®åœ¨å‚æ•°åˆ—è¡¨å°¾éƒ¨ï¼Œå¹¶ç”¨æ–¹æ‹¬å·[]åŒ…è£¹ã€‚ä»»æ„å¿…å¡«å‚æ•°éƒ½å¿…é¡»å‡ºçŽ°åœ¨å¯é€‰å‚æ•°å‰é¢ã€‚å¯é€‰å‚æ•°å¯ä»¥æŒ‡å®šé»˜è®¤å€¼ä½†å¿…é¡»æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚1increment(x,[step = 1]) =&gt; x + step; // step æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤å€¼æ˜¯1 å‘½ä»¤å‚æ•°å‘½åå‚æ•°è¦åœ¨ä½ç½®å‚æ•°ä¹‹åŽå£°æ˜Žï¼Œå¹¶ç”¨å¤§æ‹¬å·{}åŒ…è£¹ã€‚ ç¤ºä¾‹1addressLetter(&#123;name:'', street:'', number,city,zip,country&#125;)&#123;...&#125; ä¸‹é¢æ˜¯ä¸€ä¸ªå¿…å¡«å‚æ•°ä¸Žå‘½åå‚æ•°æ··åˆçš„ä¾‹å­ï¼š 12345678var map = new Map();fail() =&gt; throw('Key not found');lookup(key,&#123;ifMissing: fail&#125;)&#123; var result = map[key]; if(result == null)&#123; return ifMissing(); &#125;&#125; é€šå¸¸ï¼Œä½œä¸ºé”™è¯¯å¤„ç†ç¨‹åºçš„å›žè°ƒå‡½æ•°ä¼šé€šè¿‡å‘½åå‚æ•°æ¥æŒ‡å®šã€‚ å¦‚æžœå¯é€‰å‚æ•°æ²¡æœ‰æŒ‡å®šé»˜è®¤å€¼ï¼Œåˆ™å®ƒçš„å€¼é»˜è®¤æ˜¯nullã€‚ å‘½åå‚æ•°å§‹ç»ˆæ˜¯å¯é€‰çš„ï¼Œä¸å¯ä»¥æ··åˆä½¿ç”¨å¯é€‰ä½ç½®å‚æ•°å’Œå‘½åå‚æ•°ã€‚ å½¢å¼å‚æ•°ä¸æ˜¯fianlå˜é‡ï¼Œä»–ä»¬å¯ä»¥è¢«ä¿®æ”¹ï¼Œä½†è¿™ä¸æ˜¯ä¸€ä¸ªå¥½çš„é£Žæ ¼ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡å‡å°‘ä½¿ç”¨å¯å˜çš„å˜é‡ã€‚ å‡½æ•°ä½“Dartçš„å‡½æ•°ä½“æœ‰ä¸¤ç§å½¢å¼ï¼š å¤§æ‹¬å·{}æ‹¬èµ·æ¥çš„è¯­å¥åˆ—è¡¨(å¯ä»¥ä¸ºç©º)ã€‚ =&gt; ç¬¦å·åŽè·Ÿç€ä¸€ä¸ªè¡¨è¾¾å¼ã€‚ æž„é€ å‡½æ•°åŒ…æ‹¬äº†å·¥åŽ‚æž„é€ å‡½æ•°ä¸Žç”Ÿäº§æž„é€ å‡½æ•°ï¼Œå…¶ä¸­å·¥åŽ‚æž„é€ å‡½æ•°æ˜¯å…·å¤‡ç‰¹æ®ŠåŠŸèƒ½çš„æ™®é€šå‡½æ•°ã€‚ç”Ÿäº§æž„é€ å‡½æ•°ä¸Žå·¥åŽ‚æž„é€ å‡½æ•°çš„åŒºåˆ«åœ¨äºŽï¼Œå®ƒå§‹ç»ˆè¿”å›žä¸€ä¸ªæ–°çš„å®žä¾‹æˆ–è€…æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚æ‰€ä»¥å°±ç®—æ˜¯æ²¡æœ‰æ˜¾å¼çš„ä½¿ç”¨returnè¯­å¥ï¼Œç”Ÿäº§æž„é€ å‡½æ•°ä¹Ÿä¸ä¼šè¿”å›žnullã€‚ å‡½æ•°å£°æ˜Žå‡½æ•°å£°æ˜Žæœ‰ä¸€ä¸ªå‡½æ•°åç§°ï¼ŒåŽé¢è·Ÿç€å‚æ•°åˆ—è¡¨å’Œå‡½æ•°ä½“ã€‚ æŠ½è±¡æ–¹æ³•æœ‰å‡½æ•°ç­¾åä½†æ˜¯æ²¡æœ‰å‡½æ•°ä½“ã€‚ å‡½æ•°å£°æ˜Žå¯ä»¥å‡ºçŽ°åœ¨é¡¶å±‚(å¦‚ï¼Œmain()),æˆ–è€…ä½œä¸ºæ–¹æ³•å­˜åœ¨ï¼Œè€Œä¸”ï¼Œå‡½æ•°å¯ä»¥æ˜¯å±€éƒ¨å‡½æ•°ã€‚å±€éƒ¨å‡½æ•°å°±æ˜¯å®šä¹‰åœ¨å…¶ä»–å‡½æ•°å†…éƒ¨çš„å‡½æ•°ã€‚ 1234567891011fib(n)&#123; lastTwo(n)&#123; if(n &lt; 1) &#123; return [0,1]; &#125;else &#123; var p = lastTwo(n - 1); return [p[1], p[0] + p[1]]; &#125; &#125; return lastTwo(n)[1];&#125; é—­åŒ…å‡½æ•°å¯ä»¥å®šä¹‰åœ¨è¡¨è¾¾å¼å†…éƒ¨ï¼Œä»–ä»¬è¢«ç§°ä¸ºå‡½æ•°å­—é¢é‡ï¼Œæˆ–è€…è¢«ç§°ä¸ºé—­åŒ…ã€‚ä¸Žå‡½æ•°ç”Ÿå‘½ä¸åŒï¼Œé—­åŒ…æ²¡æœ‰åç§°ã€‚ä½†æ˜¯ä»–ä»¬ä¹Ÿæœ‰å‚æ•°åˆ—è¡¨å’Œå‡½æ•°ä½“ã€‚ 1234(x) =&gt; x;(x) &#123;return x;&#125;(x, [step = 1]) =&gt; x + step; // æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°çš„é—­åŒ…(a, b) =&gt; a + b; // æœ‰ä¸¤ä¸ªå¿…å¡«å‚æ•°çš„é—­åŒ… è°ƒç”¨æ–¹æ³•ä¸Žå‡½æ•°çº§è”é™¤äº†ä½¿ç”¨ç‚¹è¿ç®—ç¬¦æ¥æ‰§è¡Œæˆå‘˜é€‰æ‹©ï¼ŒDartä¹Ÿæ”¯æŒä½¿ç”¨åŒç‚¹è¿ç®—ç¬¦è¿›è¡Œæ–¹æ³•çº§è”ã€‚ä¾‹å¦‚: 12"Hello".length.toString(); // å€¼ä¸º'5'"Hello"..length.toString(); // å€¼ä¸º 'Hello' æ‰€ä»¥ä¸‹é¢çš„ä»£ç æˆ‘ä»¬å¯ä»¥æ¢ä¸€ç§å†™æ³•ï¼š 1234var address = new Address.of("Charles");address.setStreet("Elm", "13a");address.city = "Carthage";address.state = "Eurasia"; ä½¿ç”¨çº§è”çš„å†™æ³•ï¼š1234new Address.of("Charles"); ..setStreet("Elm", "13a") ..city = "Carthage" ..state = "Eurasia"; ä¸åº”å½“æ»¥ç”¨çº§è”ï¼Œæ¯”å¦‚ï¼Œä¸åº”å½“æŠŠä¸€ç³»åˆ—çº§è”æ”¾åœ¨åŒä¸€è¡Œæˆ–æ˜¯ä½¿ç”¨è¿‡å¤šå±‚æ¬¡çš„çº§è”ã€‚ çº§è”å¯¹æž„å»ºå»ºé€ è€…æ¨¡å¼APIéžå¸¸æœ‰ç”¨ï¼Œå³ ä¸€ä¸ªå¯¹è±¡æè¿°ç¬¦è¢«åˆ†æ­¥åˆ›å»ºï¼Œåœ¨ç»åŽ†ä¸€ç³»åˆ—çº§è”åŽï¼Œå¯¹è±¡åœ¨æž„å»ºç»“æŸæ—¶æ‰è¢«åˆ›å»ºã€‚ å¦ä¸€ç§èƒ½ç”¨åˆ°çº§è”çš„æƒ…å†µæ˜¯ï¼Œå½“æˆ‘ä»¬æ‰§è¡ŒæŸä¸ªå¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çš„è¿”å›žå€¼æ˜¯å¯¹è±¡æœ¬èº«ã€‚ èµ‹å€¼å¯èƒ½å¹¶ä¸æ˜Žæ˜¾ï¼Œä½†Dartä¸­çš„èµ‹å€¼é€šå¸¸éƒ½æ˜¯å‡½æ•°è°ƒç”¨ï¼Œå› ä¸ºå¯¹å­—æ®µçš„èµ‹å€¼åªæ˜¯setter æ–¹æ³•çš„è¯­æ³•ç³–è€Œå·²ã€‚ ä½¿ç”¨è¿ç®—ç¬¦Dartæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰çš„è¿ç®—ç¬¦ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„è¿ç®—ç¬¦æ˜¯åŠ ä¸Šæ˜¯æœ‰ç€ç‰¹æ®Šè¯­æ³•çš„å®žä¾‹æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¿…é¡»ä½¿ç”¨å†…ç½®æ ‡è¯†ç¬¦operatorä½œä¸ºå‰ç¼€ã€‚ Function ç±»Functionæ˜¯ä»£è¡¨æ‰€æœ‰å‡½æ•°çš„å…¬å…±é¡¶å±‚æŽ¥å£çš„æŠ½è±¡ç±»ã€‚Functionæ²¡æœ‰å£°æ˜Žä»»ä½•å®žä¾‹æ–¹æ³•ã€‚ç„¶è€Œä»–å£°æ˜Žäº†ç±»æ–¹æ³•apply(),æ­¤æ–¹æ³•æŽ¥æ”¶ä¸€ä¸ªå‡½æ•°å’Œä¸€ä¸ªå‚æ•°åˆ—è¡¨ï¼Œå¹¶ä½¿ç”¨æä¾›çš„å‚æ•°åˆ—è¡¨åŽ»è°ƒç”¨ä¼ å…¥çš„å‡½æ•°ã€‚ apply()çš„ç­¾åæ˜¯ï¼š 1static apply(Function function, List positionalArguments, [Map&lt;Symbol, dynamic&gt; namedArguments]); apply()æ–¹æ³•æä¾›äº†ä¸€ç§ä½¿ç”¨åŠ¨æ€ç¡®å®šçš„å‚æ•°åˆ—è¡¨æ¥è°ƒç”¨å‡½æ•°çš„æœºåˆ¶ã€‚é€šè¿‡è¿™æˆ‘ä»¬å¯ä»¥å¤„ç†åœ¨ç¼–è¯‘æ—¶å‚æ•°åˆ—è¡¨æ•°é‡ä¸ç¡®å®šçš„æƒ…å†µã€‚ å‡½æ•°ä½œä¸ºå¯¹è±¡åœ¨Dartä¸­ï¼Œå‡½æ•°å½“ç„¶ä¹Ÿæ˜¯å¯¹è±¡ã€‚ å®žé™…ä¸Šï¼Œä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼æ¯è¢«è®¡ç®—ä¸€æ¬¡ï¼Œå°±å¯èƒ½åˆ†é…ä¸€ä¸ªæ–°çš„å‡½æ•°å¯¹è±¡ã€‚åŒæ ·ï¼Œå±€éƒ¨å‡½æ•°çš„å£°æ˜Žæ¯æ¬¡è¢«æ–°çš„åŠ¨æ€ä½œç”¨åŸŸåŒ…å«æ—¶ï¼Œå°±ä¼šå¼•å…¥ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚ 12345makeCounter()&#123; var counter = 0; increment()=&gt; ++counter; return increment;&#125; æ¯æ¬¡å¯¹incrementçš„è°ƒç”¨éƒ½è¿”å›žä¸€ä¸ªä¸åŒçš„incrementå‡½æ•°ã€‚ æ€»ç»“ ä¸Žå…¶ä»–è¿è¡Œæ—¶çš„å€¼ä¸€æ ·ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ã€‚Dartä¸­çš„å‡½æ•°å¯ä»¥æŽ¥æ”¶ä½ç½®æˆ–å‘½åå‚æ•°ã€‚ä½ç½®å‚æ•°å¯ä»¥æ˜¯å¿…å¡«æˆ–å¯é€‰çš„ï¼Œå‘½åå‚æ•°å§‹ç»ˆæ˜¯å¯é€‰çš„ã€‚ å‡½æ•°å§‹ç»ˆéµå¾ªè¯æ³•ä½œç”¨åŸŸä¸”å¯¹å‘¨è¾¹çŽ¯å¢ƒæ˜¯å°é—­çš„ã€‚ Dartå‡½æ•°æ—¢èƒ½ä½œä¸ºç±»çš„æ–¹æ³•ä¹Ÿèƒ½ä½œä¸ºç‹¬ç«‹çš„ç»“æž„ã€‚ç‹¬ç«‹çš„å‡½æ•°å¯ä»¥åœ¨åº“çº§åˆ«å£°æ˜Žã€‚ æ‰€æœ‰å†…ç½®çš„æ“ä½œç¬¦ä¹Ÿéƒ½æ˜¯å‡½æ•°ï¼Œä¸”ä»–ä»¬å¤§éƒ¨åˆ†éƒ½è¢«å®šä¹‰ä¸ºå®žä¾‹æ–¹æ³•ï¼Œå¯ä»¥è¢«å¼€å‘è€…é‡å†™ã€‚ç”¨æˆ·å®šä¹‰çš„ç±»å¯ä»¥é€šè¿‡å®žçŽ°ç‰¹æ®Šçš„callæ–¹æ³•æ¥æ¨¡æ‹Ÿå†…ç½®å‡½æ•°ç±»åž‹ã€‚æ‰€æœ‰Dartå‡½æ•°éƒ½è¢«è®¤ä¸ºæ˜¯Functionç±»åž‹çš„æˆå‘˜ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[Flutterå¼€å‘åŒ…å’Œæ’ä»¶]]></title>
    <url>%2F2020%2F02%2F17%2FFlutter%E5%BC%80%E5%8F%91%E5%8C%85%E5%92%8C%E6%8F%92%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[ä»‹ç»ä¸€ä¸‹åŒ…ä½¿ç”¨packageå¯ä»¥åˆ›å»ºå…±äº«çš„æ¨¡å—åŒ–ä»£ç ã€‚ä¸€ä¸ªæœ€å°çš„packageåŒ…æ‹¬ï¼š ä¸€ä¸ªpubspeck.yamlæ–‡ä»¶ï¼šå£°æ˜Žäº†packageçš„åç§°ã€ç‰ˆæœ¬ã€å’Œä½œè€…ç­‰çš„å…ƒæ•°æ®æ–‡ä»¶ã€‚ ä¸€ä¸ªlibæ–‡ä»¶å¤¹ï¼šåŒ…æ‹¬å…¬å¼€çš„pubulicä»£ç ï¼Œæœ€å°‘åº”è¯¥æœ‰ä¸€ä¸ª&lt;package-name&gt;.dartæ–‡ä»¶ã€‚ Flutter Packagesåˆ†ä¸ºä¸¤ç±»ï¼š DartåŒ…ï¼šå…¶ä¸­ä¸€äº›å¯èƒ½åŒ…å«Flutterçš„ç‰¹å®šåŠŸèƒ½ï¼Œå› æ­¤å¯¹Flutteræ¡†æž¶å…·æœ‰ä¾èµ–æ€§ï¼Œè¿™ç§åŒ…ä»…ç”¨äºŽFlutterã€‚ æ’ä»¶åŒ…ï¼šä¸€ç§ä¸“ç”¨çš„DartåŒ…ï¼Œå…¶ä¸­åŒ…å«Dartç¼–å†™çš„API,ä»¥åŠé’ˆå¯¹å®‰å“å’ŒiOSå¹³å°çš„ç‰¹å®šå®žçŽ°ï¼Œå°±æ˜¯è¯´æ’ä»¶åŒ…æ‹¬åŽŸç”Ÿä»£ç ã€‚ å¼€å‘Dart Packagesç¬¬ä¸€æ­¥åˆ›å»ºDartåŒ…ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åˆ›å»ºDartPackages 1flutter create -template=package charles_package è¿™å°†åœ¨charles_package/æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªå…·æœ‰ä»¥ä¸‹ä¸“ç”¨å†…å®¹çš„packageå·¥ç¨‹ï¼š lib/mypackage.dart: Packageçš„Dartä»£ç  test/charles_package_test.dart: Packageçš„å•å…ƒæµ‹è¯•ä»£ç ã€‚ å®žçŽ°Packageå¯¹äºŽçº¯DartåŒ…ï¼Œåªéœ€è¦åœ¨lib/.dartæ–‡ä»¶å†…æˆ–libç›®å½•ä¸­çš„æ–‡ä»¶ä¸­æ·»åŠ åŠŸèƒ½å³å¯ã€‚è¦æµ‹è¯•è½¯ä»¶åŒ…ï¼Œè¯·åœ¨testç›®å½•ä¸­æ·»åŠ unit testsã€‚ ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç»„ç»‡packageåŒ…çš„ä»£ç ï¼Œä»¥shelf packageä¸ºä¾‹ï¼Œå®ƒçš„ç›®å½•ç»“æž„å¦‚ä¸‹ï¼š åœ¨libæ ¹ç›®å½•ä¸‹çš„shelf.dartä¸­å¯¼å‡ºäº†å¤šä¸ªlib/srcç›®å½•ä¸‹çš„dartæ–‡ä»¶ï¼š 12345678910export 'src/cascade.dart';export 'src/handler.dart';export 'src/handles/logger.dart';export 'src/hijack_exception.dart';export 'src/middleware.dart';export 'src/pipleline.dart';export 'src/request.dart';export 'src/response.dart';export 'src/server.dart';export 'src/server_handler.dart'; è€Œpackageä¸­ä¸»è¦çš„åŠŸèƒ½æºç éƒ½åœ¨srcä¸‹ã€‚shelf packageä¹Ÿå¯¼å‡ºäº†ä¸€ä¸ªminiåº“ï¼šshelf_ioï¼Œå®ƒä¸»è¦æ˜¯å¤„ç†HttpRequestçš„ã€‚ å¯¼å…¥åŒ…ï¼Œå½“éœ€è¦ä½¿ç”¨è¿™ä¸ªpackageæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡packageï¼šæŒ‡ä»¤æ¥æŒ‡å®šåŒ…çš„å…¥å£æ–‡ä»¶ï¼š 1import &apos;pakcage:utilities/utilities.dart&apos;; åŒä¸€ä¸ªåŒ…ä¸­çš„æºç æ–‡ä»¶ä¹‹é—´ä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ¥å¯¼å…¥ã€‚ ç”Ÿæˆæ–‡æ¡£å¯ä»¥ä½¿ç”¨dartdocå·¥å…·æ¥ä¸ºpackageç”Ÿæˆæ–‡æ¡£ï¼Œå¼€å‘è€…éœ€è¦åšçš„å°±æ˜¯éµå®ˆæ–‡æ¡£æ³¨é‡Šè¯­æ³•åœ¨ä»£ç ä¸­æ·»åŠ æ–‡æ¡£æ³¨é‡Šï¼Œæœ€åŽä½¿ç”¨dartdocå¯ä»¥ç›´æŽ¥ç”ŸæˆAPIæ–‡æ¡£ï¼ˆä¸€ä¸ªé™æ€ç½‘ç«™ï¼‰ã€‚æ–‡æ¡£æ³¨é‡Šæ˜¯ä½¿ç”¨ä¸‰æ–œçº¿â€™///â€˜å¼€å§‹ï¼Œå¦‚ï¼š 1234/// The event handler responseible for updating the badge in the UI.void updateBadge()&#123; ...&#125; å¤„ç†åŒ…çš„ç›¸äº’ä¾èµ–å¦‚æžœæˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªcharles_packageåŒ…ï¼Œå®ƒä¾èµ–äºŽå¦ä¸€ä¸ªåŒ…ï¼Œåˆ™éœ€è¦å°†è¯¥ä¾èµ–åŒ…æ·»åŠ åˆ°pubspec.yamlæ–‡ä»¶çš„dependencieséƒ¨åˆ†ã€‚è¿™ä¸Žåœ¨Flutter åº”ç”¨ç¨‹åºæˆ–ä»»ä½•å…¶ä»–Darté¡¹ç›®ä¸­å¼•ç”¨è½¯ä»¶åŒ…æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚ä½†æ˜¯ï¼Œå¦‚æžœcharles_packageåŒ…ç¢°å·§æ˜¯ä¸€ä¸ªæ’ä»¶åŒ…ï¼Œå…¶å¹³å°ç‰¹å®šçš„ä»£ç éœ€è¦è®¿é—®url_launcherå…¬å¼€çš„ç‰¹å®šäºŽå¹³å°çš„APIï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦ä¸ºç‰¹å®šäºŽå¹³å°çš„æž„å»ºæ–‡ä»¶æ·»åŠ åˆé€‚çš„ä¾èµ–å£°æ˜Žï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š Android åœ¨charles_package/android/build.gradle: 12345android&#123; dependencies&#123; provided rootProject.findProject(&quot;:url_launcher&quot;) &#125;&#125; æ‚¨çŽ°åœ¨å°±å¯ä»¥åœ¨charles_package/android/srcæºç ä¸­import io.flutter.plugins.urllauncher.UrlLauncherPluginè®¿é—®UrlLauncherPluginç±»ã€‚ iOS åœ¨charles_package/ios/charles_package.podspec: 12Pod::Spec.new do |s| s.dependency &apos;url_launcher&apos; ä½ çŽ°åœ¨å°±å¯ä»¥åœ¨charles_package/ios/classesæºç ä¸­ #import &quot;UrlLauncherPlugin.h&quot; ç„¶åŽè®¿é—®UrlLauncherPluginç±»ã€‚ è§£å†³ä¾èµ–å†²çªå‡è®¾æˆ‘ä»¬æƒ³åœ¨charles_packageåŒ…ä¸­ä½¿ç”¨some_package å’Œ other_packageï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªåŒ…éƒ½ä¾èµ–url_launcher,ä½†æ˜¯ä¾èµ–çš„æ˜¯url_launcherçš„ä¸åŒç‰ˆæœ¬ã€‚é‚£æˆ‘ä»¬å°±æœ‰æ½œåœ¨å†²çªã€‚é¿å…è¿™ç§æƒ…å†µçš„æœ€å¥½æ–¹æ³•æ˜¯åœ¨æŒ‡å®šä¾èµ–å…³ç³»æ—¶ï¼Œä½¿ç”¨ç‰ˆæœ¬èŒƒå›´è€Œä¸æ˜¯ç‰¹å®šç‰ˆæœ¬ã€‚ 123dependencies: url_launcher:&apos;^0.4.2&apos; image_picker:&apos;0.1.1&apos; å¦‚æžœsome_packageå£°æ˜Žäº†ä¸Šé¢çš„ä¾èµ–å…³ç³»ï¼Œother_packageå£°æ˜Žäº†url_launcherç‰ˆæœ¬åƒâ€™0.4.5â€™æˆ–â€™^0.4.0â€™æ—¶ï¼Œpubå°†èƒ½å¤Ÿè‡ªåŠ¨è§£å†³é—®é¢˜ã€‚ å³ä½¿some_packageå’Œother_packageå£°æ˜Žäº†ä¸å…¼å®¹çš„url_lancherç‰ˆæœ¬ï¼Œå®ƒä»ç„¶å¯èƒ½ä¼šå’Œurl_launcherä»¥å…¼å®¹çš„æ–¹å¼æ­£å¸¸å·¥ä½œã€‚ä½ å¯ä»¥é€šè¿‡å‘charles_packageåŒ…çš„pubspeck.yamlæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–æ€§è¦†ç›–å£°æ˜Žæ¥å¤„ç†å†²çªï¼Œä»Žè€Œå¼ºåˆ¶ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬ï¼š å¼ºåˆ¶ä½¿ç”¨0.4.3ç‰ˆæœ¬çš„url_lancher,åœ¨charles_package/pubspec.yamlä¸­ï¼š 12345dependencies: some_package: other_package:dependency_overrides: url_launcher:&apos;0.4.3&apos; å¦‚æžœå†²çªä¾èµ–ä¸æ˜¯ä¸€ä¸ªåŒ…ï¼Œè€Œæ˜¯ä¸€ä¸ªç‰¹å®šäºŽAndroidçš„åº“ï¼Œæ¯”å¦‚guava,é‚£ä¹ˆå¿…é¡»å°†ä¾èµ–é‡å†™å£°æ˜Žæ·»åŠ åˆ°Gradleæž„å»ºé€»è¾‘ä¸­ã€‚ å¼ºåˆ¶ä½¿ç”¨23.0ç‰ˆæœ¬çš„guavaåº“ï¼Œåœ¨charles_package/android/build.gradleä¸­ï¼š 12345configurations.all&#123; resolutionStrategy&#123; force &apos;com.google.guava:guava:23.0-android&apos; &#125;&#125; Cocoapodsç›®å‰ä¸æä¾›ä¾èµ–è¦†ç›–åŠŸèƒ½ã€‚ å‘å¸ƒPackageä¸€æ—¦å®žçŽ°äº†ä¸€ä¸ªåŒ…ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Pubä¸Šå‘å¸ƒå®ƒï¼Œè¿™æ ·å…¶ä»–å¼€å‘è€…å¯ä»¥è½»æ¾ä½¿ç”¨å®ƒã€‚ åœ¨å‘å¸ƒå‰ï¼Œæ£€æŸ¥pubspec.yamlã€README.mdä»¥åŠCHANGELOG.mdæ–‡ä»¶ï¼Œä»¥ç¡®ä¿å…¶å†…å®¹çš„å®Œæ•´æ€§å’Œæ­£ç¡®æ€§ã€‚ç„¶åŽè¿è¡Œdry-runå‘½ä»¤ä»¥æŸ¥çœ‹æ˜¯å¦éƒ½å‡†å¤‡å¥½äº†ã€‚ 1flutter packages pub publish --dry-run éªŒè¯æ— è¯¯åŽï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿è¡Œå‘å¸ƒå‘½ä»¤äº†ï¼š 1flutter pakcages pub publish]]></content>
      <categories>
        <category>Flutter</category>
      </categories>
      <tags>
        <tag>Flutter</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Flutterä½¿ç”¨Packages]]></title>
    <url>%2F2020%2F02%2F16%2FFlutter%E4%BD%BF%E7%94%A8Packages%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨ Flutter PackagesFlutter æ”¯æŒä½¿ç”¨å…¶ä»–å¼€å‘è€…åœ¨Flutterå’ŒDartç”Ÿæ€ç³»ç»Ÿä¸­å…±äº«çš„åŒ…ã€‚è¿™å¯ä»¥ä½¿ä½ å¿«é€Ÿçš„æž„å»ºä¸€ä¸ªåº”ç”¨è€Œä¸å¿…ä»Žå¤´å¼€å‘ä¸€åˆ‡ã€‚è¿™ç¯‡æ–‡ç« æˆ‘æ¥ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨å·²ç»å‘å¸ƒçš„packagesã€‚ æŸ¥æ‰¾åŒ…ä½¿ç”¨ä¸€ä¸ªåŒ…ä¹‹å‰ï¼Œé¦–å…ˆå¾—æ‰¾åˆ°è¿™ä¸ªåŒ…ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®pub.devæ¥æŸ¥æ‰¾ä½ éœ€è¦çš„åŒ…ã€‚ æ·»åŠ ä¸€ä¸ªåŒ…åˆ°é¡¹ç›®ä¸­æ·»åŠ  css_colors åŒ…åˆ°ä¸€ä¸ªé¡¹ç›®ä¸­æœ‰å¦‚ä¸‹æ­¥éª¤: æ·»åŠ ä¾èµ–: æ‰“å¼€pubspec.yamlæ–‡ä»¶ï¼Œåœ¨dependenciesä¸‹é¢æ·»åŠ css_colorsã€‚ å®‰è£…ä¾èµ–ï¼šä½¿ç”¨ç»ˆç«¯ cd åˆ°ä½ çš„é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œflutter pub getå‘½ä»¤,æˆ–è€…åœ¨pubspec.yamlé¡¶éƒ¨ç‚¹å‡»Packegets getã€‚ å¯¼å…¥ä½ æ·»åŠ çš„åŒ…ï¼šåœ¨ä½ çš„Dartä»£ç ä¸­æ·»åŠ ä¸€ä¸ªæ­£ç¡®çš„ import è¯­å¥ã€‚ å¦‚æžœéœ€è¦çš„è¯ï¼Œé‡å¯æˆ–è€…åœæ­¢ä½ çš„åº”ç”¨ï¼šå› ä¸ºçƒ­é‡è½½å’Œçƒ­é‡å¯åªä½œç”¨äºŽDartä»£ç ï¼Œä¸ä¼šä½œç”¨äºŽå¹³å°ç‰¹å®šä»£ç ã€‚åœ¨ä½¿ç”¨åŒ…çš„æ—¶å€™åšä¸€ä¸ªé‡å¯åº”ç”¨å¯ä»¥æœ‰æ•ˆçš„é¿å…ä»¥ä¸‹é”™è¯¯ã€‚ å†²çªè§£å†³è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æžœä½ åœ¨ä¸€ä¸ªåº”ç”¨ä¸­æƒ³ä½¿ç”¨ some_package å’Œ another_packageä¸¤ä¸ªåŒ…ï¼Œè€Œè¿™ä¸¤ä¸ªåŒ…éƒ½ä¾èµ–äºŽurl_launcherçš„ä¸åŒç‰ˆæœ¬ã€‚è¿™å°±ä¼šé€ æˆåŒ…çš„ç‰ˆæœ¬ä¾èµ–å†²çªã€‚é‚£ä¹ˆè¿™ç§æƒ…å†µæˆ‘ä»¬è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿæœ€å¥½çš„æ–¹æ³•æ¥é¿å…è¿™ä¸ªé—®é¢˜å°±æ˜¯åœ¨æŒ‡å®šä¾èµ–çš„æ—¶å€™ä½¿ç”¨ç‰ˆæœ¬èŒƒå›´è€Œä¸æ˜¯ä¸€ä¸ªæŒ‡å®šçš„ç‰ˆæœ¬ã€‚ 123dependencies: url_launcherï¼š^0.4.2 # ä»»æ„çš„0.4.xç‰ˆæœ¬ï¼Œå½“x&gt;=2æ—¶éƒ½ç”Ÿæ•ˆã€‚ image_pickerï¼šâ€˜0.1.1â€™ # åªæœ‰0.1.1ç‰ˆæœ¬ç”Ÿæ•ˆã€‚ å¦‚æžœsome_packageå£°æ˜Žäº†ä¸Šé¢çš„ä¾èµ–é¡¹ï¼Œè€Œå¦ä¸€ä¸ª_packageå£°æ˜Žäº†ä¸€ä¸ªå…¼å®¹çš„url_launcherä¾èµ–é¡¹ï¼Œæ¯”å¦‚â€™0.4.5â€™æˆ–^0.4.0ï¼Œé‚£ä¹ˆPubä¼šè‡ªåŠ¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¹³å°å¯¹Gradleæ¨¡å—å’Œ/æˆ–CocoaPodsçš„ç‰¹å®šä¾èµ–ä¹Ÿä»¥ç±»ä¼¼çš„æ–¹å¼è§£å†³ã€‚ å³ä½¿some_packageå’Œanother_packageå£°æ˜Žurl_launcherçš„ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œå®ƒä»¬å®žé™…ä¸Šå¯èƒ½ä»¥å…¼å®¹çš„æ–¹å¼ä½¿ç”¨url_launcherã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡åœ¨åº”ç”¨ç¨‹åºçš„pubspec.yamlæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–é¡¹è¦†ç›–å£°æ˜Žæ¥è§£å†³å†²çªï¼Œå¼ºåˆ¶ä½¿ç”¨ç‰¹å®šçš„ç‰ˆæœ¬ã€‚ å¼ºåˆ¶ä½¿ç”¨url_launcher 0.4.3 ç‰ˆæœ¬ä¿®æ”¹å¦‚ä¸‹ä»£ç ï¼š 12345dependencies: some_package: another_package:dependency_overrides: url_launcher: &apos;0.4.3&apos; å¼€å‘æ–°åŒ…å¦‚æžœçŽ°æœ‰çš„åŒ…æ»¡è¶³ä¸äº†ä½ çš„ç‰¹å®šéœ€æ±‚ï¼Œä½ å¯ä»¥å¼€å‘ä¸€ä¸ªè‡ªå®šä¹‰çš„åŒ…ã€‚ä¸‹ç¯‡æ–‡ç« æˆ‘ä»¬ä¼šè®²è¿°å¦‚ä½•å¼€å‘ä¸€ä¸ªæ–°åŒ…å’Œæ’ä»¶ã€‚ ç®¡ç†åŒ…ä¾èµ–å’Œç‰ˆæœ¬ä¸ºäº†æ˜¯å†²çªçš„é£Žé™©æœ€ä½Žï¼Œæˆ‘ä»¬å¯ä»¥åœ¨pubspec.yamlä¸­æŒ‡å®šä¸€ä¸ªç‰ˆæœ¬èŒƒå›´ã€‚ä¸ºäº†ç¡®ä¿åº”ç”¨åœ¨åŒ…æ›´æ–°æ—¶ä¸ä¼šä¸­æ–­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æ¥æŒ‡å®šåŒ…ç‰ˆæœ¬èŒƒå›´ï¼š æŒ‡å®šæœ€å°å’Œæœ€å¤§çš„ç‰ˆæœ¬çš„èŒƒå›´çº¦æŸï¼š 12dependencies: url_launcher: &apos;&gt;=0.1.2 &lt;0.2.0&apos; ä½¿ç”¨æ’å…¥ç¬¦å·è¯­æ³•çš„èŒƒå›´çº¦æŸï¼š 12dependencies: collection: &apos;^0.1.2&apos; æ›´æ–°åŒ…ä¾èµ–å½“ä½ æ·»åŠ å®ŒåŒ…ä»¥åŽï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨flutter pub getçš„æ—¶å€™ï¼ŒFlutter ä¿å­˜äº†å…·ä½“çš„åŒ…ç‰ˆæœ¬å·åœ¨pubspec.lock æ–‡ä»¶ä¸­ã€‚è¿™ä¸ªç¡®ä¿ä½ å’Œä½ çš„å›¢é˜Ÿæˆå‘˜åœ¨æ‰§è¡Œflutter pub get å‘½ä»¤æ—¶å¯ä»¥å¾—åˆ°åŒæ ·ç‰ˆæœ¬çš„åŒ…ã€‚ å‡çº§ä¸€ä¸ªåŒ…çš„æ–°ç‰ˆæœ¬ï¼Œä¾‹å¦‚è¦ä½¿ç”¨ä¸€ä¸ªåŒ…çš„æ–°ç‰¹æ€§ï¼Œæ‰§è¡Œflutter pub upgradeæ¥èŽ·å–pubspec.yamlä¸­ç‰ˆæœ¬çº¦æŸä¸­å…è®¸çš„æœ€é«˜å¯ç”¨ç‰ˆæœ¬çš„åŒ…ã€‚ ä¾èµ–æ²¡æœ‰å‘å¸ƒçš„åŒ…æ²¡æœ‰å‘å¸ƒåˆ°pub.devçš„åŒ…ä¹Ÿå¯ä»¥ç”¨ã€‚å¯¹äºŽç§æœ‰çš„æ’ä»¶ï¼Œæˆ–è€…æ²¡æœ‰å‡†å¤‡å¥½å‘å¸ƒçš„åŒ…ï¼Œå¯ä»¥ä½¿ç”¨é™„åŠ çš„ä¾èµ–é¡¹é€‰é¡¹ï¼š Path dependency: ä¸€ä¸ªFlutter åº”ç”¨å¯ä»¥é€šè¿‡ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿè·¯å¾„ä¾èµ–ä¸€ä¸ªæ’ä»¶ï¼Œè·¯å¾„å¯ä»¥æ˜¯ç›¸å¯¹çš„æˆ–è€…ç»å¯¹çš„ã€‚ä¾‹å¦‚è¦ä¾èµ–ä¸€ä¸ªä½äºŽåº”ç”¨ç»Ÿè®¡ç›®å½•çš„æ’ä»¶plugin1,å¯ä»¥ä½¿ç”¨å¦‚ä¸‹è¯­æ³•ï¼š 123dependencies: plugin1: path: ../plugin1/ Git dependency:ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå­˜å‚¨åœ¨gitç‰ˆæœ¬åº“ä¸­çš„åŒ…ï¼Œå¦‚æžœåŒ…ä½äºŽrepoçš„æ ¹ç›®å½•ï¼Œä½¿ç”¨å¦‚ä¸‹è¯­æ³•ï¼š 1234dependencies: plugin1: git: url: git://github.com/flutter/plugin1.git Git dependency on a package in a folder:Pubå‡å®šåŒ…åœ¨Gitå­˜å‚¨ä»“åº“çš„æ ¹ç›®å½•ä¸­ï¼Œå¦‚æžœä¸æ˜¯çš„è¯ï¼Œä½¿ç”¨pathå‚æ•°æ¥æŒ‡å®šè·¯å¾„ï¼Œä¾‹å¦‚ï¼š 12345dependencies: package1: git: url: git://github.com/flutter/packages.git path: packages/package1 æœ€åŽï¼Œå¯ä»¥ä½¿ç”¨ref å‚æ•°å°†ä¾èµ–é¡¹å›ºå®šåˆ°ç‰¹å®šçš„gitæäº¤ï¼Œåˆ†æ”¯æˆ–è€…tagã€‚ åˆ°è¿™é‡Œï¼Œå…³äºŽFlutteråŒ…çš„ä½¿ç”¨å·²ç»ä»‹ç»å®Œäº†ï¼Œä¸ºäº†æ–¹ä¾¿ç†è§£å‘¢ï¼Œæˆ‘è¿˜æ˜¯é™„ä¸Šä¸€ä¸ªä¾‹å­ï¼šFlutteråŒ…çš„ä½¿ç”¨ã€‚]]></content>
      <categories>
        <category>Flutter</category>
      </categories>
      <tags>
        <tag>Flutter</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSå’ŒFlutteré€šä¿¡åˆæŽ¢]]></title>
    <url>%2F2020%2F02%2F15%2FiOS%E5%92%8CFlutter%E9%80%9A%E4%BF%A1%E5%88%9D%E6%8E%A2%2F</url>
    <content type="text"><![CDATA[Flutter ä½¿ç”¨äº†ä¸€å¥—çµæ´»çš„ç³»ç»Ÿæ¥è°ƒç”¨å¹³å°ç‰¹å®šçš„APIs,æ— è®ºæ˜¯iOSè¿˜æ˜¯å®‰å“ã€‚Flutteræ”¯æŒå¹³å°ç‰¹å®šAPIä¸æ˜¯ä¾èµ–äºŽç”Ÿæˆä»£ç çš„æ–¹å¼ï¼Œè€Œæ˜¯é€šè¿‡çµæ´»çš„æ¶ˆæ¯ä¼ é€’ã€‚ åº”ç”¨çš„Flutteréƒ¨åˆ†å‘é€æ¶ˆæ¯åˆ°å®ƒçš„å®¿ä¸»ï¼ˆåº”ç”¨çš„iOSæˆ–è€…Androidéƒ¨åˆ†ï¼‰é€šè¿‡ï¼Œplatform channel. åº”ç”¨å®¿ä¸»åœ¨platform channelä¸Šé¢ç›‘å¬å¹¶ä¸”æŽ¥å—æ¶ˆæ¯ã€‚ç„¶åŽè°ƒç”¨ä»»æ„æ•°é‡çš„ç‰¹å®šå¹³å°çš„APIï¼ˆé€šè¿‡åŽŸç”Ÿè¯­è¨€ï¼‰ï¼Œç„¶åŽå‘é€ä¸€ä¸ªå›žè°ƒç»™åˆ°Flutter éƒ¨åˆ†ã€‚æ³¨æ„ å¦‚æžœæ‚¨éœ€è¦ä½¿ç”¨Java/Kotlin/Objective-Cæˆ–Swiftä¸­çš„å¹³å°apiæˆ–åº“ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨å¹³å°é€šé“æœºåˆ¶ã€‚ä½†æ˜¯ï¼Œé€šè¿‡æ£€æŸ¥defaultTargetPlatformå±žæ€§ï¼Œæ‚¨è¿˜å¯ä»¥åœ¨Flutteråº”ç”¨ç¨‹åºä¸­ç¼–å†™ç‰¹å®šäºŽå¹³å°çš„Dartä»£ç ã€‚å¹³å°é€‚é…åˆ—å‡ºäº†ä¸€äº›ç‰¹å®šäºŽå¹³å°çš„é€‚é…ï¼Œè¿™äº›é€‚é…ä¼šåœ¨æ¡†æž¶ä¸­è‡ªåŠ¨æ‰§è¡ŒFlutterã€‚å¹³å°æ¸ é“çš„æž¶æž„æ¦‚è¿°ä½¿ç”¨å¹³å°é€šé“åœ¨å®¢æˆ·ç«¯(UI)å’Œä¸»æœº(å¹³å°)ä¹‹é—´ä¼ é€’æ¶ˆæ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º: æ¶ˆæ¯å’Œå“åº”æ˜¯å¼‚æ­¥ä¼ é€’çš„ï¼Œä»¥ç¡®ä¿ç”¨æˆ·ç•Œé¢ä¿æŒå“åº”æ€§ã€‚ å°½ç®¡Flutteræ˜¯å¼‚æ­¥åœ°å‘Dartå‘é€æ¶ˆæ¯ï¼Œä½†æ— è®ºä½•æ—¶è°ƒç”¨channelæ–¹æ³•ï¼Œéƒ½å¿…é¡»åœ¨å¹³å°çš„ä¸»çº¿ç¨‹ä¸Šè°ƒç”¨è¯¥æ–¹æ³•ã€‚ åœ¨å®¢æˆ·ç«¯ï¼ŒMethodChannel (API)å…è®¸å‘é€ä¸Žæ–¹æ³•è°ƒç”¨å¯¹åº”çš„æ¶ˆæ¯ã€‚åœ¨å¹³å°ç«¯ï¼ŒAndroidä¸Šçš„MethodChannel (API)å’ŒiOSä¸Šçš„FlutterMethodChannel (API)æ”¯æŒæŽ¥æ”¶æ–¹æ³•è°ƒç”¨å’Œå‘é€ç»“æžœã€‚è¿™äº›ç±»å…è®¸æ‚¨ç”¨å¾ˆå°‘çš„â€œæ ·æ¿â€ä»£ç å¼€å‘å¹³å°æ’ä»¶ã€‚ å¹³å°é€šé“æ•°æ®ç±»åž‹æ”¯æŒå’Œç¼–è§£ç å™¨ æ ‡å‡†å¹³å°é€šé“ä½¿ç”¨æ ‡å‡†æ¶ˆæ¯ç¼–è§£ç å™¨ï¼Œè¯¥ç¼–è§£ç å™¨æ”¯æŒå¯¹ç®€å•çš„jsonç±»å€¼(å¦‚å¸ƒå°”å€¼ã€æ•°å­—ã€å­—ç¬¦ä¸²ã€å­—èŠ‚ç¼“å†²åŒºä»¥åŠè¿™äº›å€¼çš„åˆ—è¡¨å’Œæ˜ å°„)çš„é«˜æ•ˆäºŒè¿›åˆ¶åºåˆ—åŒ–(æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…StandardMessageCodec)ã€‚å½“æ‚¨å‘é€å’ŒæŽ¥æ”¶å€¼æ—¶ï¼Œè¿™äº›å€¼ä¸Žæ¶ˆæ¯ä¹‹é—´çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–å°†è‡ªåŠ¨å‘ç”Ÿã€‚ ä¸‹è¡¨æ˜¾ç¤ºäº†åœ¨å¹³å°ç«¯æŽ¥æ”¶Dartå€¼çš„æ–¹å¼ï¼Œåä¹‹äº¦ç„¶ã€‚ å¥½äº†ï¼ŒåŽŸç†ä»‹ç»å®Œäº†ï¼Œä¸‹é¢ä¸€èµ·æ¥çœ‹ä¸€ä¸‹å…·ä½“æ˜¯å¦‚ä½•è·‘èµ·æ¥çš„ã€‚å‚ç…§å®˜æ–¹æ–‡æ¡£åšäº†ä¸€ä¸ªåœ¨iOSå¹³å°èŽ·å–æ‰‹æœºç”µé‡çš„ä¾‹å­ã€‚è¿™ä¸ªä¾‹å­ä¼šç¤ºèŒƒå¦‚ä½•è°ƒç”¨å¹³å°ç‰¹å®šçš„APIæ¥æ£€ç´¢ä»¥åŠå±•ç¤ºå½“å‰è®¾å¤‡çš„ç”µé‡ã€‚å®ƒå°†ä¼šä½¿ç”¨Android BatteryManager API,å’ŒiOS device.batteryLevel API,é€šè¿‡ä¸€ä¸ªå•ç‹¬çš„å¹³å°æ–¹æ³•ï¼ŒgetBatteryLevel()ã€‚ åˆ›å»ºä¸€ä¸ªflutterå·¥ç¨‹ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åˆ›å»ºï¼š1flutter create platform_channel æˆ–è€…ä½ å¯ä»¥é€šè¿‡è®¾ç½®ç‰¹å®šçš„è¯­è¨€æ¥æŒ‡å®šé»˜è®¤çš„æ¨¡æ¿ï¼š1flutter create -i objc -a java platform_channel ä½¿ç”¨ä½ å®‰è£…çš„ç¼–è¯‘å™¨æ¥æ‰“å¼€åˆ›å»ºå¥½çš„å·¥ç¨‹ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯idea,ç„¶åŽåœ¨ä½ å·¥ç¨‹ä¸­çš„main.darté‡Œé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718class _MyHomePageState extends State&lt;MyHomePage&gt; &#123; // åˆ›å»ºclientå’Œhosté€šä¿¡çš„é€šé“ static const platform = const MethodChannel('charles.flutter.dev/battery'); String _batteryLevel = 'Unknown battery level.'; // èŽ·å–ç”µé‡æ–¹æ³• Future&lt;void&gt; _getBatteryLevel()async&#123; String batteryLevel; try&#123; final int result = await platform.invokeMethod('getBatteryLevel'); batteryLevel = 'Battery level at $result % .'; &#125;on PlatformException catch(e)&#123; batteryLevel = "Failed to get battery level: '$&#123;e.message&#125;'."; &#125; setState(() &#123; _batteryLevel = batteryLevel; &#125;); &#125;&#125; ç®€å•è§£é‡Šä¸€ä¸‹ï¼šé¦–å…ˆåˆ›å»ºäº†platform å®žä¾‹ï¼Œè¿™ä¸ªå°±æ˜¯é€šä¿¡çš„é€šé“ã€‚client å’Œ hostä¹‹é—´é€šè¿‡é€šé“åç§°è¿›è¡Œè¿žæŽ¥ã€‚å•ä¸ªåº”ç”¨ä¸­ä½¿ç”¨çš„æ‰€æœ‰é€šé“åç§°å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œç»™é€šé“åå­—æ·»åŠ åŸŸå‰ç¼€ï¼Œä¾‹å¦‚ï¼šcharles.flutter.dev/batteryã€‚_getBatteryLevel()æ–¹æ³•å°±æ˜¯å¼‚æ­¥çš„èŽ·å–å½“å‰è®¾å¤‡ç”µé‡çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¸­æœ€æ ¸å¿ƒçš„ä¸€å¥ï¼š 1final int result = await platform.invokeMethod(&apos;getBatteryLevel&apos;); å°±æ˜¯é€šè¿‡é€šé“ï¼ŒåŽ»è°ƒç”¨hostç«¯çš„getBatteryLevelæ–¹æ³•ï¼Œå¹¶ä¸”æŠŠèŽ·å–åˆ°çš„å€¼ä½†ä¼šåˆ°clientç«¯ã€‚ å±•ç¤ºç”µé‡çš„éƒ¨åˆ†å°±ä¸ä»‹ç»äº†ã€‚å¤§å®¶å¯ä»¥çœ‹ä¸‹æ–‡é™„çš„Demo. hostç«¯çš„è¯ï¼Œåªä»‹ç»iOSç«¯äº†ï¼Œå®‰å“ç±»ä¼¼ã€‚æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªå·±çœ‹çœ‹ã€‚ä»Žflutter é¡¹ç›®ç›®å½•ä¸‹æ‰¾åˆ° ios/Runner.xcworkspace åŒå‡»æ‰“å¼€ã€‚åœ¨Appdelegate é‡Œé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142#import &lt;Flutter/Flutter.h&gt;#import "GeneratedPluginRegistrant.h"@implementation AppDelegate- (BOOL)application:(UIApplication*)application didFinishLaunchingWithOptions:(NSDictionary*)launchOptions &#123; FlutterViewController* controller = (FlutterViewController*)self.window.rootViewController; FlutterMethodChannel* batteryChannel = [FlutterMethodChannel methodChannelWithName:@"samples.flutter.dev/battery" binaryMessenger:controller]; __weak typeof(self) weakSelf = self; [batteryChannel setMethodCallHandler:^(FlutterMethodCall* call, FlutterResult result) &#123; // Note: this method is invoked on the UI thread. if ([@"getBatteryLevel" isEqualToString:call.method]) &#123; int batteryLevel = [weakSelf getBatteryLevel]; if (batteryLevel == -1) &#123; result([FlutterError errorWithCode:@"UNAVAILABLE" message:@"Battery info unavailable" details:nil]); &#125; else &#123; result(@(batteryLevel)); &#125; &#125; else &#123; result(FlutterMethodNotImplemented); &#125; &#125;]; [GeneratedPluginRegistrant registerWithRegistry:self]; return [super application:application didFinishLaunchingWithOptions:launchOptions];&#125;- (int)getBatteryLevel &#123; UIDevice* device = UIDevice.currentDevice; device.batteryMonitoringEnabled = YES; if (device.batteryState == UIDeviceBatteryStateUnknown) &#123; return -1; &#125; else &#123; return (int)(device.batteryLevel * 100); &#125;&#125;@end è§£é‡Šä¸€ä¸‹ï¼šè¿™æ®µä»£ç ä¹Ÿæ˜¯å…ˆåˆ›å»ºä¸€ä¸ªé€šé“ batteryChannelï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œä½¿ç”¨çš„channel name å’Œä¸Šæ–‡ä¸­æåˆ°çš„ client ç«¯é‡Œé¢çš„å®Œå…¨ä¸€è‡´ã€‚åŒæ—¶è®¾ç½®äº†æ¶ˆæ¯çš„å‘é€è€…ã€‚ getBatteryLevel å°±æ˜¯iOSèŽ·å–ç”µé‡çš„æ–¹æ³•ï¼Œä¸åšè¿‡å¤šè§£é‡Šï¼Œåˆ°æ­¤ä¸ºæ­¢ï¼Œä½ å¯ä»¥è¿è¡Œplatform_channel flutteré¡¹ç›®æ¥çœ‹ä¸€ä¸‹æ˜¯å¦å¯ä»¥èŽ·å–åˆ°å½“å‰æ‰‹æœºçš„ç”µé‡ã€‚ æ•ˆæžœå¦‚ä¸‹ï¼š ä»¥ä¸Šä»‹ç»çš„å°±æ˜¯åˆ©ç”¨MethodChannelä»ŽFlutterç«¯è°ƒç”¨å¹³å°ç«¯å‡½æ•°çš„æ–¹æ³•ã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä»Žå¹³å°ç«¯è°ƒç”¨Flutterç«¯çš„å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¹³å°ç«¯ä»£ç éƒ¨åˆ†ç¼–å†™å¦‚ä¸‹æ–¹æ³•ï¼š 12345- (void)invokeFlutterMethod:(FlutterMethodChannel *)channel &#123; [channel invokeMethod:@"flutterMethod" arguments:nil result:^(id _Nullable result) &#123; NSLog(@"result is %@",result); &#125;];&#125; åœ¨è°ƒç”¨è¿”å›žç”µé‡ç»“æžœåŽï¼Œè°ƒç”¨è¯¥æ–¹æ³•ï¼Œä¸ºäº†æ•ˆæžœæ˜Žæ˜¾æˆ‘ä»¬å»¶è¿Ÿ3ç§’é’Ÿè°ƒç”¨: 123dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(3 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123; [weakSelf invokeFlutterMethod:blockChannel]; &#125;); è€Œåœ¨Flutterç«¯éœ€è¦ç¼–å†™å¦‚ä¸‹ä»£ç ï¼Œåœ¨buildæ–¹æ³•ä¸­æ·»åŠ ç›‘å¬ï¼š 1_platform.setMethodCallHandler(platformCallHandler); å®žçŽ°platformCallHandlerå’ŒflutterMethodæ–¹æ³•ï¼š 12345678910111213Future&lt;dynamic&gt; platformCallHandler(MethodCall call) async &#123; switch (call.method) &#123; case "flutterMethod": flutterMethod(); break; &#125; &#125; void flutterMethod()&#123; setState(() &#123; _batteryLevel = 'å·²ç»èŽ·å–åˆ°ç”µé‡äº†ï¼ï¼ï¼'; &#125;); &#125; ç„¶åŽå†æ¬¡è¿è¡Œç¨‹åºï¼Œå½“èŽ·å–å®Œç”µé‡åŽ3ç§’ï¼ŒæŒ‰é’®ä¸‹æ–¹çš„æ–‡å­—ä¼šå˜æˆâ€å·²ç»èŽ·å–åˆ°ç”µé‡äº†!!!â€(æ­¤å¤„å°±ä¸å†æä¾›Gifäº†) é™„ï¼šæœ¬æ–‡çš„Demo]]></content>
      <categories>
        <category>Flutter</category>
      </categories>
      <tags>
        <tag>Flutter</tag>
        <tag>iOS</tag>
        <tag>Objective-C</tag>
        <tag>Dart</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSæ··åˆFlutteråˆæŽ¢]]></title>
    <url>%2F2020%2F02%2F13%2FiOS%E6%B7%B7%E5%90%88Flutter%E5%88%9D%E6%8E%A2%2F</url>
    <content type="text"><![CDATA[ç”±äºŽæœ€è¿‘å…¬å¸é¡¹ç›®é‡Œé¢è¦ç”¨åˆ°Flutterï¼Œæ•…ç ”ç©¶äº†ä¸€ç•ªiOSå’ŒFlutteræ˜¯å¦‚ä½•åœ¨ä¸€èµ·å·¥ä½œçš„ã€‚ä¸‹é¢æˆ‘ä»¬å°±ä¸€æ­¥æ­¥çš„æ¥ä»‹ç»ä¸€ä¸‹ï¼šå¼€å‘çŽ¯å¢ƒåœ¨ä½ å¿ƒçˆ±çš„Macä¸Šé¢å®‰è£…å¥½Flutter 1.12.13+hotfix.8 â€¢ channel stable â€¢ã€Xcode 11.2.1ã€‚ æç¤ºï¼šFlutter æ”¯æŒåˆ°iOS8ä»¥ä¸Šã€‚ é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªiOSé¡¹ç›®ios_flutter_hybrid è¿™é‡Œå°±ä¸å†è¯¦ç»†ä»‹ç»è¯¥é¡¹ç›®æ˜¯å¦‚ä½•åˆ›å»ºçš„äº†ã€‚ç„¶åŽé›†æˆflutter_moduleåˆ°iOSé¡¹ç›®ä¸­,flutter å¯ä»¥ä½œä¸ºä¸€ä¸ªframeworkåµŒå…¥åˆ°çŽ°æœ‰çš„iOSé¡¹ç›®ä¸­ã€‚è¦å°†flutteråµŒå…¥åˆ°çŽ°æœ‰çš„iOSå·¥ç¨‹ä¸­ï¼Œé¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªflutter_module,å®ƒçš„ç›®å½•ä½ç½®æœ€å¥½å’Œé¡¹ç›®ç›®å½•æ˜¯å¹³è¡Œçš„ã€‚æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š 12cd ios_flutter_hybridflutter create -t module flutter_module å‡ºçŽ°å¦‚ä¸‹logå°±è¯´æ˜Žæ‰§è¡ŒæˆåŠŸäº†ï¼š 123456789101112131415161718Creating project flutter_module... flutter_module/test/widget_test.dart (created) flutter_module/flutter_module.iml (created) flutter_module/.gitignore (created) flutter_module/.metadata (created) flutter_module/pubspec.yaml (created) flutter_module/README.md (created) flutter_module/lib/main.dart (created) flutter_module/flutter_module_android.iml (created) flutter_module/.idea/libraries/Flutter_for_Android.xml (created) flutter_module/.idea/libraries/Dart_SDK.xml (created) flutter_module/.idea/modules.xml (created) flutter_module/.idea/workspace.xml (created)Running &quot;flutter pub get&quot; in flutter_module... 2.0sWrote 12 files.All done!Your module code is in flutter_module/lib/main.dart. åµŒå…¥flutter module åˆ°çŽ°æœ‰å·¥ç¨‹ä¸­æœ‰ä¸¤ç§æ–¹å¼å°†FlutteråµŒå…¥åˆ°é¡¹ç›®ä¸­1.ä½¿ç”¨pod install å®‰è£…ï¼ˆæŽ¨èä½¿ç”¨ï¼‰ ï¼ˆé…ç½®ä¸€ä¸‹podfileä¸‹é¢ä¼šè®²è§£ï¼‰2.ä½ ç¼–è¯‘å¥½ä¸€ä¸ªframeworkï¼Œç„¶åŽæ‰‹åŠ¨åµŒå…¥åˆ°é¡¹ç›®ä¸­ï¼Œå¹¶ä¸”å¥½æ‰‹åŠ¨æ›´æ–°ç¼–è¯‘é…ç½®ã€‚æ³¨æ„å’ŒFlutter æ··åˆçš„åº”ç”¨ä¸å¯ä»¥åœ¨simulator ä¸Šé¢è¿è¡ŒReleaseæ¨¡å¼ï¼Œå› ä¸ºflutter ä¸æ”¯æŒä¸ºDartä»£ç æå‰è¾“å‡ºx86äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä½ å¯ä»¥åœ¨æ¨¡æ‹Ÿå™¨æˆ–çœŸæœºä¸Šé¢è¿è¡ŒReleaseæ¨¡å¼ã€‚ æˆ‘é€‰æ‹©çš„æ˜¯ä½¿ç”¨podæ¥åµŒå…¥flutter framework. éœ€è¦è¯´æ˜Žçš„æ˜¯flutter æ¨¡å—çš„ç›®å½•å’Œåº”ç”¨ç¨‹åºçš„ç›®å½•æ˜¯å¹³è¡Œçš„ï¼Œå¦åˆ™å¯èƒ½éœ€è¦è°ƒæ•´ç›¸å¯¹è·¯å¾„ã€‚ç›®å½•ç»“æž„å¦‚ä¸‹ï¼š 1234567some/path/â”œâ”€â”€ flutter_module/â”‚ â””â”€â”€ .ios/â”‚ â””â”€â”€ Flutter/â”‚ â””â”€â”€ podhelper.rbâ””â”€â”€ ios_flutter_hybrid/ â””â”€â”€ Podfile å¦‚æžœæ–°åˆ›å»ºçš„é¡¹ç›®æ²¡æœ‰podfile å°±åˆ›å»ºä¸€ä¸ªpodfileã€‚ç„¶åŽåœ¨podfileé‡Œé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456flutter_application_path = &apos;../flutter_module&apos;load File.join(flutter_application_path, &apos;.ios&apos;, &apos;Flutter&apos;, &apos;podhelper.rb&apos;)target &apos;ios_flutter_hybrid&apos; do install_all_flutter_pods(flutter_application_path)end å¯¹äºŽæ¯ä¸€ä¸ªéœ€è¦åµŒå…¥flutterçš„podfile ç›®æ ‡ï¼Œè°ƒç”¨ install_all_flutter_pods(flutter_application_path) æ–¹æ³•ã€‚æŽ¥ä¸‹æ¥åªéœ€è¦æ‰§è¡Œ pod install å³å¯ã€‚ æ³¨æ„å½“ä½ åœ¨pubspec.yamlä¸­ä¿®æ”¹äº†flutter pluginçš„ä¾èµ–å…³ç³»ï¼Œåœ¨flutter moduleç›®å½•ä¸‹è¿è¡Œflutter pub get å‘½ä»¤æ¥æ›´æ–°podhelper.rbè„šæœ¬è¯»å–çš„æ’ä»¶åˆ—è¡¨ã€‚ç„¶åŽæ‰§è¡Œpod install æ¥å®‰è£…æ›´æ–°ã€‚podhelper.rbè„šæœ¬å°†ä½ çš„pluginã€Flutter.frameworkã€App.frameworkåµŒå…¥åˆ°å·¥ç¨‹ä¸­ã€‚æ­¤æ—¶ï¼Œä½ å°±å¼€æ‰“å¼€ios_flutter_hybrid.xcworkspace æ¥è¿è¡Œæ··åˆå¥½çš„é¡¹ç›®äº†ã€‚ æ·»åŠ ä¸€ä¸ªflutter é¡µé¢è¿›å…¥åˆ°ä¸Šé¢çš„å·¥ç¨‹ä¸­é¦–å…ˆè¦åœ¨Appdelegateé‡Œé¢åˆ›å»ºä¸€ä¸ªFlutterEngineå¦‚ä¸‹ä»£ç ï¼š 123456@import UIKit;@import Flutter;@interface AppDelegate : FlutterAppDelegate // More on the FlutterAppDelegate below.@property (nonatomic,strong) FlutterEngine *flutterEngine;@end å®žçŽ°éƒ¨åˆ†ï¼š 1234567891011121314#import &quot;AppDelegate.h&quot;#import &lt;FlutterPluginRegistrant/GeneratedPluginRegistrant.h&gt; // Used to connect plugins.@interface AppDelegate ()@end@implementation AppDelegate- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; // Override point for customization after application launch. self.flutterEngine = [[FlutterEngine alloc] initWithName:@&quot;my flutter engine&quot;]; // Runs the default Dart entrypoint with a default Flutter route. [self.flutterEngine run]; [GeneratedPluginRegistrant registerWithRegistry:self.flutterEngine]; return [super application:application didFinishLaunchingWithOptions:launchOptions];&#125; æŽ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ViewControlleré‡Œé¢å†™ä¸€ä¸ªç‚¹å‡»äº‹ä»¶æ¥åŠèµ·ä¸€ä¸ªFlutteré¡µé¢ã€‚åœ¨ViewControllerçš„viewDidLoadæ–¹æ³•ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 12345678910111213- (void)viewDidLoad &#123; [super viewDidLoad]; // Make a button to call the showFlutter function when pressed. UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom]; [button addTarget:self action:@selector(showFlutter) forControlEvents:UIControlEventTouchUpInside]; [button setTitle:@&quot;Show Flutter!&quot; forState:UIControlStateNormal]; button.backgroundColor = UIColor.blueColor; button.frame = CGRectMake(80.0, 210.0, 160.0, 40.0); [self.view addSubview:button];&#125; åŒæ—¶å®žçŽ°ä¸€ä¸ªshowFlutteræ–¹æ³•: 1234567- (void)showFlutter &#123; FlutterEngine *flutterEngine = ((AppDelegate *)UIApplication.sharedApplication.delegate).flutterEngine; FlutterViewController *flutterViewController = [[FlutterViewController alloc] initWithEngine:flutterEngine nibName:nil bundle:nil]; [self presentViewController:flutterViewController animated:YES completion:nil];&#125; æ­¤æ—¶è¿è¡Œä¸€ä¸‹å·¥ç¨‹æŸ¥çœ‹æ•ˆæžœã€‚ä¸å‡ºæ„å¤–çš„è¯ä½ ä¼šæˆåŠŸçš„è°ƒèµ·æ¥ä¸€ä¸ªFlutter é¡µé¢ã€‚ æ··åˆé¡¹ç›®å¦‚ä½•è°ƒè¯•æ··åˆçš„é¡¹ç›®ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨flutterçš„çƒ­æ›´æ–°ä»¥åŠçƒ­é‡å¯çš„ã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬å°±ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ã€‚ é¦–å…ˆå°†æ··åˆå¥½çš„é¡¹ç›®è¿è¡Œåˆ°æ‰‹æœºä¸Šï¼Œè¿›å…¥flutteré¡µé¢ã€‚ ç„¶åŽcd åˆ°flutter_moduleç›®å½•ä¸‹ï¼Œæ‰§è¡Œflutter attachå‘½ä»¤ã€‚å¦‚æžœæ‰“å°çš„æœ‰å¦‚ä¸‹æ—¥å¿—ï¼Œåˆ™è¯´æ˜ŽæˆåŠŸäº†ï¼š 123456 Syncing files to device Charlesçš„iPhone... 4,694ms (!) ðŸ”¥ To hot reload changes while running, press &quot;r&quot;. To hot restart (and rebuild state), press &quot;R&quot;.An Observatory debugger and profiler on Charlesçš„iPhone is available at: http://127.0.0.1:1024/RkN8tMSDSoE=/For a more detailed help message, press &quot;h&quot;. To detach, press &quot;d&quot;; to quit, press &quot;q&quot;. æŽ¥ä¸‹æ¥å°±å¯ä»¥æ„‰å¿«çš„å¼€å‘è°ƒè¯•ç•Œé¢äº†ã€‚ æœ¬æ–‡Demoä»£ç  ä¸‹ç¯‡æ–‡ç« æˆ‘ä»¬ä¸€èµ·æ¥æŽ¢è®¨flutter å’Œ åŽŸç”ŸiOSä»£ç ä¹‹é—´æ˜¯å¦‚ä½•é€šä¿¡çš„ã€‚ æ¬¢è¿Žå‹˜è¯¯ï¼]]></content>
      <categories>
        <category>Flutter</category>
      </categories>
      <tags>
        <tag>Flutter</tag>
        <tag>iOS</tag>
        <tag>Objective-C</tag>
        <tag>Dart</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å½»åº•è§£å†³pod installé¾Ÿé€Ÿé—®é¢˜]]></title>
    <url>%2F2020%2F02%2F08%2F%E5%BD%BB%E5%BA%95%E8%A7%A3%E5%86%B3pod-install%E9%BE%9F%E9%80%9F%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘ç”±äºŽç–«æƒ…ä¸¥é‡ï¼Œæˆ‘å¸æžœæ–­å®‰æŽ’åœ¨å®¶åŠžå…¬ï¼Œåœ¨é…ç½®å¼€å‘çŽ¯å¢ƒçš„æ—¶å€™æˆ‘é‡åˆ°äº†è®©æˆ‘éžå¸¸å¤´ç–¼çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯ pod install æ‰§è¡Œæ—¶æ…¢çš„è¦æ­»ã€‚å¿ä¸äº†å•Šï¼Œæœç´¢äº†ä¸€ç•ªä¹‹åŽæ‰¾åˆ°äº†æœ‰æ•ˆçš„æ–¹æ³•ï¼Œåœ¨æ­¤åšä¸€ä¸ªMarkã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹æ˜¯å¦‚ä½•æé«˜pod install çš„å®‰è£…é€Ÿåº¦çš„ã€‚ å…¶å®žï¼Œpod çœŸæ­£æ…¢çš„åŽŸå› ä¸åœ¨äºŽä½ æ‰§è¡Œçš„pod å‘½ä»¤è€Œæ˜¯githubä¸Šé¢çš„ä»£ç åº“è®¿é—®é€Ÿåº¦çœŸçš„æ…¢ï¼Œç¿»å¢™ä¹Ÿä¸è¡Œå•Šã€‚é‚£ä¹ˆçœŸæ­£çš„tè§£å†³åŠžæ³•æ˜¯æé«˜git å‘½ä»¤çš„é€Ÿé€Ÿã€‚ æˆ‘ä»¬å¼€å‘è€…ä¸€èˆ¬éƒ½ä¼šç”¨ä»£ç†å·¥å…·ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯Shadowsocksä»£ç†ï¼Œæˆ‘çš„é»˜è®¤ç«¯å£å·æ˜¯1086ï¼Œå¦‚ä¸‹å›¾ï¼š æ‹¿åˆ°ä¸Šå›¾ä¸­çš„ç«¯å£å·ä¹‹åŽï¼Œæˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼š1git config --global http.https://github.com.proxy socks5://127.0.0.1:1086 è¿™ä¸ªå‘½ä»¤ä¸­æˆ‘è®¾ç½®äº†åªæ˜¯githubä¸Šçš„ä»£ç åº“æ‰èµ°ä»£ç†ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™git è®¾ç½®å…¨å±€ä»£ç†ï¼š1git config --global http.proxy socks5://127.0.0.1:1086 ä½†æ˜¯ç¬¬ä¸€ä¸ªå‘½ä»¤æ‰æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚ æ‰§è¡Œå®Œä¹‹åŽå¯ä»¥å¯¹æ¯”ä¸€ä¸‹å®‰è£…çš„é€Ÿåº¦ï¼šé…ç½®å‘½ä»¤ä¹‹å‰çš„é€Ÿåº¦ï¼š é…ç½®å‘½ä»¤ä¹‹åŽçš„é€Ÿé€Ÿï¼š ä»Žå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé€Ÿåº¦æé«˜äº†è®¸å¤šå€å•Šï¼ï¼ æœ€åŽæç¤ºä¸€ä¸‹ï¼Œå¦‚æžœæƒ³åŽ»æŽ‰ä¸Šé¢æˆ‘ä»¬é…ç½®å‘½ä»¤å¯ä»¥é‡‡ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š 12åŽ»æŽ‰å…¨å±€gitä»£ç†git config --global --unset http.proxy 12åŽ»æŽ‰githubä»£ç†git config --global --unset http.https://github.com.proxy]]></content>
      <categories>
        <category>æŠ€æœ¯äººç”Ÿ</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SDWebImage (5.0.6) å›¾ç‰‡ç¼“å­˜è¯»å†™åŽŸç†]]></title>
    <url>%2F2019%2F08%2F04%2FSDWebImage%20(5.0.6)%20%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98%E8%AF%BB%E5%86%99%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[SDWebImage (5.0.6)å›¾ç‰‡åŠ è½½å¥‡æ·«å·§æŠ€ è¿™ç¯‡æ–‡ç« ä»‹ç»äº†SDWebImageåŠ è½½å›¾ç‰‡çš„æµç¨‹æ˜¯æ€Žæ ·çš„ï¼Œæœ¬æ–‡æˆ‘ä»¬ä¸€èµ·è®¨è®ºä¸€ä¸‹ï¼ŒSDWebImageæ¡†æž¶çš„ç¼“å­˜æœºåˆ¶æ˜¯æ€Žä¹ˆæ ·çš„ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹åŠ è½½è¿‡ç¨‹ä¸­ï¼ŒSDWebImageæ˜¯å¦‚ä½•ä»Žç¼“å­˜ä¸­è¯»å–æˆ‘ä»¬æ‰€éœ€çš„å›¾ç‰‡çš„ï¼Œæˆ‘ä»¬å…ˆæ‰¾åˆ°è¯»å–ç¼“å­˜çš„å…¥å£ï¼š12// Start the entry to load image from cache [self callCacheProcessForOperation:operation url:url options:options context:context progress:progressBlock completed:completedBlock]; è¿™ä¸ªæ–¹æ³•å°±æ˜¯å¼€å§‹ä»Žç¼“å­˜ä¸­è¯»å–ï¼Œæ–¹æ³•å†…éƒ¨å®žçŽ°å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627// Query cache process- (void)callCacheProcessForOperation:(nonnull SDWebImageCombinedOperation *)operationurl:(nonnull NSURL *)urloptions:(SDWebImageOptions)optionscontext:(nullable SDWebImageContext *)contextprogress:(nullable SDImageLoaderProgressBlock)progressBlockcompleted:(nullable SDInternalCompletionBlock)completedBlock &#123; // Check whether we should query cache BOOL shouldQueryCache = (options &amp; SDWebImageFromLoaderOnly) == 0; if (shouldQueryCache) &#123; id&lt;SDWebImageCacheKeyFilter&gt; cacheKeyFilter = context[SDWebImageContextCacheKeyFilter]; NSString *key = [self cacheKeyForURL:url cacheKeyFilter:cacheKeyFilter]; @weakify(operation); operation.cacheOperation = [self.imageCache queryImageForKey:key options:options context:context completion:^(UIImage * _Nullable cachedImage, NSData * _Nullable cachedData, SDImageCacheType cacheType) &#123; @strongify(operation); if (!operation || operation.isCancelled) &#123; [self safelyRemoveOperationFromRunning:operation]; return; &#125; // Continue download process [self callDownloadProcessForOperation:operation url:url options:options context:context cachedImage:cachedImage cachedData:cachedData cacheType:cacheType progress:progressBlock completed:completedBlock]; &#125;]; &#125; else &#123; // Continue download process [self callDownloadProcessForOperation:operation url:url options:options context:context cachedImage:nil cachedData:nil cacheType:SDImageCacheTypeNone progress:progressBlock completed:completedBlock]; &#125;&#125; ä»Žä¸Šé¢çš„æºç å¯ä»¥çœ‹å‡ºï¼Œé¦–å…ˆä¼šåˆ¤æ–­ä¸€ä¸‹æ˜¯å¦éœ€è¦ä»Žç¼“å­˜ä¸­è¯»å–ï¼Œå¦‚æžœä¸éœ€è¦å°±ç›´æŽ¥åŽ»ä¸‹è½½äº†ã€‚å¦‚æžœéœ€è¦çš„è¯ï¼Œå°±ä¼šä½¿ç”¨self.imageCacheå®žä¾‹åŽ»æŸ¥è¯¢ç¼“å­˜ï¼Œæ ¸å¿ƒä»£ç ï¼š123456789[self.imageCache queryImageForKey:key options:options context:context completion:^(UIImage * _Nullable cachedImage, NSData * _Nullable cachedData, SDImageCacheType cacheType) &#123; @strongify(operation); if (!operation || operation.isCancelled) &#123; [self safelyRemoveOperationFromRunning:operation]; return; &#125; // Continue download process [self callDownloadProcessForOperation:operation url:url options:options context:context cachedImage:cachedImage cachedData:cachedData cacheType:cacheType progress:progressBlock completed:completedBlock];&#125;]; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæŸ¥è¯¢ç»“æžœå›žè°ƒä¹‹åŽï¼Œåˆè°ƒç”¨äº†ä¸‹è½½æ–¹æ³•ï¼Œè¿™æ—¶å› ä¸ºç¼“å­˜æŸ¥è¯¢çš„ç»“æžœä¹Ÿåœ¨ä¸‹è½½æ–¹æ³•é‡Œé¢å¤„ç†äº†ã€‚æˆ‘ä»¬æŽ¥ç€çœ‹æŸ¥è¯¢ç¼“å­˜çš„æ–¹æ³•ï¼šqueryImageForKey: çœ‹ä¸‹å®ƒçš„å†…éƒ¨å®žçŽ°:1234567891011- (id&lt;SDWebImageOperation&gt;)queryImageForKey:(NSString *)key options:(SDWebImageOptions)options context:(nullable SDWebImageContext *)context completion:(nullable SDImageCacheQueryCompletionBlock)completionBlock &#123; SDImageCacheOptions cacheOptions = 0; if (options &amp; SDWebImageQueryMemoryData) cacheOptions |= SDImageCacheQueryMemoryData; if (options &amp; SDWebImageQueryMemoryDataSync) cacheOptions |= SDImageCacheQueryMemoryDataSync; if (options &amp; SDWebImageQueryDiskDataSync) cacheOptions |= SDImageCacheQueryDiskDataSync; if (options &amp; SDWebImageScaleDownLargeImages) cacheOptions |= SDImageCacheScaleDownLargeImages; if (options &amp; SDWebImageAvoidDecodeImage) cacheOptions |= SDImageCacheAvoidDecodeImage; if (options &amp; SDWebImageDecodeFirstFrameOnly) cacheOptions |= SDImageCacheDecodeFirstFrameOnly; if (options &amp; SDWebImagePreloadAllFrames) cacheOptions |= SDImageCachePreloadAllFrames; return [self queryCacheOperationForKey:key options:cacheOptions context:context done:completionBlock];&#125; è¿™ä¸ªæ–¹æ³•é‡Œé¢åšäº†ä¸€å †è·Ÿç¼“å­˜ç›¸å…³çš„æ¡ä»¶åˆ¤æ–­ï¼Œç„¶åŽè°ƒç”¨äº†queryCacheOperationForKey:è¿™ä¸ªæ–¹æ³•ï¼Œæ­£å¼è¿›å…¥ç¼“å­˜æŸ¥è¯¢ã€‚æˆ‘ä»¬æŽ¥ç€çœ‹è¿™ä¸ªæ–¹æ³•çš„æºç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586- (nullable NSOperation *)queryCacheOperationForKey:(nullable NSString *)key options:(SDImageCacheOptions)options context:(nullable SDWebImageContext *)context done:(nullable SDImageCacheQueryCompletionBlock)doneBlock &#123; if (!key) &#123; if (doneBlock) &#123; doneBlock(nil, nil, SDImageCacheTypeNone); &#125; return nil; &#125; id&lt;SDImageTransformer&gt; transformer = context[SDWebImageContextImageTransformer]; if (transformer) &#123; // grab the transformed disk image if transformer provided NSString *transformerKey = [transformer transformerKey]; key = SDTransformedKeyForKey(key, transformerKey); &#125; // First check the in-memory cache... UIImage *image = [self imageFromMemoryCacheForKey:key]; if ((options &amp; SDImageCacheDecodeFirstFrameOnly) &amp;&amp; image.sd_isAnimated) &#123; #if SD_MAC image = [[NSImage alloc] initWithCGImage:image.CGImage scale:image.scale orientation:kCGImagePropertyOrientationUp]; #else image = [[UIImage alloc] initWithCGImage:image.CGImage scale:image.scale orientation:image.imageOrientation]; #endif &#125; BOOL shouldQueryMemoryOnly = (image &amp;&amp; !(options &amp; SDImageCacheQueryMemoryData)); if (shouldQueryMemoryOnly) &#123; if (doneBlock) &#123; doneBlock(image, nil, SDImageCacheTypeMemory); &#125; return nil; &#125; // Second check the disk cache... NSOperation *operation = [NSOperation new]; // Check whether we need to synchronously query disk // 1. in-memory cache hit &amp; memoryDataSync // 2. in-memory cache miss &amp; diskDataSync BOOL shouldQueryDiskSync = ((image &amp;&amp; options &amp; SDImageCacheQueryMemoryDataSync) || (!image &amp;&amp; options &amp; SDImageCacheQueryDiskDataSync)); void(^queryDiskBlock)(void) = ^&#123; if (operation.isCancelled) &#123; // do not call the completion if cancelled return; &#125; @autoreleasepool &#123; NSData *diskData = [self diskImageDataBySearchingAllPathsForKey:key]; UIImage *diskImage; SDImageCacheType cacheType = SDImageCacheTypeNone; if (image) &#123; // the image is from in-memory cache, but need image data diskImage = image; cacheType = SDImageCacheTypeMemory; &#125; else if (diskData) &#123; cacheType = SDImageCacheTypeDisk; // decode image data only if in-memory cache missed diskImage = [self diskImageForKey:key data:diskData options:options context:context]; if (diskImage &amp;&amp; self.config.shouldCacheImagesInMemory) &#123; NSUInteger cost = diskImage.sd_memoryCost; [self.memCache setObject:diskImage forKey:key cost:cost]; &#125; &#125; if (doneBlock) &#123; if (shouldQueryDiskSync) &#123; doneBlock(diskImage, diskData, cacheType); &#125; else &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; doneBlock(diskImage, diskData, cacheType); &#125;); &#125; &#125; &#125; &#125;; // Query in ioQueue to keep IO-safe if (shouldQueryDiskSync) &#123; dispatch_sync(self.ioQueue, queryDiskBlock); &#125; else &#123; dispatch_async(self.ioQueue, queryDiskBlock); &#125; return operation;&#125; æŽ¥ä¸‹æ¥æˆ‘ä»¬è§£æžä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼šé¦–å…ˆåšäº†å‚æ•°åˆæ³•æ€§åˆ¤æ–­ï¼Œä¸æ»¡è¶³æ¡ä»¶ç›´æŽ¥è¿”å›žç©ºã€‚ç´§æŽ¥ç€å°±æ˜¯ä»Žå†…å­˜ç¼“å­˜ä¸­æŸ¥è¯¢æˆ‘ä»¬éœ€è¦çš„å›¾ç‰‡ï¼š12// First check the in-memory cache...UIImage *image = [self imageFromMemoryCacheForKey:key]; è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ç›´æŽ¥ä»ŽmemCacheä¸­æŒ‰ç…§keyæ¥è¯»å–ï¼š [self.memCache objectForKey:key];æŽ¥ä¸‹æ¥åˆ¤æ–­å›¾ç‰‡æ˜¯å¦æ˜¯åŠ¨å›¾ï¼Œåšç›¸åº”çš„å¤„ç†ã€‚ç„¶åŽï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯åªéœ€åœ¨å†…å­˜ä¸­æŸ¥æ‰¾ï¼Œå¦‚æžœæ˜¯çš„è¯ç›´æŽ¥è¿”å›žåˆšæ‰æŸ¥åˆ°çš„å›¾ç‰‡ï¼Œå¹¶ç»“æŸæ–¹æ³•è°ƒç”¨ã€‚å¦‚æžœä¸æ˜¯çš„è¯ï¼Œå°±åŽ»ç¡¬ç›˜ä¸­æŸ¥æ‰¾ã€‚1NSData *diskData = [self diskImageDataBySearchingAllPathsForKey:key]; æˆ‘ä»¬å…ˆæŠŠè¿™ä¸ªæµç¨‹çœ‹å®Œå†æ¥çœ‹ç©¶ç«Ÿæ˜¯å¦‚ä½•ä»Žç£ç›˜ä¸­è¯»å–Dataçš„ã€‚æŽ¥ä¸‹æ¥é€šè¿‡ä¸€ç³»åˆ—æ¡ä»¶å¾—å‡ºæ˜¯å¦éœ€è¦åŒæ­¥æŸ¥è¯¢ç¼“å­˜ï¼š12BOOL shouldQueryDiskSync = ((image &amp;&amp; options &amp; SDImageCacheQueryMemoryDataSync) ||(!image &amp;&amp; options &amp; SDImageCacheQueryDiskDataSync)); ç„¶åŽç”Ÿå‘½ä¸€ä¸ªç£ç›˜æŸ¥è¯¢çš„block: queryDiskBlockå¼€å§‹æŸ¥è¯¢ã€‚æŽ¥ä¸‹æ¥åˆ¤æ–­æ˜¯å¦ä»Žå†…å­˜ä¸­è¯»å–åˆ°äº†å›¾ç‰‡ï¼Œå¦‚æžœæœ‰çš„è¯ï¼Œä¸åšå…¶ä»–å¤„ç†ï¼Œæœ€åŽå›žè°ƒçš„æ—¶å€™æŠŠdiskDataä¸€èµ·å›žè°ƒå‡ºåŽ»å°±å¯ä»¥äº†ã€‚å¦‚æžœæ²¡æœ‰ä»Žå†…å­˜ä¸­è¯»å–åˆ°å›¾ç‰‡ï¼Œåˆ™å°±è¦çœ‹diskDataæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æžœä¸ä¸ºç©ºï¼Œå°±å¯¹diskDataè¿›è¡Œè§£ç å¤„ç†ï¼Œå¾—åˆ°æˆ‘ä»¬éœ€è¦çš„diskImageã€‚12// decode image data only if in-memory cache misseddiskImage = [self diskImageForKey:key data:diskData options:options context:context]; ç„¶åŽæŠŠå¾—åˆ°çš„diskImageæ”¾åˆ°å†…å­˜ç¼“å­˜ä¸­ä¸€ä»½ã€‚1234if (diskImage &amp;&amp; self.config.shouldCacheImagesInMemory) &#123; NSUInteger cost = diskImage.sd_memoryCost; [self.memCache setObject:diskImage forKey:key cost:cost];&#125; åˆ°è¿™é‡Œï¼Œä»Žå†…å­˜ä»¥åŠç£ç›˜ä¸­è¯»å–ç¼“å­˜çš„æµç¨‹å®Œæ¯•ï¼ŒæŽ¥ä¸‹æ¥å°±æ˜¯æŠŠæˆ‘ä»¬è¯»å–å‡ºæ¥çš„å›¾ç‰‡æ•°æ®è¿”å›žç»™è°ƒç”¨æ–¹äº†ã€‚123456789if (doneBlock) &#123; if (shouldQueryDiskSync) &#123; doneBlock(diskImage, diskData, cacheType); &#125; else &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; doneBlock(diskImage, diskData, cacheType); &#125;); &#125;&#125; æœ€åŽå°±æ˜¯æ ¹æ®æ˜¯å¦éœ€è¦åŒæ­¥æŸ¥è¯¢æ¥è°ƒç”¨queryDiskBlockäº†ã€‚è¿™å°±æ˜¯å›¾ç‰‡ç¼“å­˜æŸ¥è¯¢çš„æµç¨‹ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å›žå¤´çœ‹ä¸€ä¸‹ç£ç›˜ç¼“å­˜æŸ¥è¯¢ç©¶ç«Ÿæ˜¯å¦‚ä½•å®žçŽ°çš„ã€‚1NSData *diskData = [self diskImageDataBySearchingAllPathsForKey:key]; æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨å®žçŽ°ï¼š1234567891011121314151617181920- (nullable NSData *)diskImageDataBySearchingAllPathsForKey:(nullable NSString *)key &#123; if (!key) &#123; return nil; &#125; NSData *data = [self.diskCache dataForKey:key]; if (data) &#123; return data; &#125; // Addtional cache path for custom pre-load cache if (self.additionalCachePathBlock) &#123; NSString *filePath = self.additionalCachePathBlock(key); if (filePath) &#123; data = [NSData dataWithContentsOfFile:filePath options:self.config.diskCacheReadingOptions error:nil]; &#125; &#125; return data;&#125; é¦–å…ˆæ˜¯keyå‚æ•°åˆ¤æ–­ï¼Œå…¶æ¬¡ä»ŽdiskCacheä¸­é€šè¿‡keyæ¥è¯»å–ï¼Œå¦‚æžœç£ç›˜ç¼“å­˜ï¼Œå†…å­˜ä¸­å·²ç»è¯»å–è¿‡çš„è¯ï¼Œç›´æŽ¥è¿”å›žã€‚å¦åˆ™çš„è¯ï¼Œå°±ä¼šé€šè¿‡keyå¾—å‡ºç£ç›˜ç¼“å­˜çš„è·¯å¾„ï¼Œç„¶åŽè¯»å–å‡ºæ¥ï¼Œè¿”å›žç»™è°ƒç”¨æ–¹ã€‚ æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹ä¸€ä¸‹ï¼Œä»ŽServerç«¯ä¸‹è½½å®Œå›¾ç‰‡åŽï¼ŒSDWebImageæ˜¯å¦‚ä½•å¤„ç†çš„ä»–ä¸¤çº§ï¼ˆå†…å­˜ç¼“å­˜ã€ç£ç›˜ç¼“å­˜ï¼‰ç¼“å­˜çš„ã€‚åŒæ ·çš„æˆ‘ä»¬å…ˆæ‰¾åˆ°ä¿å­˜ç¼“å­˜çš„å…¥å£æ–¹æ³•ï¼š1[self callStoreCacheProcessForOperation:operation url:url options:options context:context downloadedImage:downloadedImage downloadedData:downloadedData finished:finished progress:progressBlock completed:completedBlock]; è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨æ—¶æœºï¼Œæ˜¯åœ¨ä»Žç½‘ç»œä¸‹è½½å®Œå›¾ç‰‡çš„å›žè°ƒä¸­ã€‚è¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨å®žçŽ°ä¸­æœ‰ä¸€å¥å¾ˆé‡è¦çš„ä»£ç ï¼Œå°±æ˜¯æˆ‘ä»¬å­˜å‚¨ç¼“å­˜çš„ä»£ç ï¼š1[self.imageCache storeImage:downloadedImage imageData:cacheData forKey:key cacheType:storeCacheType completion:nil]; æŽ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œè¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨å®žçŽ°ï¼š1234567891011121314151617181920212223242526- (void)storeImage:(UIImage *)image imageData:(NSData *)imageData forKey:(nullable NSString *)key cacheType:(SDImageCacheType)cacheType completion:(nullable SDWebImageNoParamsBlock)completionBlock &#123;switch (cacheType) &#123; case SDImageCacheTypeNone: &#123; [self storeImage:image imageData:imageData forKey:key toMemory:NO toDisk:NO completion:completionBlock]; &#125; break; case SDImageCacheTypeMemory: &#123; [self storeImage:image imageData:imageData forKey:key toMemory:YES toDisk:NO completion:completionBlock]; &#125; break; case SDImageCacheTypeDisk: &#123; [self storeImage:image imageData:imageData forKey:key toMemory:NO toDisk:YES completion:completionBlock]; &#125; break; case SDImageCacheTypeAll: &#123; [self storeImage:image imageData:imageData forKey:key toMemory:YES toDisk:YES completion:completionBlock]; &#125; break; default: &#123; if (completionBlock) &#123; completionBlock(); &#125; &#125; break; &#125;&#125; å†…éƒ¨å®žçŽ°å…¶å®žæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯æ ¹æ®ç¼“å­˜ç±»åž‹åšç›¸åº”çš„å­˜å‚¨ã€‚è¿™ä¸€å¥æ‰æ˜¯é‡ç‚¹ï¼š1[self storeImage:image imageData:imageData forKey:key toMemory:YES toDisk:YES completion:completionBlock]; æˆ‘ä»¬æŽ¥ç€å¾€ä¸‹é¢çœ‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647- (void)storeImage:(nullable UIImage *)imageimageData:(nullable NSData *)imageDataforKey:(nullable NSString *)keytoMemory:(BOOL)toMemorytoDisk:(BOOL)toDiskcompletion:(nullable SDWebImageNoParamsBlock)completionBlock &#123; if (!image || !key) &#123; if (completionBlock) &#123; completionBlock(); &#125; return; &#125; // if memory cache is enabled if (toMemory &amp;&amp; self.config.shouldCacheImagesInMemory) &#123; NSUInteger cost = image.sd_memoryCost; [self.memCache setObject:image forKey:key cost:cost]; &#125; if (toDisk) &#123; dispatch_async(self.ioQueue, ^&#123; @autoreleasepool &#123; NSData *data = imageData; if (!data &amp;&amp; image) &#123; // If we do not have any data to detect image format, check whether it contains alpha channel to use PNG or JPEG format SDImageFormat format; if ([SDImageCoderHelper CGImageContainsAlpha:image.CGImage]) &#123; format = SDImageFormatPNG; &#125; else &#123; format = SDImageFormatJPEG; &#125; data = [[SDImageCodersManager sharedManager] encodedDataWithImage:image format:format options:nil]; &#125; [self _storeImageDataToDisk:data forKey:key]; &#125; if (completionBlock) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; completionBlock(); &#125;); &#125; &#125;); &#125; else &#123; if (completionBlock) &#123; completionBlock(); &#125; &#125;&#125; æŽ¥ç€æˆ‘ä»¬åˆ†å¿ƒä¸€ä¸‹å­˜å‚¨ç¼“å­˜çš„æœ€å…³é”®çš„æ–¹æ³•ï¼Œæ²¡é”™ï¼Œå°±æ˜¯ä¸Šé¢çš„è¿™æ®µä»£ç ã€‚é¦–å…ˆï¼Œå¯¹å‚æ•°è¿›è¡Œåˆæ³•æ€§åˆ¤æ–­ï¼Œå¦‚æžœä¸åˆæ³•ï¼Œç›´æŽ¥è¿”å›žã€‚å¦åˆ™ç»§ç»­å‘ä¸‹æ‰§è¡Œ:ç¬¬ä¸€æ­¥ï¼šåˆ¤æ–­æ˜¯å¦å…è®¸å†…å­˜ç¼“å­˜ï¼Œå¦‚æžœå…è®¸å°±æŠŠä¸‹è½½å¥½çš„å›¾ç‰‡å­˜å‚¨åœ¨å†…å­˜ä¸­ä¸€ä»½ã€‚ç¬¬äºŒæ­¥ï¼šåˆ¤æ–­æ˜¯å¦å…è®¸å­˜å‚¨åˆ°ç£ç›˜ï¼Œå¦‚æžœå…è®¸å°±è¿›å…¥ç£ç›˜å­˜å‚¨é€»è¾‘ï¼šè¿™é‡Œçš„å­˜å‚¨ä»»åŠ¡æ˜¯æäº¤åˆ°äº†ä¸€ä¸ªå¼‚æ­¥çš„ä¸²è¡Œé˜Ÿåˆ—ä¸­ã€‚ä»»åŠ¡çš„å…·ä½“å¤„ç†é€»è¾‘æ˜¯ï¼šå¦‚æžœimageData ä¸å­˜åœ¨ï¼Œä½†æ˜¯image æœ‰å€¼ï¼Œåˆ™å¯¹imageè¿›è¡Œå½’æ¡£ï¼Œå¾—åˆ°ä¸€ä»½data,è¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¦å†™å…¥åˆ°ç£ç›˜çš„dataã€‚æœ€åŽï¼Œè°ƒç”¨_storeImageDataToDisk:æ–¹æ³•ï¼Œå°†äºŒè¿›åˆ¶å›¾ç‰‡æ•°æ®å†™å…¥åˆ°ç£ç›˜ã€‚ç¬¬ä¸‰æ­¥ï¼šå°†ç»“æžœå›žè°ƒå‡ºåŽ»ã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸‹_storeImageDataToDisk:æ–¹æ³•çš„å†…éƒ¨å®žçŽ°ï¼š12345678// Make sure to call form io queue by caller- (void)_storeImageDataToDisk:(nullable NSData *)imageData forKey:(nullable NSString *)key &#123; if (!imageData || !key) &#123; return; &#125; [self.diskCache setData:imageData forKey:key];&#125; æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯é€šè¿‡diskCache å®žä¾‹æ¥å†™ç¼“å­˜ã€‚æŽ¥ç€æˆ‘ä»¬è¿›å…¥diskCacheç±»é‡Œé¢çœ‹ä¸‹æ˜¯å¦‚ä½•å†™å…¥çš„ã€‚æˆ‘ä»¬çœ‹ä¸‹SDDiskCacheé‡Œé¢çš„setData: forKey:æ–¹æ³•å®žçŽ°ï¼š1234567891011121314151617181920- (void)setData:(NSData *)data forKey:(NSString *)key &#123; NSParameterAssert(data); NSParameterAssert(key); if (![self.fileManager fileExistsAtPath:self.diskCachePath]) &#123; [self.fileManager createDirectoryAtPath:self.diskCachePath withIntermediateDirectories:YES attributes:nil error:NULL]; &#125; // get cache Path for image key NSString *cachePathForKey = [self cachePathForKey:key]; // transform to NSUrl NSURL *fileURL = [NSURL fileURLWithPath:cachePathForKey]; [data writeToURL:fileURL options:self.config.diskCacheWritingOptions error:nil]; // disable iCloud backup if (self.config.shouldDisableiCloud) &#123; // ignore iCloud backup resource value error [fileURL setResourceValue:@YES forKey:NSURLIsExcludedFromBackupKey error:nil]; &#125;&#125; å…¶å®žè¿™ä¸ªä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯ç®€å•çš„æ–‡ä»¶å†™å…¥ã€‚ åˆ°è¿™é‡Œï¼ŒSDWebImageç¼“å­˜çš„è¯»å†™æœºåˆ¶å°±ä»‹ç»å®Œäº†ï¼Œæ¬¢è¿Žå¤§å®¶å‹˜è¯¯ï¼ŒSDWebImageè¿™ä¸ªåº“æ¯”è¾ƒå¼ºå¤§ï¼Œé‡Œé¢è¿˜æœ‰å¾ˆå¤šç»†èŠ‚ï¼Œæ–‡ä¸­éƒ½æ²¡æœ‰æåˆ°ï¼Œè¿™é‡Œåªæ˜¯åšäº†ä¸»æµç¨‹çš„ä»‹ç»ï¼Œè¯»è€…è¦æ˜¯æƒ³æ·±å…¥çš„ç†è§£ï¼Œè¿˜å¾—æ˜¯åŽ»é˜…è¯»æºç ï¼Œå»ºè®®çš„é˜…è¯»çš„æ—¶å€™ï¼Œå’Œæœ¬æ–‡ä¸€èµ·è¯»ï¼Œæœ‰åŠ©äºŽç†è§£æºç ã€‚ä¸‹ä¸€ç¯‡æ–‡ç« ï¼Œä¼šä»‹ç»SDWebImageæ˜¯å¦‚ä½•å¯¹å›¾ç‰‡è¿›è¡Œç¼–ç è§£ç çš„ï¼Œæ¬¢è¿Žå¤§å®¶é˜…è¯»ã€‚]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>å›¾ç‰‡ç¼“å­˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SDWebImage (5.0.6) å›¾ç‰‡åŠ è½½å¥‡æ·«å·§æŠ€]]></title>
    <url>%2F2019%2F07%2F29%2FSDWebImage%20(5.0.6)%20%E5%9B%BE%E7%89%87%E5%8A%A0%E8%BD%BD%E5%A5%87%E6%B7%AB%E5%B7%A7%E6%8A%80%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨ç ”ç©¶å›¾ç‰‡ç¼“å­˜æ¡†æž¶ï¼Œæ‰€ä»¥SDWebImageä¸€å®šæ˜¯æˆ‘ç ”ç©¶çš„ä¸äºŒé€‰æ‹©ï¼Œä¸‹é¢å°±ç®€å•è®²è¿°ä¸€ä¸‹SDWebImageæ˜¯å¦‚ä½•åŠ è½½å›¾ç‰‡çš„ï¼Œä»¥åŠåŠ è½½è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„ä¸€äº›éªšæ“ä½œã€‚ è¿™é‡Œå…ˆå¼ºè°ƒä¸€ç‚¹SDWebImageåŠ è½½å›¾ç‰‡è¿‡ç¨‹ä¸­çš„ä¸¤ä¸ªéªšæ“ä½œï¼ša. å¦‚ä½•é¿å…åŒä¸€æ—¶é—´å¤šä¸ªè¯·æ±‚ï¼Œè¯·æ±‚åŒä¸€å¼ å›¾ç‰‡ä¸‹è½½å¤šæ¬¡é—®é¢˜ã€‚b. å¦‚ä½•è§£å†³TableViewCell å¤ç”¨æ—¶å¯¼è‡´çš„å›¾ç‰‡å±•ç¤ºé”™ä¹±é—®é¢˜ã€‚ä¸‹æ–‡ä¸­ä¼šå¯¹è¿™ä¸¤ä¸ªé—®é¢˜ç»™å‡ºç­”æ¡ˆï¼Œå¥½äº†ä¸æ‰¯æ·¡äº†ï¼Œè¿›å…¥æ­£é¢˜ã€‚ å½“æˆ‘ä»¬ä½¿ç”¨SDWebImageåŠ è½½å›¾ç‰‡æ—¶éœ€è¦è°ƒç”¨å¦‚ä¸‹æ–¹æ³•ï¼š123- (void)sd_setImageWithURL:(nullable NSURL *)url &#123; [self sd_setImageWithURL:url placeholderImage:nil options:0 progress:nil completed:nil];&#125; ä¹‹åŽè¿›è¡Œä¸€ç³»åˆ—çš„ä¼ é€’ä¼šä¼ é€’åˆ°æœ€æ·±å±‚çš„æ–¹æ³•ï¼š1234567891011121314- (void)sd_setImageWithURL:(nullable NSURL *)url placeholderImage:(nullable UIImage *)placeholder options:(SDWebImageOptions)options context:(nullable SDWebImageContext *)context progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nullable SDExternalCompletionBlock)completedBlock &#123; [self sd_internalSetImageWithURL:url placeholderImage:placeholder options:options context:context setImageBlock:nil progress:progressBlock completed:^(UIImage * _Nullable image, NSData * _Nullable data, NSError * _Nullable error, SDImageCacheType cacheType, BOOL finished, NSURL * _Nullable imageURL) &#123; if (completedBlock) &#123; completedBlock(image, error, cacheType, imageURL); &#125; &#125;];&#125; å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢è°ƒç”¨äº†UIView+Webcacheåˆ†ç±»é‡Œé¢çš„ä¸€ä¸ªæ–¹æ³•ï¼š12345678- (void)sd_internalSetImageWithURL:(nullable NSURL *)url placeholderImage:(nullable UIImage *)placeholder options:(SDWebImageOptions)options context:(nullable SDWebImageContext *)context setImageBlock:(nullable SDSetImageBlock)setImageBlock progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nullable SDInternalCompletionBlock)completedBlock &#123; ...... &#125; è¿™ä¸ªæ–¹æ³•å°±æ˜¯æˆ‘ä»¬åŠ è½½å›¾ç‰‡çš„æ­£å¼å…¥å£æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•é‡Œé¢éƒ½ä¸»è¦åšäº†ä»€ä¹ˆã€‚ç¬¬ä¸€æ­¥ï¼Œæ ¹æ®validOperationKey å–æ¶ˆæŽ‰æ­£åœ¨æ‰§è¡Œçš„æ“ä½œoperationå¦‚ä¸‹è°ƒç”¨ï¼š123456NSString *validOperationKey = context[SDWebImageContextSetImageOperationKey];if (!validOperationKey) &#123; validOperationKey = NSStringFromClass([self class]);&#125;self.sd_latestOperationKey = validOperationKey;[self sd_cancelImageLoadOperationWithKey:validOperationKey]; sd_cancelImageLoadOperationWithKey: æ–¹æ³•çš„å†…éƒ¨å®žçŽ°ä¼šæŸ¥è¯¢åˆ°å·²ç»å­˜åœ¨çš„åŒåä»»åŠ¡ï¼Œå¹¶ä¸”ä¼šå–æ¶ˆæŽ‰è¿™ä¸ªä»»åŠ¡ï¼Œå¹¶åœ¨å½“å‰viewçš„operationDictionary å®¹å™¨ä¸­ç§»é™¤æŽ‰ã€‚æºç å¦‚ä¸‹ï¼š12345678910111213141516171819- (void)sd_cancelImageLoadOperationWithKey:(nullable NSString *)key &#123;if (key) &#123; // Cancel in progress downloader from queue SDOperationsDictionary *operationDictionary = [self sd_operationDictionary]; id&lt;SDWebImageOperation&gt; operation; @synchronized (self) &#123; operation = [operationDictionary objectForKey:key]; &#125; if (operation) &#123; if ([operation conformsToProtocol:@protocol(SDWebImageOperation)]) &#123; [operation cancel]; &#125; @synchronized (self) &#123; [operationDictionary removeObjectForKey:key]; &#125; &#125; &#125;&#125; è¿™é‡Œéœ€è¦è¯´æ˜Žä¸€ä¸‹ï¼š[self sd_operationDictionary]è¿™ä¸ªè°ƒç”¨ï¼Œè¿™ä¸ªæ–¹æ³•çš„å®žçŽ°æ˜¯ç»™å½“å‰Viewé€šè¿‡å…³è”å¯¹è±¡çš„æŠ€æœ¯å…³è”äº†ä¸€ä¸ªNSMapTableå¯¹è±¡ï¼Œç”¨æ¥å­˜å‚¨è¯·æ±‚é“¾æŽ¥æŽ¥å¯¹åº”çš„è¯·æ±‚æ“ä½œç±»åž‹å¦‚NSMapTable&lt;NSString *, id&gt;ã€‚æºç å¦‚ä¸‹ï¼š1234567891011- (SDOperationsDictionary *)sd_operationDictionary &#123; @synchronized(self) &#123; SDOperationsDictionary *operations = objc_getAssociatedObject(self, &amp;loadOperationKey); if (operations) &#123; return operations; &#125; operations = [[NSMapTable alloc] initWithKeyOptions:NSPointerFunctionsStrongMemory valueOptions:NSPointerFunctionsWeakMemory capacity:0]; objc_setAssociatedObject(self, &amp;loadOperationKey, operations, OBJC_ASSOCIATION_RETAIN_NONATOMIC); return operations; &#125;&#125; ç»•äº†è¿™ä¹ˆå¤§ä¸€åœˆï¼Œä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆä¸€ä¸Šæ¥è¦è°ƒç”¨sd_cancelImageLoadOperationWithKey:è¿™ä¸ªæ–¹æ³•ï¼Ÿé€šè¿‡ä¸Šé¢çš„æºç åˆ†æžSDWebImageè¿™æ ·è®¾è®¡æ˜¯ä¸ºäº†è§£å†³TableViewCellå¤ç”¨æ—¶ï¼Œå¦‚æžœè¢«å¤ç”¨çš„Cellçš„ImageViewè¯·æ±‚çš„å›¾ç‰‡æ²¡æœ‰å›žè°ƒæ—¶å±•ç¤ºå›¾ç‰‡é”™ä¹±çš„é—®é¢˜ã€‚åŽŸç†å°±æ˜¯å¦‚æžœè¢«å¤ç”¨çš„Cellçš„ImageViewä¹‹å‰è¯·æ±‚çš„å›¾ç‰‡è¿˜æ²¡æœ‰å›žè°ƒï¼Œè€Œæ­¤æ—¶éœ€è¦è¯·æ±‚æ–°çš„å›¾ç‰‡ï¼Œé‚£ä¹ˆå°±å–æ¶ˆæŽ‰ä¹‹å‰çš„è¯·æ±‚operation,å¹¶ä»ŽoperationDictionaryä¸­ç§»é™¤æŽ‰ã€‚ç„¶åŽåŽ»åŠ è½½éœ€è¦åŠ è½½çš„æ–°å›¾ç‰‡ã€‚å¦‚æžœè¯´ï¼Œä¹‹å‰çš„å›¾ç‰‡è¯·æ±‚åœ¨è¿™ä¹‹åŽå›žè°ƒå›žæ¥çš„è¯ï¼Œä¼šåˆ¤æ–­ä¹‹å‰è¯·æ±‚çš„operationæ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠoperationçš„isCancelå±žæ€§ï¼Œå¦‚æžœä¸å­˜åœ¨æˆ–è€…isCancel=Yesçš„è¯ï¼Œå°±ä¸ä¼šå›žè°ƒåˆ°UIç•Œé¢ã€‚ä¹Ÿå°±æ˜¯å¦‚ä¸‹ä»£ç é€»è¾‘ï¼š12345678@weakify(operation);operation.loaderOperation = [self.imageLoader requestImageWithURL:url options:options context:context progress:progressBlock completed:^(UIImage *downloadedImage, NSData *downloadedData, NSError *error, BOOL finished) &#123; @strongify(operation); if (!operation || operation.isCancelled) &#123; // Do nothing if the operation was cancelled // See #699 for more details // if we would call the completedBlock, there could be a race condition between this block and another completedBlock for the same object, so if this one is called second, we will overwrite the new data &#125; è¯´äº†è¿™ä¹ˆå¤šï¼Œç›¸ä¿¡åº”è¯¥æ¸…æ¥šä¸ºä»€ä¹ˆè¦è°ƒç”¨sd_cancelImageLoadOperationWithKey:æ–¹æ³•äº†ï¼Œæˆ‘ä»¬æŽ¥ç€å›žåˆ°sd_internalSetImageWithURL:æ–¹æ³•ä¸­ï¼Œcancelä¹‹åŽå°±ä¼šæ¸…æŽ‰å½“å‰imageViewä¸Šæ¬¡ä¸‹è½½çš„å›¾ç‰‡ï¼š12345if (!(options &amp; SDWebImageDelayPlaceholder)) &#123; dispatch_main_async_safe(^&#123; [self sd_setImage:placeholder imageData:nil basedOnClassOrViaCustomSetImageBlock:setImageBlock cacheType:SDImageCacheTypeNone imageURL:url]; &#125;);&#125; è¿™é‡Œå¯ä»¥è§£é‡Šï¼Œå¤ç”¨çš„æ—¶å€™ï¼Œå·²ç»å±•ç¤ºè¿‡å›¾ç‰‡çš„imageViewä¸ºä»€ä¹ˆåœ¨è¢«å¤ç”¨çš„æ—¶å€™æ²¡æœ‰å±•ç¤ºä¹‹å‰å­˜åœ¨çš„å›¾ç‰‡è€Œæ˜¯å±•ç¤ºplaceholeræˆ–è€…ä¸å±•ç¤ºçš„åŽŸå› ã€‚æŽ¥ä¸‹æ¥ï¼Œå°±æ˜¯åˆ¤æ–­æˆ‘ä»¬ä¼ å…¥çš„urlæ˜¯å¦åˆæ³•ï¼Œä»¥åŠè®¾ç½®UIImageViewçš„åŠ è½½æŒ‡ç¤ºå™¨ï¼Œè¿˜æœ‰åŠ è½½è¿›åº¦blockï¼Œæ­¤å¤„ä¸åšè¯¦ç»†è¯´æ˜Žäº†ã€‚æˆ‘ä»¬ç€é‡çœ‹åŠ è½½å›¾ç‰‡çš„æ–¹æ³•ï¼š123id &lt;SDWebImageOperation&gt; operation = [manager loadImageWithURL:url options:options context:context progress:combinedProgressBlock completed:^(UIImage *image, NSData *data, NSError *error, SDImageCacheType cacheType, BOOL finished, NSURL *imageURL) &#123; ......&#125; è¿™é‡Œå½“å‰viewåˆ©ç”¨å‰é¢ç”Ÿæˆçš„manager åŽ»åŠ è½½æˆ‘ä»¬éœ€è¦çš„å›¾ç‰‡ï¼Œå¹¶æŠŠèŽ·å–çš„ç»“æžœå›žè°ƒç»™äº†ä¸Šä¸€çº§è°ƒç”¨æ–¹ã€‚ä»Žä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹åˆ°ï¼ŒèŽ·å–å›¾ç‰‡çš„åŒæ—¶è¿”å›žäº†ä¸€ä¸ªoperationï¼Œè¿™ä¸ªoperationå°±æ˜¯æ ‡è¯†èŽ·å–å½“å‰urlå›¾ç‰‡çš„ä¸€ä¸ªæ“ä½œã€‚ä¹‹åŽä¼šæŠŠè¿™ä¸ªoperationæ”¾åœ¨å½“å‰viewçš„operationDictionaryä¸­ï¼š1[self sd_setImageLoadOperation:operation forKey:validOperationKey]; sd_setImageLoadOperationï¼šå†…éƒ¨å®žçŽ°å¦‚ä¸‹:1234567891011- (void)sd_setImageLoadOperation:(nullable id&lt;SDWebImageOperation&gt;)operation forKey:(nullable NSString *)key &#123; if (key) &#123; [self sd_cancelImageLoadOperationWithKey:key]; if (operation) &#123; SDOperationsDictionary *operationDictionary = [self sd_operationDictionary]; @synchronized (self) &#123; [operationDictionary setObject:operation forKey:key]; &#125; &#125; &#125;&#125; è¿™ä¹Ÿæ˜¯ç¨‹åºä¸€å¼€å§‹æ—¶ï¼Œèƒ½å¤Ÿå–æ¶ˆæŽ‰åŒåoperationçš„åŽŸå› ã€‚å°±æ˜¯åŒä¸€ä¸ªviewå‘é€ä¸€ä¸ªå›¾ç‰‡è¯·æ±‚å°±ä¼šè®°å½•åœ¨operationDictionaryä¸­æ¥æ ‡è¯†æœ‰è¯·æ±‚æ­£åœ¨æ‰§è¡Œã€‚æˆ‘ä»¬æŽ¥ç€çœ‹loadImageWithURL:æ–¹æ³•å†…éƒ¨å®žçŽ°ï¼šé¦–å…ˆï¼Œåˆ¤æ–­urlæ˜¯å¦åˆæ³•ï¼Œç„¶åŽç”Ÿæˆä¸€ä¸ªè¯·æ±‚å›¾ç‰‡çš„operationï¼Œè¿™ä¸ªå’Œæˆ‘ä»¬åˆšæ‰è®²åˆ°çš„operationåœ¨å†…å­˜ä¸­æ˜¯åŒä¸€ä¸ªï¼Œå› ä¸ºæ˜¯ä»Žè¯¥æ–¹æ³•ä¸­è¿”å›žå‡ºåŽ»çš„ã€‚å…¶æ¬¡ï¼Œå°†è¿™ä¸ªoperationæ·»åŠ åˆ°æ­£åœ¨è¿è¡Œçš„æ“ä½œå®¹å™¨ä¸­ï¼š123SD_LOCK(self.runningOperationsLock);[self.runningOperations addObject:operation];SD_UNLOCK(self.runningOperationsLock); ä¹‹åŽè¿›å…¥é‡ç‚¹ï¼Œé‚£å°±æ˜¯å¼€å§‹ä»Žç¼“å­˜ä¸­è¯»å–å›¾ç‰‡ï¼š12// Start the entry to load image from cache[self callCacheProcessForOperation:operation url:url options:options context:context progress:progressBlock completed:completedBlock]; åŒæ ·çš„ï¼Œå°†æˆ‘ä»¬åˆšæ‰è®²åˆ°çš„operationä¼ å…¥åˆ°è¿™ä¸ªæ–¹æ³•ä¸­ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ä¸­åšäº†ä»€ä¹ˆï¼š123456789101112131415161718192021222324252627// Query cache process- (void)callCacheProcessForOperation:(nonnull SDWebImageCombinedOperation *)operation url:(nonnull NSURL *)url options:(SDWebImageOptions)options context:(nullable SDWebImageContext *)context progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nullable SDInternalCompletionBlock)completedBlock &#123; // Check whether we should query cache BOOL shouldQueryCache = (options &amp; SDWebImageFromLoaderOnly) == 0; if (shouldQueryCache) &#123; id&lt;SDWebImageCacheKeyFilter&gt; cacheKeyFilter = context[SDWebImageContextCacheKeyFilter]; NSString *key = [self cacheKeyForURL:url cacheKeyFilter:cacheKeyFilter]; @weakify(operation); operation.cacheOperation = [self.imageCache queryImageForKey:key options:options context:context completion:^(UIImage * _Nullable cachedImage, NSData * _Nullable cachedData, SDImageCacheType cacheType) &#123; @strongify(operation); if (!operation || operation.isCancelled) &#123; [self safelyRemoveOperationFromRunning:operation]; return; &#125; // Continue download process [self callDownloadProcessForOperation:operation url:url options:options context:context cachedImage:cachedImage cachedData:cachedData cacheType:cacheType progress:progressBlock completed:completedBlock]; &#125;]; &#125; else &#123; // Continue download process [self callDownloadProcessForOperation:operation url:url options:options context:context cachedImage:nil cachedData:nil cacheType:SDImageCacheTypeNone progress:progressBlock completed:completedBlock]; &#125;&#125; ä»Žä¸Šé¢çš„æºç å¯ä»¥çœ‹å‡ºï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦ä»Žç¼“å­˜ä¸­è¯»å–å›¾ç‰‡ï¼Œå¦‚æžœéœ€è¦ï¼Œå°±å¤„ç†url,å¤„ç†åŽå¾—åˆ°æˆ‘ä»¬è¯»å–ç¼“å­˜çš„keyã€‚ç„¶åŽï¼Œå¼€å§‹ä»Žç¼“å­˜ä¸­è¯»å–å›¾ç‰‡ï¼Œå›žè°ƒä¹‹åŽåˆ¤æ–­å½“å‰operationæ˜¯å¦è¿˜å­˜åœ¨ï¼Œä»¥åŠoperationæ˜¯å¦è¢«å–æ¶ˆï¼Œå¦‚æžœå–æ¶ˆçš„è¯å°±ä»ŽrunningOperationsä¸­ç§»é™¤å½“å‰operationå¹¶è¿”å›žï¼Œä»€ä¹ˆä¹Ÿä¸åšã€‚å¦åˆ™ï¼Œè°ƒç”¨ä¸‹è½½å¤„ç†ç¨‹åºï¼šcallDownloadProcessForOperationï¼šå¹¶æŠŠæˆ‘ä»¬è¯»å–å‡ºæ¥çš„ç¼“å­˜æ•°æ®ä¼ å…¥è¯¥æ–¹æ³•ã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨å®žçŽ°ï¼šé¦–å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦ä¸‹è½½å›¾ç‰‡ï¼Œå¦‚æžœä¸éœ€è¦å°±åˆ¤æ–­ç¼“å­˜æ•°æ®å¦‚æžœç¼“å­˜æœ‰å€¼å°±ç›´æŽ¥è¿”å›žç»™è°ƒç”¨æ–¹ï¼Œå¦‚æžœéœ€è¦å°±å…ˆçœ‹ä¸€ä¸‹ä¹‹å‰è¯»å–çš„ç¼“å­˜æ•°æ®æ˜¯å¦æœ‰å€¼ï¼Œå¦‚æžœæœ‰å€¼ï¼Œå°±ç›´æŽ¥è¿”å›žç»™è°ƒç”¨æ–¹ã€‚å¦‚æžœæ²¡æœ‰çš„è¯ï¼Œå°±ä½¿ç”¨imageLoaderä¸‹è½½å›¾ç‰‡ï¼š1234567891011121314151617181920212223242526272829303132333435363738// `SDWebImageCombinedOperation` -&gt; `SDWebImageDownloadToken` -&gt; `downloadOperationCancelToken`, which is a `SDCallbacksDictionary` and retain the completed block below, so we need weak-strong again to avoid retain cycle@weakify(operation);operation.loaderOperation = [self.imageLoader requestImageWithURL:url options:options context:context progress:progressBlock completed:^(UIImage *downloadedImage, NSData *downloadedData, NSError *error, BOOL finished) &#123; @strongify(operation); if (!operation || operation.isCancelled) &#123; // Do nothing if the operation was cancelled // See #699 for more details // if we would call the completedBlock, there could be a race condition between this block and another completedBlock for the same object, so if this one is called second, we will overwrite the new data &#125; else if (cachedImage &amp;&amp; options &amp; SDWebImageRefreshCached &amp;&amp; [error.domain isEqualToString:SDWebImageErrorDomain] &amp;&amp; error.code == SDWebImageErrorCacheNotModified) &#123; // Image refresh hit the NSURLCache cache, do not call the completion block &#125; else if (error) &#123; [self callCompletionBlockForOperation:operation completion:completedBlock error:error url:url]; BOOL shouldBlockFailedURL = [self shouldBlockFailedURLWithURL:url error:error]; if (shouldBlockFailedURL) &#123; SD_LOCK(self.failedURLsLock); [self.failedURLs addObject:url]; SD_UNLOCK(self.failedURLsLock); &#125; &#125; else &#123; if ((options &amp; SDWebImageRetryFailed)) &#123; SD_LOCK(self.failedURLsLock); [self.failedURLs removeObject:url]; SD_UNLOCK(self.failedURLsLock); &#125; [self callStoreCacheProcessForOperation:operation url:url options:options context:context downloadedImage:downloadedImage downloadedData:downloadedData finished:finished progress:progressBlock completed:completedBlock]; &#125; if (finished) &#123; [self safelyRemoveOperationFromRunning:operation]; &#125;&#125;]; ä»Žä¸Šé¢çš„æºç ä¸­å¯ä»¥çœ‹å‡ºè¯·æ±‚å›¾ç‰‡çš„å›žè°ƒå›žæ¥åŽï¼š1.å¦‚æžœoperationä¸å­˜åœ¨æˆ–è€…è¢«å–æ¶ˆï¼Œä»€ä¹ˆä¹Ÿä¸å¤„ç†2.å¦‚æžœæœ‰erroråˆ™ç›´æŽ¥å›žè°ƒé”™è¯¯ä¿¡æ¯ï¼Œå¹¶æŠŠå½“å‰urlåŠ å…¥åˆ°filedURLsä¸­ã€‚3.å¦‚æžœä¸€åˆ‡æ­£å¸¸ï¼Œåˆ™æŠŠé”™è¯¯è¯·æ±‚ä»ŽfiledURLsä¸­ç§»é™¤ï¼Œå¹¶æŠŠä¸‹è½½å¥½çš„å›¾ç‰‡æ•°æ®ä¼ é€’åˆ°ç¼“å­˜å¤„ç†ç¨‹åºã€‚4.æœ€åŽï¼Œå¦‚æžœfinished==YESï¼Œåˆ™æŠŠå½“å‰operationä»ŽrunningOperationsä¸­ç§»é™¤ã€‚ æŽ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨å®žçŽ°ï¼šé¦–å…ˆå¤„ç†ä¸€äº›ä¸‹è½½å™¨é€‰é¡¹ï¼Œç„¶åŽè°ƒç”¨ä¸‹è½½å›¾ç‰‡æ–¹æ³•ï¼š1return [self downloadImageWithURL:url options:downloaderOptions context:context progress:progressBlock completed:completedBlock]; æŽ¥ç€çœ‹ä¸Šé¢è¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨å®žçŽ°ï¼šé¦–å…ˆåˆ¤æ–­urlæ˜¯å¦åˆæ³•ï¼Œå¦‚æžœåˆæ³•ï¼Œä»Žä¸‹è½½å™¨çš„URLOperationså±žæ€§ä¸­è¯»å–è¯¥urlå¯¹åº”çš„operationï¼Œå¦‚æžœoperationä¸å­˜åœ¨ï¼Œæˆ–è€…å·²ç»å–æ¶ˆæˆ–è€…å·²ç»å®Œæˆï¼Œåˆ™æ ¹æ®urlé‡æ–°ç”Ÿæˆä¸€ä¸ªoperation,åŒæ—¶è®°å½•è¯¥operationåˆ°URLOperationsä¸­ï¼Œå¹¶æŠŠè¯¥operationæ·»åŠ åˆ°ä¸‹è½½é˜Ÿåˆ—ä¸­åŽ»ï¼š1234self.URLOperations[url] = operation;// Add operation to operation queue only after all configuration done according to Apple&apos;s doc.// `addOperation:` does not synchronously execute the `operation.completionBlock` so this will not cause deadlock.[self.downloadQueue addOperation:operation]; å¦‚æžœå­˜åœ¨operationï¼Œä½†æ˜¯operationæ²¡æœ‰æ­£åœ¨æ‰§è¡Œï¼Œåˆ™æ ¹æ®æ¡ä»¶è°ƒæ•´operationçš„è¯·æ±‚ä¼˜å…ˆçº§ã€‚å¦‚æžœæœ‰æ­£åœ¨æ‰§è¡Œçš„operationï¼Œä¸åˆ›å»ºæ–°çš„è¯·æ±‚operationï¼Œè€Œæ˜¯ç»™å½“å‰operationæ·»åŠ å›žè°ƒå¯¹è±¡progressBlock å’Œ completedBlockã€‚ 1id downloadOperationCancelToken = [operation addHandlersForProgress:progressBlock completed:completedBlock]; çœ‹ä¸‹è¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨å®žçŽ°ï¼š12345678910- (nullable id)addHandlersForProgress:(nullable SDWebImageDownloaderProgressBlock)progressBlockcompleted:(nullable SDWebImageDownloaderCompletedBlock)completedBlock &#123; SDCallbacksDictionary *callbacks = [NSMutableDictionary new]; if (progressBlock) callbacks[kProgressCallbackKey] = [progressBlock copy]; if (completedBlock) callbacks[kCompletedCallbackKey] = [completedBlock copy]; SD_LOCK(self.callbacksLock); [self.callbackBlocks addObject:callbacks]; SD_UNLOCK(self.callbacksLock); return callbacks;&#125; ä»Žä¸­å¯ä»¥çœ‹å‡ºä¸€ä¸ªImageDownloaderOperationå¯ä»¥æœ‰å¤šä¸ªå›žè°ƒblockã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒSDWebImageä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆè®¾è®¡å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¸ºäº†è§£å†³åœ¨åŒä¸€æ—¶é—´ï¼Œå¤šä¸ªè¯·æ±‚åŒæ—¶ä¸‹è½½ä¸€å¼ å›¾ç‰‡çš„æ—¶å€™ï¼Œå¯¹è¯¥å›¾ç‰‡è¯·æ±‚åªä¸‹è½½ä¸€æ¬¡ã€‚ä¹Ÿå°±æ˜¯è¯·æ±‚åªå‘é€ä¸€æ¬¡ï¼Œè€Œè¯·æ±‚æœ‰ç»“æžœçš„æ—¶å€™æ ¹æ®å­˜å‚¨çš„å¤šä¸ªè¿”å›žblock ä¾æ¬¡è¿”å›žç»™è°ƒç”¨æ–¹ã€‚è¿™æ–¹æ³•æ˜¯ä¸æ˜¯å¾ˆæœºæ™ºã€‚è¿™ä¸€ç‚¹ä¹Ÿå¯ä»Žè¯·æ±‚ç»“æžœçš„ä»£ç ä¸­å¾—åˆ°éªŒè¯ï¼š1234567891011- (void)callCompletionBlocksWithImage:(nullable UIImage *)imageimageData:(nullable NSData *)imageData error:(nullable NSError *)error finished:(BOOL)finished &#123; NSArray&lt;id&gt; *completionBlocks = [self callbacksForKey:kCompletedCallbackKey]; dispatch_main_async_safe(^&#123; for (SDWebImageDownloaderCompletedBlock completedBlock in completionBlocks) &#123; completedBlock(image, imageData, error, finished); &#125; &#125;);&#125; ä»Žä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ–¹æ³•å†…éƒ¨æ˜¯éåŽ†äº†æ‰€æœ‰éœ€è¦å®Œæˆå›žè°ƒçš„completedBlock,ç„¶åŽå›žè°ƒå‡ºåŽ»ã€‚ åˆ°è¿™é‡Œï¼ŒSDWebImageåŠ è½½å›¾ç‰‡çš„ä¸»è¦æµç¨‹å°±å·²ç»åŸºæœ¬è®²å®Œï¼Œæœ¬æ–‡ä¸­ç€é‡è®²è¿°äº†ä¸‹è½½æµç¨‹ï¼Œå¹¶æ²¡æœ‰å¯¹ç¼“å­˜éƒ¨åˆ†åšè¯¦ç»†è¯´æ˜Žï¼ŒåŽé¢ä¼šæŠ½æ—¶é—´å®Œå–„ã€‚æ¬¢è¿Žå‹˜è¯¯ã€‚PS:å»ºè®®åœ¨é˜…è¯»æœ¬æ–‡æ—¶å’Œæºç ä¸€èµ·é˜…è¯»ã€‚]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>å›¾ç‰‡ç¼“å­˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å°è¯•å·¥åŽ‚æ¨¡å¼]]></title>
    <url>%2F2019%2F05%2F03%2F%E5%B0%8F%E8%AF%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¾ˆå¤šäººé’Ÿæƒ…äºŽif/elseè¿žçŽ¯å†™æ³•ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œä¸€ä¸ªé¡µé¢æœ‰Nä¸ªèœå•ï¼Œç‚¹å‡»çš„æ—¶å€™é€šè¿‡æžšä¸¾ç±»åž‹æ¥è¿›è¡Œä¸šåŠ¡é€»è¾‘è·³è½¬ã€‚é‚£ä¹ˆé€šå¸¸ä¼šè¿™ä¹ˆå†™ï¼š 12345678- (void)handleJumpType:(ClJumpType)jumpType&#123; if(jumpType == CLJumpTypeAccount)&#123; [self gotoAccountPage]; &#125;else if(jumpType == CLJumpTypeAbout)&#123; [self gotoAboutPage]; &#125; ...&#125; å‡å¦‚è¯´æœ‰åå‡ ä¸ªæžšä¸¾ï¼Œé‚£handleJumpType:æ–¹æ³•å°±ä¼šçœ‹èµ·æ¥ä¸æ˜¯å¾ˆä¼˜é›…ï¼Œå¦‚æžœæ¡ä»¶æœ‰å˜åŒ–çš„è¯ï¼Œä¸å¥½æ‰©å±•ï¼Œè€Œä¸”ä¸šåŠ¡ä»£ç ç‰µä¸€å‘åŠ¨å…¨èº«â€¦â€¦ é‚£ä¹ˆéªšä¸€ç‚¹çš„ç¨‹åºå‘˜ä¼šæ€Žä¹ˆå†™å‘¢ï¼Ÿswitch/case? å½“ç„¶ä¸æ˜¯ï¼Œæˆ‘è¿™é‡ŒæŽ¨èä½¿ç”¨å·¥åŽ‚æ¨¡å¼æ¥ä¼˜é›…çš„å¤„ç†ç±»ä¼¼çš„é€»è¾‘ã€‚ æŽ¥ä¸‹æ¥æˆ‘ä»¬å°±é€šè¿‡ä¸€ç³»åˆ—çš„ä»£ç æ¥æ¼”ç¤ºå¦‚ä½•é€šè¿‡å·¥åŽ‚æ¨¡å¼æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚ åºŸè¯ä¸è¯´äº†ä¸Šä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263// ç±»åž‹æžšä¸¾typedef NS_ENUM(NSUInteger, CLJumpType) &#123; CLJumpTypeAccount = 1, CLJumpTypeAbout = 2, ...&#125;// ç‚¹å‡»äº‹ä»¶åŸºç±»@interface CLJumpEvent : NSObject- (instancetype)initWithType:(CLJumpType)jumpType;- (void)jumpEvent;@end@interface CLJumpTypeEvent()@property (nonatmoic, assign) CLJumpType jumpType;@end@implementation CLJumpTypeEvent- (instancetype)initWithType:(CLJumpType)jumpType &#123; if ([self = super init])&#123; self.jumpType = jumpType; &#125; return self;&#125;- (void)jumpEvent &#123; NSLog(@"ç‚¹å‡»äº‹ä»¶å¤„ç†");&#125;@end// è·³è½¬åˆ°æˆ‘çš„è´¦æˆ·@interface CLJumpTypeAccount : CLJumpTypeEvent@end@implementation CLJumpTypeEvent// é‡å†™åŸºç±»çš„jumpEventæ–¹æ³•- (void)jumpEvent &#123; NSLog(@"è·³è½¬åˆ°æˆ‘çš„è´¦æˆ·é¡µé¢...");&#125;@end// è·³è½¬å·¥åŽ‚ç±»@interface CLJumpFactory : NSObject + (CLJumpEvent)getJumpEvent:(CLJumpType)jumpType;@end@implementation CLJumpFactory+ (NSDictionary)jumpEvents &#123; return @&#123; @(CLJumpTypeAccount):[[CLJumpTypeEvent alloc]initWithType:CLJumpTypeAccount], @(CLJumpTypeAbout):[[CLJumpTypeEvent alloc]initWithType:CLJumpTypeAbout], ... &#125;&#125;+ (CLJumpEvent)getJumpEvent:(CLJumpType)jumpType&#123; return [[self jumpEvents] objectForKey:@(jumpType)];&#125;@end åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„å·¥åŽ‚å®šä¹‰å®Œäº†ï¼Œé‚£ä¹ˆæŽ¥ä¸‹æ¥æ”¹é€ ä¸€ä¸‹ä¸Šé¢çš„handleJumpTypeï¼šæ–¹æ³•: 1234- (void)handleJumpType:(ClJumpType)jumpType&#123; CLJumpTypeEvent *jumpEvent = [CLJumpFactory getJumpEvent:jumpType]; [jumpEvent jumpEvent];&#125; OKï¼Œæ”¹é€ å®Œçš„æ ·å­ï¼Œæ˜¯ä¸æ˜¯å¾ˆä¼˜é›…ï¼Ÿè€Œä¸”å¦‚æžœéœ€è¦æ‰©å±•çš„è¯ï¼ŒhandleJumpType:æ–¹æ³•å®Œå…¨ä¸ç”¨ä¿®æ”¹ã€‚ é€šè¿‡è¿™ä¸ªä¾‹å­æ˜¯ä¸æ˜¯è§‰å¾—åˆ©ç”¨å·¥åŽ‚æ¨¡å¼æ¥å¤„ç†ç±»ä¼¼çš„é—®é¢˜ååˆ†çš„åˆé€‚å‘¢ï¼Œå…¶å®žè®¾è®¡æ¨¡å¼åœ¨å®žé™…çš„å¼€å‘ä¸­è¿˜æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œåªè¦æˆ‘ä»¬ä»”ç»†çš„åŽ»æ£æ‘©ä»£ç ï¼Œä½ ä¼šå‘çŽ°å®ƒæ€»æœ‰ä¸€äº›æ¨¡å¼åœ¨é‡Œé¢ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>Objective-C</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Charleså·¥å…·è¿›é˜¶ç¯‡]]></title>
    <url>%2F2019%2F04%2F25%2FCharles%E5%B7%A5%E5%85%B7%E8%BF%9B%E9%98%B6%E7%AF%87%2F</url>
    <content type="text"><![CDATA[æˆ‘ä»¬éƒ½çŸ¥é“Charlesæ˜¯ä¸€æ¬¾å¥½ç”¨çš„æŠ“åŒ…å·¥å…·ï¼Œå…¶å®žå®ƒçš„åŠŸèƒ½æ˜¯éžå¸¸å¼ºå¤§çš„ï¼Œä¸‹é¢æˆ‘ä»¬å°±ä¸€èµ·çœ‹ä¸€ä¸‹Charlesè¿™ä¸ªå·¥å…·çš„ä¸€äº›å…¶ä»–å¸¸ç”¨åŠŸèƒ½ã€‚ ä½¿ç”¨Charlesè¿›è¡Œç½‘ç»œçŽ¯å¢ƒæ¨¡æ‹Ÿåœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬è¦ç»å¸¸è€ƒè™‘å„ç§è¾¹ç•Œé—®é¢˜ï¼Œå¯¹äºŽç½‘ç»œå¼€å‘ï¼Œå‘Šè¯‰ç½‘ç»œã€å¼±ç½‘ç»œã€ä¸Šè¡Œå’Œä¸‹è¡Œå¸¦å®½å·®å¼‚ç­‰éƒ½æ˜¯æˆ‘ä»¬è¦è¿›è¡Œé€‚é…çš„åœºæ™¯ï¼ŒCharleså°±å¯ä»¥å¾ˆå¥½çš„æ¨¡æ‹Ÿè¿™äº›çŽ¯å¢ƒã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¸€ä¸‹çœ‹ä¸€ä¸‹å¦‚ä½•æ¨¡æ‹Ÿï¼š åœ¨Charlesèœå•æ çš„Proxyèœå•ä¸­é€‰æ‹© Throttle(èŠ‚æµé˜€) Settings èœå•é¡¹ï¼Œè¿™ä¸ªå¯ä»¥ç”¨æ¥è¿›è¡Œç½‘ç»œå­—èŠ‚æµçš„è®¾ç½®ï¼Œå°±æ˜¯æˆ‘ä»¬è¯´çš„ç½‘ç»œçŽ¯å¢ƒæ¨¡æ‹Ÿï¼Œå¦‚å›¾(1): å›¾(1) åœ¨å¼¹å‡ºçš„æ–°çª—å£ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œç½‘ç»œè®¾ç½®äº†ï¼Œå¦‚å›¾(2)ï¼š å›¾(2) å‹¾é€‰Enable Throttlingé€‰é¡¹åˆ™è¡¨ç¤ºå¼€å¯ç½‘ç»œèŠ‚æµåŠŸèƒ½ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨å›¾(2)çš„çª—å£ä¸­è¿˜æœ‰ä¸€ä¸ªOnly for selected hosts é€‰é¡¹ï¼Œå¼€å¯è¿™ä¸ªé€‰é¡¹åŽï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®ä¸€äº›ä¸»æœºåœ°å€ï¼Œä»Žè€Œåªä¼šé’ˆå¯¹è¿™äº›ä¸»æœºåœ°å€çš„è¯·æ±‚è¿›è¡ŒèŠ‚æµæŽ§åˆ¶ã€‚ åœ¨Throttle preset ä¸­é¢„è®¾äº†å¤šç§ç½‘ç»œçŽ¯å¢ƒï¼Œå¯¹æ¯ä¸€ç§é¢„è®¾éƒ½é…ç½®äº†ä¸€å¥—ç½‘ç»œçŽ¯å¢ƒå‚æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚ ä¸‹é¢æ¥è§£é‡Šä¸€ä¸‹çª—å£ä¸­çš„å„ä¸ªå‚æ•°ï¼šBandwidth ç”¨æ¥é…ç½®ä¸Šè¡Œå’Œä¸‹è¡Œç½‘ç»œçš„å¸¦å®½ Utilisation ç”¨æ¥è®¾ç½®ä¸Šè¡Œå’Œä¸‹è¡Œç½‘ç»œçš„åˆ©ç”¨çŽ‡ã€‚ Round-trip latency ç”¨æ¥è®¾ç½®å¾€è¿”çš„å»¶è¿Ÿæ—¶é—´ã€‚ MTUè®¾ç½®ç½‘ç»œæœ€å¤§ä¼ è¾“å•å…ƒ Reliablity è®¾ç½®ç½‘ç»œå¯é çŽ‡ã€‚ Stability è®¾ç½®ç½‘ç»œç¨³å®šæ€§ã€‚ Unstable quality range è®¾ç½®ä¸ç¨³å®šèŒƒå›´ã€‚ å½“æˆ‘ä»¬æ ¹æ®è‡ªå·±çš„éœ€æ±‚è‡ªå®šä¹‰äº†ä¸€å¥—ç½‘ç»œçŽ¯å¢ƒå‚æ•°åŽï¼Œä¹Ÿå¯ä»¥è¿›è¡Œä¿å­˜ï¼Œå¡«å†™å®ŒæˆåŽç‚¹å‡»Add PresetæŒ‰é’®å³å¯æ–°å¢žä¸€ç§è‡ªå®šä¹‰é¢„è®¾ï¼ŒRemove Presetç”¨æ¥åˆ é™¤é¢„è®¾ã€‚å®žé™…ä¸Šè¿™ä¸ªé¢„è®¾æ˜¯ä¸€ä¸ªXMLæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¯¼å‡ºç»™å…¶ä»–äººä½¿ç”¨ã€‚Charlesæä¾›äº†éžå¸¸äººæ€§åŒ–çš„å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½ã€‚ ä½¿ç”¨Charlesæ·»åŠ è¯·æ±‚æ–­ç‚¹]]></content>
      <categories>
        <category>æŠ€æœ¯äººç”Ÿ</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤šç‰ˆæœ¬Cocoapodsåˆ‡æ¢]]></title>
    <url>%2F2019%2F03%2F20%2F%E5%A4%9A%E7%89%88%E6%9C%ACCocoapods%E5%88%87%E6%8D%A2%2F</url>
    <content type="text"><![CDATA[èƒŒæ™¯å¾ˆå¤š iOS é¡¹ç›®éƒ½æ˜¯åŸºäºŽç‰¹å®šç‰ˆæœ¬çš„ CocoaPodsï¼Œä½¿ç”¨å…¶ä»–ç‰ˆæœ¬çš„ CocoaPods æ‰§è¡Œ pod install æˆ– pod updateå¯èƒ½å‡ºçŽ°é¡¹ç›®æ— æ³•ç¼–è¯‘çš„é—®é¢˜ã€‚ç”±äºŽæˆ‘ä»¬çš„ç”µè„‘ä¸Šå¾ˆæœ‰å¯èƒ½ä½¿ç”¨äº†å…¶ä»–çš„ç‰ˆæœ¬ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•è§£å†³è¿™ç§å¤šç‰ˆæœ¬ CocoaPods åˆ‡æ¢çš„é—®é¢˜ã€‚ æŸ¥çœ‹æœ¬åœ°è£…çš„podå¯ä»¥é€šè¿‡1gem list --local | grep cocoapods å‘½ä»¤æ¥æŸ¥çœ‹æˆ‘ä»¬ç”µè„‘ä¸Šå®‰è£…äº†å“ªäº›ç‰ˆæœ¬çš„pod,å¹¶å¯ä»¥é€šè¿‡1pod --version æ¥æŸ¥çœ‹å½“å‰é»˜è®¤ç‰ˆæœ¬ã€‚ ä½¿ç”¨BundlerBundler æ˜¯ä¸€ä¸ª Ruby é¡¹ç›®çš„ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ç†è§£æˆä¸º Ruby ç•Œçš„ â€œCocoaPodsâ€ã€‚å‡†ç¡®æ¥è¯´ï¼ŒCocoaPods æ˜¯å€Ÿé‰´äº† Bundler çš„æ€æƒ³å’Œæ¨¡å¼ã€‚ç”±äºŽ CocoaPods æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ª Ruby é¡¹ç›®ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡ Bundler æ¥ç®¡ç†æˆ‘ä»¬è¦ä½¿ç”¨çš„ CocoaPods ç‰ˆæœ¬ï¼Œå®Œæ•´çš„æ­¥éª¤å¦‚ä¸‹æ‰€ç¤º: å®‰è£…Bundler,æ‰“å¼€ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š 1gem install bundler åœ¨ç»ˆç«¯ä¸­è¿›å…¥åˆ°é¡¹ç›®æ‰€åœ¨çš„æ ¹ç›®å½•å°±æ˜¯podfileæ‰€åœ¨çš„ç›®å½•ã€‚ åˆ›å»ºBundlerçš„é…ç½®æ–‡ä»¶Gemfile,åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä¸‹é¢çš„å‘½ä»¤å³å¯ã€‚ 1bundle init åœ¨Gemfileä¸­è®¾ç½®cocoapodsçš„ç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼š 12source &quot;https://rubygems.org&quot;gem &quot;cocoapods&quot;, &quot;1.5.3&quot; å®‰è£…ç‰¹å®šç‰ˆæœ¬çš„pod,å¦‚æžœå·²ç»å®‰è£…åˆ™å¯å¿½ç•¥è¿™ä¸€æ­¥ã€‚æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š 1bundle install æ­¤æ—¶ï¼ŒGemfileä¸­é…ç½®çš„podç‰ˆæœ¬å°±å®‰è£…åˆ°æœ¬åœ°äº†ã€‚ ä½¿ç”¨BundleræŽ§åˆ¶ä¸Šä¸€æ­¥å®‰è£…çš„podæ¥å®‰è£…æˆ‘ä»¬æ‰€éœ€çš„podsã€‚é™¤äº†æœ‰bundle exec è¿™ä¸ªå‰ç¼€ï¼Œå…¶ä»–å’Œæˆ‘ä»¬å¹³æ—¶ç”¨podå‘½ä»¤ä¸€æ ·ã€‚è‹¥åŽ»æŽ‰bundle exec è¿™ä¸ªå‰ç¼€ï¼Œè¿è¡Œçš„å°±æ˜¯é»˜è®¤ç‰ˆæœ¬çš„cocoapodsäº†ã€‚1bundle exec pod install å¦å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼è¿è¡ŒæŒ‡å®šç‰ˆæœ¬çš„podï¼Œå¦‚ï¼š1pod _1.5.3_ install äº²æµ‹æœ‰æ•ˆã€‚]]></content>
      <categories>
        <category>æŠ€æœ¯äººç”Ÿ</category>
      </categories>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€ä¸ªç®€å•çš„FPSç›‘æŽ§å™¨]]></title>
    <url>%2F2019%2F01%2F27%2F%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84FPS%E7%9B%91%E6%8E%A7%E5%99%A8%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨çœ‹æœ‰å…³iOSæ€§èƒ½ç›‘æŽ§æ–¹é¢çš„çŸ¥è¯†ï¼Œäº†è§£åˆ°å¦‚ä½•é€šè¿‡CADisplayLinkæ¥å®žçŽ°ä¸€ä¸ªç®€å•çš„å±å¹•åˆ·æ–°å¸§çŽ‡ç›‘æŽ§çš„æ–¹æ³•ï¼Œåœ¨Blogé‡Œé¢åšä¸€ä¸ªMarkã€‚ é¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸€ä¸‹CADisplayLinkæ˜¯ä¸ªä»€ä¹ˆçŽ©æ„å„¿ï¼Œå®˜æ–¹ç»™å‡ºçš„è§£é‡Šæ˜¯è¿™æ ·çš„ï¼š 1A timer object that allows your application to synchronize its drawing to the refresh rate of the display. è¯´ç™½äº†ï¼Œå°±æ˜¯ä»¥å±å¹•åˆ·æ–°é¢‘çŽ‡å°†å†…å®¹ç»˜åˆ¶åˆ°å±å¹•ä¸Šçš„å®šæ—¶å™¨ã€‚å®ƒå¯ä»¥ä»¥å±å¹•çš„åˆ·æ–°é¢‘çŽ‡è°ƒç”¨æŒ‡å®šçš„selector,è€ŒiOSç³»ç»Ÿä¸­æ­£å¸¸çš„å±å¹•åˆ·æ–°é¢‘çŽ‡ä¸º60Hz(æ¯ç§’60æ¬¡)ï¼Œé‚£æˆ‘ä»¬åªè¦åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢ç»Ÿè®¡æ¯ç§’è¿™ä¸ªæ–¹æ³•æ‰§è¡Œçš„æ¬¡æ•°ï¼Œé€šè¿‡è°ƒç”¨æ¬¡æ•°é™¤ä»¥æ—¶é—´é—´éš”(_count/interval)å°±å¯ä»¥å¾—å‡ºå½“å‰å±å¹•çš„åˆ·æ–°é¢‘çŽ‡äº†ã€‚ æŽ¥ä¸‹æ¥è´´å‡ºæ ¸å¿ƒä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940// å¼€å§‹ç›‘æŽ§FPSçš„æ–¹æ³•- (void)start &#123; if (_displayLink) &#123; _displayLink.paused = NO; &#125;else &#123; _displayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(triggerFps:)]; // è®©å½“å‰runloopåœ¨ UITrackingRunloopMode ä¸‹å¯ä»¥æŽ¥æ”¶åˆ°å›žè°ƒ [_displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes]; &#125;&#125;// åˆ·æ–°é¢‘çŽ‡å›žè°ƒæ–¹æ³•- (void)triggerFps:(CADisplayLink *)displayLink &#123; // å¤§çº¦æ¯1/60ç§’è°ƒç”¨ä¸€æ¬¡ å°±æ˜¯è¯´æ¯16.7ms è¦äº§ç”Ÿä¸€å¸§ç”»é¢ã€‚ // è®°å½•ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶çš„æ—¶é—´æˆ³ if (_lastTimestamp == 0) &#123; _lastTimestamp = displayLink.timestamp; return; &#125; _count++; // å½“count=60 æ—¶ interval &gt;= 1 æ‰ä¼šæ‰§è¡ŒåŽé¢çš„fpså€¼è®¡ç®— NSTimeInterval interval = displayLink.timestamp - _lastTimestamp; if (interval &lt; 1) &#123; return; &#125; // è®¡ç®—å‡ºfps CGFloat fps = _count / interval; // è®°å½•ä¸Šä¸€æ¬¡çš„æ—¶é—´æˆ³ _lastTimestamp = displayLink.timestamp; // reset _count _count = 0; // è°ƒæ•´fpså€¼ NSInteger intFps = (NSInteger)(fps + 0.5); self.currentFps = intFps; if (self.FPSBlock) &#123; self.FPSBlock(self.currentFps); &#125;&#125; é€šè¿‡ä¸Šé¢çš„ä»£ç å°±èƒ½ç»Ÿè®¡åˆ°å¸§æ•°çš„å˜åŒ–äº†ï¼Œè¿™ä¸ªFPSæŒ‡ç¤ºå™¨ä¹Ÿå°±å®Œæˆäº†ã€‚]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•æ‰“åŒ…ä¸€ä¸ªä¾èµ–ç¬¬ä¸‰æ–¹frameworkï¼ˆå¦‚æ”¯ä»˜å®çš„frameworkï¼‰çš„é™æ€framework]]></title>
    <url>%2F2018%2F12%2F01%2F%E5%A6%82%E4%BD%95%E6%89%93%E5%8C%85%E4%B8%80%E4%B8%AA%E4%BE%9D%E8%B5%96%E7%AC%AC%E4%B8%89%E6%96%B9framework%EF%BC%88%E5%A6%82%E6%94%AF%E4%BB%98%E5%AE%9D%E7%9A%84framework%EF%BC%89%E7%9A%84%E9%9D%99%E6%80%81framework%2F</url>
    <content type="text"><![CDATA[è¿™ç¯‡æ–‡ç« æˆ‘ä»¬ä¸»è¦æ¥æŽ¢è®¨ä¸€ä¸‹ï¼Œå¦‚ä½•è®©ä¸€ä¸ªé™æ€framework ä¾èµ–å…¶ä»–çš„é™æ€frameworkï¼Œæœ¬æ–‡ä»¥æ´»ä½“æ£€æµ‹çš„frameworkä¸ºä¾‹æ¥ä¸€æ­¥æ­¥è¯´æ˜Žæ˜¯å¦‚ä½•å®žçŽ°çš„ã€‚ å¦‚ä½•æ‰“åŒ…ä¸€ä¸ªä¾èµ–AFNetworkingçš„é™æ€framework è‡³äºŽå¦‚ä½•æ‰“åŒ…ä¸€ä¸ªé™æ€åº“çš„é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æœ¬äººä¸Šä¸€ç¯‡æ–‡ç« ï¼š è¿™ç¯‡æ–‡ç« æˆ‘ä»¬åŸºäºŽä¸Šä¸€ç¯‡æ–‡ç« ä¸­çš„ä¾‹å­ç»§ç»­è®²è§£ã€‚ ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†éœ€è¦çš„ä¸‰æ–¹framework ä»¥åŠ bundle å¯¼å…¥åˆ°CLNetStaticFrameworké‡Œé¢çš„Libsæ–‡ä»¶å¤¹ä¸‹ï¼Œæ³¨æ„ï¼å¯¼å…¥çš„æ—¶å€™Add to targets è¿™ä¸€é¡¹ä¸€å®šä¸è¦å‹¾é€‰ï¼Œåªéœ€è¦å¯¼å…¥å³å¯å¦‚å›¾(1)ã€‚ä¹‹æ‰€ä»¥è¿™æ ·æ˜¯å› ä¸ºï¼Œé™æ€åº“æ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ï¼Œä¸èƒ½ä¸€ä¸ªé™æ€åº“åŒ…å«å¦å¤–ä¸€ä¸ªé™æ€åº“ï¼Œåªèƒ½æ˜¯ä¾èµ–ï¼Œè¿™æ ·ä¸ä¼šé€ æˆé‡å¤å¼•ç”¨ã€‚ å›¾1è¿™é‡Œéœ€è¦è¯´æ˜Žçš„æ˜¯ï¼Œè¿™é‡Œä¸æ·»åŠ åˆ°targetè‡ªç„¶ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆframework pathï¼Œæ‰€ä»¥éœ€è¦åœ¨å·¥ç¨‹çš„Framework Search Paths é‡Œé¢æ‰‹åŠ¨é…ç½®ä¸€ä¸‹framework è·¯å¾„å¦‚å›¾(2)ï¼Œå¦‚æžœä¸é…ç½®çš„è¯ï¼Œå¼•ç”¨çš„ä¸‰æ–¹åº“å¤´æ–‡ä»¶æ—¶ä¼šæŠ¥æ‰¾ä¸åˆ°å¤´æ–‡ä»¶é”™è¯¯ã€‚ å›¾2ç„¶åŽæ˜¯æ·»åŠ ç¬¬ä¸‰æ–¹frameworkéœ€è¦çš„ç³»ç»Ÿåº“ï¼Œè¿™é‡Œæ´»ä½“æ£€æµ‹frameworkéœ€è¦çš„æœ‰CoreMedia.framework,CoreMotion.frameworkï¼Œåœ¨Build Phases -&gt; Link Binary With Libraries é‡Œé¢ä¾æ¬¡æ·»åŠ ã€‚å¦å¤–ï¼Œè¿˜éœ€è¦å°†å·¥ç¨‹ä¸­çš„Enable Bitcode è®¾ç½®ä¸ºNO, æ­¤æ—¶cmd+bç¼–è¯‘ä¸€ä¸‹åº”è¯¥å¯ä»¥é€šè¿‡äº†ã€‚ ç„¶åŽæ–°å»ºä¸€ä¸ªCLLiveDetectç±»ï¼Œè¿™é‡Œé¢ä¼šå†™ä¸€äº›å…³äºŽæ´»ä½“æ£€æµ‹çš„ä»£ç ï¼Œå¹¶è°ƒèµ·æ´»ä½“æ£€æµ‹SDK.å†™ä¸€äº›æµ‹è¯•ä»£ç å¦‚å›¾(3) å›¾3æŽ¥ä¸‹æ¥æŠŠCLLiveDetect.hæš´éœ²å‡ºæ¥ï¼Œæš´éœ²æ–¹æ³•åŒä¸Šä¸€ç¯‡æ–‡ç« ä¸­çš„æ–¹æ³•ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚åˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥cmd+bæ¥buildæˆ‘ä»¬çš„framework äº†ã€‚ ç¬¬äºŒæ­¥ï¼Œå¦‚ä½•ä½¿ç”¨åˆšæ‰æž„å»ºå¥½çš„framework? å°†æˆ‘ä»¬åˆšæ‰buildçš„framework å¯¼å…¥åˆ°ABSDKDemoå·¥ç¨‹ä¸­ï¼Œé‡ç‚¹æ¥äº†ï¼ï¼åŒæ—¶ä¹Ÿéœ€è¦å°†æ´»ä½“æ£€æµ‹çš„frameworkä»¥åŠbundle å¯¼å…¥åˆ°è¯¥å·¥ç¨‹ä¸­ã€‚å¹¶ä¸”ä¹Ÿè¦åŠ ä¸Šç¼–è¯‘éœ€è¦ä¾èµ–çš„framework:CoreMedia.framework,CoreMotion.frameworkï¼ŒEnable Bitcode è®¾ç½®ä¸ºNO, å¦åˆ™çš„è¯ä¸èƒ½é€šè¿‡ç¼–è¯‘ã€‚ å¯¼å…¥å®Œæˆä»¥åŽcmd+b ä¸€ä¸‹ä½ ä¼šå‘çŽ°å·¥ç¨‹ç¼–è¯‘æˆåŠŸäº†ï¼Œç„¶åŽæˆ‘ä»¬è¿è¡Œèµ·æ¥çœ‹çœ‹æ•ˆæžœã€‚ç»“æžœæˆ‘ä»¬è¿˜æ˜¯ä»¥XcodeæŽ§åˆ¶å°çš„æ—¥å¿—ä¸ºå‡†ï¼ˆå›¾ï¼ˆ4ï¼‰ï¼‰ã€‚ å›¾4åˆ°è¿™é‡Œï¼Œæ‰“åŒ…ä¸€ä¸ªä¾èµ–ç¬¬ä¸‰æ–¹frameworkçš„é™æ€åº“å·²ç»èŠå®Œäº†ï¼Œæ¬¢è¿Žå¤§å®¶å‹˜è¯¯ã€‚ éœ€è¦demoçš„æœ‹å‹å¯ä»¥åˆ°è¿™é‡ŒåŽ»ä¸‹è½½ï¼š CLNetStaticFramework é™æ€åº“æºç  é™æ€åº“æµ‹è¯•å·¥ç¨‹ æºç  æ¬¢è¿Žstar ^.^,æ¬¢è¿Žåæ§½ã€‚]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>Objective-C</tag>
        <tag>é™æ€åº“</tag>
        <tag>framework</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Blockåº•å±‚å®žçŽ°ä¹‹é€†å‘æ€ç»´]]></title>
    <url>%2F2018%2F08%2F21%2FBlock%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E4%B9%8B%E9%80%86%E5%90%91%E6%80%9D%E7%BB%B4%2F</url>
    <content type="text"><![CDATA[å‰æ®µæ—¶é—´å¿ƒè¡€æ¥æ½®ï¼Œç ”ç©¶äº†ä¸€ä¸‹blockåº•å±‚å®žçŽ°ï¼Œåœ¨ç½‘ä¸Šçœ‹äº†å¥½å¤šæ–‡ç« ï¼ŒåŸºæœ¬éƒ½æ˜¯é€šè¿‡clang å°†ä»£ç è½¬æ¢ä¸ºC++ä»£ç åŽ»åˆ†æžBlcokçš„å®žçŽ°ã€‚ä»Šå¤©æˆ‘ä»¬åè¿‡æ¥æ€è€ƒï¼Œç”¨CåŽ»å®žçŽ°ä¸€ä¸ªOC Blockçš„æ•ˆæžœã€‚ Blockçš„å®žçŽ°æœ¬è´¨ä¸Šæ˜¯ä¸€äº›ç»“æž„ä½“ï¼Œå‡½æ•°æŒ‡é’ˆï¼Œå‡½æ•°ï¼Œçš„ç»¼åˆè¿ç”¨ã€‚ è¯ä¸å¤šè¯´ï¼Œç›´å¥”ä¸»é¢˜ï¼š Blockçš„å®žçŽ°ï¼Œé¦–å…ˆéœ€è¦å£°æ˜Žä¸€ä¸ªç»“æž„ï¼Œè¿™ä¸ªç»“æž„æ˜¯æˆ‘ä»¬å®žçŽ°Blockçš„åŸºç¡€ï¼Œä¹Ÿæ˜¯å…³é”®1234567891011struct __block_impl &#123;void *isa; int Flags;int Reserved;void *FuncPtr;&#125;; è¯´æ˜Žä¸€ä¸‹ï¼š 1.isa ä¿å­˜çš„æ˜¯Blockçš„ç±»åž‹ 2.Flags å½“blockå‘ç”Ÿcopyæ—¶ï¼Œä¼šç”¨åˆ° 3.FuncPtr æŒ‡é’ˆï¼ŒæŒ‡å‘blockå†…çš„å‡½æ•°å®žçŽ°ï¼ˆåŽé¢å‡½æ•°æŒ‡é’ˆè°ƒç”¨çš„å‡½æ•°ï¼‰ è¿™ä¸ªç»“æž„ä½“ï¼Œæ˜¯æ‰€æœ‰ç±»åž‹çš„Blockéƒ½ä¼šæœ‰çš„ä¸€éƒ¨åˆ†ã€‚ ç„¶åŽæˆ‘ä»¬çœ‹ç¬¬äºŒä¸ªç»“æž„ä½“1234567static struct __simpleblk_block_desc_0 &#123;size_t reserved;size_t Block_size;&#125; __simpleblk_block_desc_0_DATA = &#123;0,sizeof(struct __simpleblk_block_impl_0)&#125;; è¯´æ˜Žä¸€ä¸‹ï¼š 1.reserved ä¿ç•™å­—æ®µé»˜è®¤æ˜¯0 2.Block_size ç”¨æ¥ä¿å­˜blockæ‰€å å†…å­˜å¤§å°ã€‚ è¿™ä¸ªç»“æž„ä½“ç”¨æ¥æè¿°blockçš„å¤§å°ç­‰ä¿¡æ¯ï¼Œsimpleblk_block_desc_0_DATAæ˜¯simpleblk_block_desc_0çš„ä¸€ä¸ªç»“æž„ä½“å®žä¾‹ã€‚ æˆ‘ä»¬å†çœ‹ç¬¬ä¸‰ä¸ªç»“æž„ä½“ï¼Œä¹Ÿæ˜¯Blockå®žçŽ°æœ€é‡è¦çš„ç»“æž„ï¼Œå£°æ˜Žå¦‚ä¸‹ï¼š12345678910111213141516171819struct __simpleblk_block_impl_0 &#123;struct __block_impl impl;struct __simpleblk_block_desc_0 *Desc;__simpleblk_block_impl_0(void *fp,struct __simpleblk_block_desc_0 *desc,int flags = 0)&#123;impl.isa = &amp;_NSConcreteStackBlock;impl.Flags = flags;impl.FuncPtr = fp;Desc = desc;&#125;&#125;; è¯´æ˜Žä¸€ä¸‹ï¼š ä»Žè¿™ä¸ªç»“æž„ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè¯¥ç»“æž„ä½“å«æœ‰ block_impl ç»“æž„çš„å˜é‡ å’Œ simpleblk_block_desc_0 ç»“æž„çš„å˜é‡ï¼Œä»¥åŠç»“æž„ä½“æž„é€ å‡½æ•°simpleblk_block_impl_0ï¼Œç»“æž„ä½“æž„é€ å‡½æ•°ç”¨æ¥åˆå§‹åŒ–å˜é‡block_implå’Œ__simpleblk_block_desc_0ã€‚ åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å®žçŽ°æœ€ç®€å•çš„Blockæ‰€éœ€è¦çš„ç»“æž„å°±å£°æ˜Žå®Œäº†ï¼Œä½†æ˜¯è¦è¾¾åˆ°OC Block é‚£ç§æ•ˆæžœï¼Œä»…æœ‰ç»“æž„ä½“ è‚¯å®šæ˜¯ä¸å¤Ÿçš„ã€‚æˆªä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…³é”®çš„å‡½æ•°ï¼Œä½ æ²¡çŒœé”™å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„Cå‡½æ•°ï¼š12345static void __simpleblk_block_func_0(struct __simpleblk_block_impl_0 *__cself) &#123;printf(&quot;this is charles&apos;s simple block!!&quot;);&#125; è¿™ä¸ªå‡½æ•°å…¶å®žå°±æ˜¯æˆ‘ä»¬çš„Blockå—é‡Œé¢çš„æ“ä½œã€‚åŽé¢è°ƒç”¨ä¹‹åŽå°±ä¼šå¾ˆæ¸…æ¥šã€‚ åˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥å†™ä¸€ä¸ªCå‡½æ•°æ¥è¾¾åˆ°ä¸€ä¸ªBlockçš„æ•ˆæžœï¼š int simpleblk(){ //å£°æ˜Žä¸€ä¸ªç»“æž„ä½“å˜é‡1__simpleblk_block_impl_0 __simpleblk_impl0 = __simpleblk_block_impl_0((void *)__simpleblk_block_func_0,&amp;__simpleblk_block_desc_0_DATA); //å£°æ˜Žä¸€ä¸ªå‡½æ•°æŒ‡é’ˆå˜é‡blockï¼Œå¹¶ä¸”å°†ä¸Šé¢çš„ç»“æž„ä½“å˜é‡çš„åœ°å€ä»˜ç»™blockæŒ‡é’ˆ1void(*block)(void) = (void(*)())&amp;__simpleblk_impl0; 1234/*ä¸‹é¢è¿™å¥ä»£ç  å®žé™…ä¸Šè°ƒç”¨çš„æ˜¯ __simpleblk_block_func_0ï¼ˆï¼‰å‡½æ•°å°±æ˜¯å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°ã€‚*/ 12345((void (*)(struct __block_impl *))((struct __block_impl *)block)-&gt;FuncPtr)((struct __block_impl *)block);return 1;&#125; å…¶å®žï¼Œä¸Šé¢å†™äº†è¿™ä¹ˆå¤šï¼Œæ¢æˆOCä»£ç å…¶å®žå°±æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œå£°æ˜Žäº†ä¸€ä¸ªBlockå˜é‡å¹¶ä¸”è°ƒç”¨å®ƒã€‚12345678910111213int simpleblk() &#123;void (^block)(void) = ^()&#123;printf(&quot;this is charles&apos;s block!!&quot;);&#125;;block();return 1;&#125; åˆ°è¿™é‡Œæˆ‘ä»¬ç”¨Cè¯­è¨€å®žçŽ°OCçš„ Blockæ•ˆæžœåŸºæœ¬å°±å†™å®Œäº†ï¼Œä¸çŸ¥é“å„ä½çœ‹å®˜æ˜¯å¦çœ‹æ˜Žç™½äº†å‘¢ã€‚ã€‚ï¼ˆPS:æ¬¢è¿Žå¤§å®¶å‹˜è¯¯ï¼Œå…±åŒå­¦ä¹ ï¼ï¼‰]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆæŽ¢Categoryå®žçŽ°åŽŸç†]]></title>
    <url>%2F2018%2F07%2F24%2F%E5%88%9D%E6%8E%A2Category%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[Objective-C åˆ†ç±»çš„å®žçŽ°åŽŸç†,é˜…è¯»runtimeæºç ä¼šå‘çŽ°ï¼Œåˆ†ç±»åœ¨è¿è¡Œæ—¶çš„ç»“æž„æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š 12345678910111213141516struct category_t &#123; const char *name; // åˆ†ç±»åç§° classref_t cls; // åˆ†ç±»æ‰€å±žçš„å®¿ä¸»ç±» struct method_list_t *instanceMethods; // å®žä¾‹æ–¹æ³•åˆ—è¡¨ struct method_list_t *classMethods; // ç±»æ–¹æ³•åˆ—è¡¨ struct protocol_list_t *protocols; // åè®®åˆ—è¡¨ struct property_list_t *instanceProperties; // å±žæ€§åˆ—è¡¨ method_list_t *methodsForMeta(bool isMeta) &#123; if (isMeta) return classMethods; else return instanceMethods; &#125; property_list_t *propertiesForMeta(bool isMeta) &#123; if (isMeta) return nil; // classProperties; else return instanceProperties; &#125;&#125;; nameä»£è¡¨çš„æ˜¯åˆ†ç±»çš„åç§°ï¼›clsæ˜¯åˆ†ç±»æ‰€å±žçš„å®¿ä¸»ç±»ï¼›classMethodsæ˜¯å®žä¾‹æ–¹æ³•åˆ—è¡¨ï¼›classMethodsç±»æ–¹æ³•åˆ—è¡¨ï¼›protocolsæ˜¯åè®®åˆ—è¡¨ï¼›instancePropertiesæ˜¯å±žæ€§åˆ—è¡¨ã€‚ä»Žä¸­å¯ä»¥å‘çŽ°ï¼Œå¯ä»¥ç»™åˆ†ç±»æ·»åŠ å®žä¾‹æ–¹æ³•ã€ç±»æ–¹æ³•ã€åè®®ã€ä»¥åŠå±žæ€§ã€‚ æŽ¥ä¸‹æ¥çœ‹ä¸€ä¸‹åˆ†ç±»åœ¨è¿è¡Œæ—¶çš„åŠ è½½è°ƒç”¨æ ˆï¼š 1 _objc_init 2 map_3_images 3 map_images_nolock 4 _read_images 5 remethodizeClass äº‹å®žä¸Šï¼Œåˆ†ç±»åœ¨è¿è¡Œæ—¶åŠ è½½çš„å…¥å£æ˜¯ä»ŽremethodizeClassçš„æ–¹æ³•å¼€å§‹çš„ã€‚è¯¥æ–¹æ³•çš„åŠŸèƒ½æ˜¯ï¼šé™„åŠ å¤–éƒ¨çš„åˆ†ç±»åˆ°å·²ç»å­˜åœ¨çš„ç±»é‡Œé¢ï¼›ä¿®æ”¹æ–¹æ³•åˆ—è¡¨ã€åè®®åˆ—è¡¨ã€å±žæ€§åˆ—è¡¨ï¼Œæ›´æ–°æ–¹æ³•ç¼“å­˜ä»¥åŠå…¶å­ç±»ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨å®žçŽ°ï¼Œç„¶åŽä¸€æ­¥æ­¥çš„æŽ¢è®¨ç³»ç»Ÿæ˜¯å¦‚ä½•ç»™å®¿ä¸»ç±»æ·»åŠ åˆ†ç±»çš„ã€‚ 123456789101112131415161718192021static void remethodizeClass(Class cls)&#123; category_list *cats; bool isMeta; runtimeLock.assertWriting(); isMeta = cls-&gt;isMetaClass(); // Re-methodizing: check for more categories // èŽ·å–clsä¸­æœªå®Œæˆæ•´åˆçš„æ‰€æœ‰åˆ†ç±» if ((cats = unattachedCategoriesForClass(cls, false/*not realizing*/))) &#123; if (PrintConnecting) &#123; _objc_inform("CLASS: attaching categories to class '%s' %s", cls-&gt;nameForLogging(), isMeta ? "(meta)" : ""); &#125; attachCategories(cls, cats, true /*flush caches*/); free(cats); &#125;&#125; æ–¹æ³•ä¸­çš„isMetaå˜é‡æ˜¯ç”¨æ¥åˆ¤æ–­æˆ‘ä»¬çš„åˆ†ç±»ä¸­æ˜¯æ·»åŠ çš„ç±»æ–¹æ³•ï¼Œè¿˜æ˜¯å®žä¾‹æ–¹æ³•ï¼› ifè¯­å¥ä¸­çš„unattachedCategoriesForClassæ–¹æ³•å°±æ˜¯ç”¨æ¥èŽ·å–clsä¸­æ²¡æœ‰è¢«é™„åŠ çš„åˆ†ç±»åˆ—è¡¨ã€‚ åˆ†æ”¯é‡Œé¢çš„attachCategoriesæ–¹æ³•å°±æ˜¯ç”¨æ¥é™„åŠ åˆ†ç±»çš„æ–¹æ³•åˆ—è¡¨ã€å±žæ€§åˆ—è¡¨ã€åè®®åˆ—è¡¨åˆ°å®¿ä¸»ç±»ä¸­çš„æ ¸å¿ƒæ–¹æ³•ã€‚ æŽ¥ç€çœ‹attachCategoriesæ–¹æ³•çš„å†…éƒ¨å®žçŽ°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768static void attachCategories(Class cls, category_list *cats, bool flush_caches)&#123; if (!cats) return; if (PrintReplacedMethods) printReplacements(cls, cats); bool isMeta = cls-&gt;isMetaClass(); // fixme rearrange to remove these intermediate allocations /* äºŒç»´æ•°ç»„ [[method_t,menthod_t,...],[method_t],[method_t,method_t],...] */ method_list_t **mlists = (method_list_t **) malloc(cats-&gt;count * sizeof(*mlists)); property_list_t **proplists = (property_list_t **) malloc(cats-&gt;count * sizeof(*proplists)); protocol_list_t **protolists = (protocol_list_t **) malloc(cats-&gt;count * sizeof(*protolists)); // Count backwards through cats to get newest categories first int mcount = 0; // æ–¹æ³•ä¸ªæ•° int propcount = 0; // å±žæ€§ä¸ªæ•° int protocount = 0; // åè®®ä¸ªæ•° int i = cats-&gt;count; // å®¿ä¸»ç±»åˆ†ç±»çš„æ€»æ•° bool fromBundle = NO; while (i--) &#123; // è¿™é‡Œæ˜¯å€’åºéåŽ†ï¼Œæœ€å…ˆè®¿é—®æœ€åŽç¼–è¯‘çš„åˆ†ç±» // èŽ·å–ä¸€ä¸ªåˆ†ç±» auto&amp; entry = cats-&gt;list[i]; // èŽ·å–è¯¥åˆ†ç±»çš„æ–¹æ³•åˆ—è¡¨ method_list_t *mlist = entry.cat-&gt;methodsForMeta(isMeta); if (mlist) &#123; // æœ€åŽç¼–è¯‘çš„åˆ†ç±»æœ€å…ˆæ·»åŠ åˆ°åˆ†ç±»æ•°ç»„ä¸­ mlists[mcount++] = mlist; fromBundle |= entry.hi-&gt;isBundle(); &#125; // å±žæ€§åˆ—è¡¨æ·»åŠ è§„åˆ™ åŒæ–¹æ³•åˆ—è¡¨æ·»åŠ è§„åˆ™ property_list_t *proplist = entry.cat-&gt;propertiesForMeta(isMeta); if (proplist) &#123; proplists[propcount++] = proplist; &#125; protocol_list_t *protolist = entry.cat-&gt;protocols; if (protolist) &#123; protolists[protocount++] = protolist; &#125; &#125; // èŽ·å–å®¿ä¸»ç±»å½“ä¸­çš„rw æ•°æ®ï¼Œå…¶ä¸­åŒ…å«å®¿ä¸»ç±»çš„æ–¹æ³•åˆ—è¡¨ä¿¡æ¯ auto rw = cls-&gt;data(); // ä¸»è¦æ˜¯é’ˆå¯¹ åˆ†ç±»ä¸­æœ‰å…³äºŽå†…å­˜ç®¡ç†ç›¸å…³æ–¹æ³•æƒ…å†µä¸‹çš„ ä¸€äº›ç‰¹æ®Šå¤„ç† prepareMethodLists(cls, mlists, mcount, NO, fromBundle); /* rw ä»£è¡¨ç±» methods ä»£è¡¨ç±»çš„æ–¹æ³•åˆ—è¡¨ attachLists æ–¹æ³•çš„å«ä¹‰æ˜¯ å°†mcountä¸ªå…ƒç´ çš„mlists æ‹¼æŽ¥åˆ°rwçš„methodsä¸Š */ rw-&gt;methods.attachLists(mlists, mcount); free(mlists); if (flush_caches &amp;&amp; mcount &gt; 0) flushCaches(cls); rw-&gt;properties.attachLists(proplists, propcount); free(proplists); rw-&gt;protocols.attachLists(protolists, protocount); free(protolists);&#125; isMetaå˜é‡çš„å«ä¹‰åŒä¸Šæ–‡ï¼Œä¾ç„¶æ˜¯åˆ¤æ–­æ·»åŠ çš„æ–¹æ³•æ˜¯å®žä¾‹æ–¹æ³•è¿˜æ˜¯ç±»æ–¹æ³•ã€‚è¿™é‡Œæˆ‘ä»¬åªè®¨è®ºä¸ºåˆ†ç±»æ·»åŠ å®žä¾‹æ–¹æ³•çš„æƒ…å†µï¼Œmlistsã€proplistsã€protolistsè¿™ä¸‰ä¸ªéƒ½æ˜¯äºŒç»´æ•°ç»„ï¼Œåˆ†åˆ«ä»£è¡¨æ–¹æ³•åˆ—è¡¨ã€å±žæ€§åˆ—è¡¨ã€åè®®åˆ—è¡¨ã€‚æˆ‘è¿™é‡Œä¸»è¦åˆ†æžå…³äºŽæ–¹æ³•æ·»åŠ çš„é€»è¾‘ã€‚method_list_tç»“æž„å­˜å‚¨çš„æ˜¯method_tç»“æž„è¿™é‡Œå®ƒä»£è¡¨ä¸€ä¸ªæ–¹æ³•ï¼Œå…³äºŽè¿™ä¸¤ä¸ªçš„å…·ä½“å†…å®¹å¤§å®¶å¯ä»¥åŽ»runtimeæºç é‡Œé¢æ‰¾ç­”æ¡ˆã€‚ æŽ¥ä¸‹æ¥æ˜¯ä»£è¡¨æ–¹æ³•æ•°é‡çš„mcountå˜é‡ï¼Œå±žæ€§æ•°é‡çš„propcountå˜é‡ï¼Œåè®®æ•°é‡çš„protocountå˜é‡ï¼›iæŒ‡çš„æ˜¯å®¿ä¸»ç±»åˆ†ç±»çš„æ€»æ•°ã€‚ æŽ¥ä¸‹æ¥å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªå€’åºçš„whileå¾ªçŽ¯ï¼Œå€’åºçš„å«ä¹‰å°±æ˜¯æœ€å…ˆè®¿é—®æœ€åŽç¼–è¯‘çš„åˆ†ç±»ï¼Œå› ä¸ºcatsä¸­çš„åˆ†ç±»æ˜¯æŒ‰ç…§ç¼–è¯‘é¡ºåºæ·»åŠ çš„ã€‚ è¿™å°±æŠ›å‡ºæ¥ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æžœä¸€ä¸ªç±»æœ‰ä¸¤ä¸ªåˆ†ç±»ï¼Œè¿™ä¸¤ä¸ªåˆ†ç±»æœ‰ä¸€ä¸ªåŒåæ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ–¹æ³•å“ªä¸ªä¼šç”Ÿæ•ˆï¼Ÿ ç­”æ¡ˆå°±æ˜¯å–å†³äºŽä¸¤ä¸ªæ–¹æ³•æ‰€å±žçš„åˆ†ç±»çš„ç¼–è¯‘é¡ºåºï¼Œå°±æ˜¯è¯´çœ‹ä¸¤ä¸ªåˆ†ç±»å“ªä¸€ä¸ªæœ€åŽè¢«åŠ å…¥åˆ°catsä¸­ã€‚ ç»è¿‡ä¸€ç³»åˆ—çš„å¤„ç†ä¹‹åŽå‘¢ï¼Œå°±ä¼šæ‰§è¡Œmethod.attachListsæ–¹æ³•æ¥å°†åˆ†ç±»çš„æ–¹æ³•åˆ—è¡¨æ·»åŠ åˆ°å®¿ä¸»ç±»ä¸­ã€‚ æŽ¥ä¸‹æ¥çœ‹ä¸€ä¸‹method.attachListsè¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨å®žçŽ°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556/* addedLists ä¼ é€’è¿‡æ¥çš„äºŒç»´æ•°ç»„ [[method_t,method_t,...], [method_t], [method_t,method_t,method_t],...] ------------------------ ----------- --------------------------------- åˆ†ç±»Aä¸­çš„æ–¹æ³•åˆ—è¡¨ B C addedCount = 3 */ void attachLists(List* const * addedLists, uint32_t addedCount) &#123; if (addedCount == 0) return; if (hasArray()) &#123; // many lists -&gt; many lists // åˆ—è¡¨ä¸­åŽŸæœ‰å…ƒç´ æ€»æ•° uint32_t oldCount = array()-&gt;count; // æ‹¼æŽ¥ä¹‹åŽçš„å…ƒç´ æ€»æ•° uint32_t newCount = oldCount + addedCount; // æ ¹æ®æ‹¼æŽ¥ä¹‹åŽçš„æ€»æ•°é‡æ–°åˆ†é…ç©ºé—´ setArray((array_t *)realloc(array(), array_t::byteSize(newCount))); // é‡æ–°è®¾ç½®å…ƒç´ æ€»æ•° array()-&gt;count = newCount; /* å†…å­˜ç§»åŠ¨ [[],[],[],[åŽŸæœ‰çš„ç¬¬ä¸€ä¸ªå…ƒç´ ],[åŽŸæœ‰çš„ç¬¬äºŒä¸ªå…ƒç´ ]] */ memmove(array()-&gt;lists + addedCount, array()-&gt;lists, oldCount * sizeof(array()-&gt;lists[0])); /* å†…å­˜æ‹·è´ [ A ----&gt; [addedListsä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ], B ----&gt; [addedListsä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ ], C ----&gt; [addedListsä¸­çš„ç¬¬ä¸‰ä¸ªå…ƒç´ ], [åŽŸæœ‰çš„ç¬¬ä¸€ä¸ªå…ƒç´ ], [åŽŸæœ‰çš„ç¬¬äºŒä¸ªå…ƒç´ ] ] è¿™ä¹Ÿæ˜¯åˆ†ç±»æ–¹æ³•ä¼šâ€œè¦†ç›–â€å®¿ä¸»ç±»çš„æ–¹æ³•çš„åŽŸå›  */ memcpy(array()-&gt;lists, addedLists, addedCount * sizeof(array()-&gt;lists[0])); &#125; else if (!list &amp;&amp; addedCount == 1) &#123; // 0 lists -&gt; 1 list list = addedLists[0]; &#125; else &#123; // 1 list -&gt; many lists List* oldList = list; uint32_t oldCount = oldList ? 1 : 0; uint32_t newCount = oldCount + addedCount; setArray((array_t *)malloc(array_t::byteSize(newCount))); array()-&gt;count = newCount; if (oldList) array()-&gt;lists[addedCount] = oldList; memcpy(array()-&gt;lists, addedLists, addedCount * sizeof(array()-&gt;lists[0])); &#125; &#125; addedListsæ˜¯ç»è¿‡å¤„ç†çš„æ–¹æ³•åˆ—è¡¨ã€‚oldCountæ˜¯åŽŸæœ‰å…ƒç´ æ€»æ•°ã€‚newCountæ˜¯æ‹¼æŽ¥ä¹‹åŽçš„å…ƒç´ æ€»æ•°ï¼Œreallocä¼šé‡æ–°æŒ‰ç…§æ‹¼æŽ¥åŽçš„æ€»æ•°é‡æ–°åˆ†é…ç©ºé—´ã€‚ç„¶åŽé‡æ–°è®¾ç½®å…ƒç´ æ€»æ•°ã€‚æŽ¥ä¸‹æ¥è°ƒç”¨memoveç§»åŠ¨å†…å­˜ï¼Œä¼šå°†åŽŸæ¥çš„å…ƒç´ å‘åŽç§»åŠ¨ï¼Œæ–°æ‹¼æŽ¥çš„å…ƒç´ ä¼šæ’å…¥åˆ°åŽŸæœ‰å…ƒç´ çš„å‰é¢ã€‚æœ€åŽï¼Œè°ƒç”¨memcpyæ‹·è´å†…å­˜ï¼Œæ‹·è´åŽçš„å†…å­˜å­˜å‚¨ç»“æž„å¦‚æ³¨é‡Šä¸­æ‰€ç¤ºã€‚è¿™ä¹Ÿå°±æ˜¯åˆ†ç±»æ–¹æ³•ä¼šâ€œè¦†ç›–â€œå®¿ä¸»ç±»æ–¹æ³•çš„åŽŸå› ã€‚ åˆ°æ­¤ä¸ºæ­¢ï¼Œåˆ†ç±»ä¸­çš„æ–¹æ³•å·²ç»æ‹¼æŽ¥åˆ°å®¿ä¸»ç±»ä¸­äº†ã€‚]]></content>
      <tags>
        <tag>Objective-c</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ çœŸçš„æ˜Žç™½isKindOfClass å’Œ isMemberOfClass çš„åŒºåˆ«ä¹ˆï¼Ÿ]]></title>
    <url>%2F2018%2F07%2F23%2F%E4%BD%A0%E7%9C%9F%E7%9A%84%E6%98%8E%E7%99%BDisKindOfClass-%E5%92%8C-isMemberOfClass-%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B9%88%EF%BC%9F%2F</url>
    <content type="text"><![CDATA[å‰å‡ å¤©çœ‹åšå®¢å‘çŽ°äº†ä¸€ä¸ªå…³äºŽ isKindOfClass å’Œ isMemberOfClass çš„é—®é¢˜ï¼Œä½†æ˜¯æ„Ÿè§‰åˆ†æžçš„ä¸å¤Ÿé€å½»ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™é‡Œè¯•ç€åˆ†æžä¸€ä¸‹ï¼Œæ¬¢è¿Žå¤§å®¶ä¸€èµ·è®¨è®ºã€‚ å†…å®¹æ˜¯è¿™æ ·çš„ ï¼ˆå¦‚å›¾1ï¼‰ã€‚ å›¾1ä¸Šå›¾ä¸­çš„å››ä¸ªBool åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘åœ¨è¿™é‡Œå…ˆçˆ†å‡ºç­”æ¡ˆï¼šä¸Šé¢æ˜¯ä¸ªBool åˆ†åˆ«æ˜¯ï¼š1 ï¼Œ0ï¼Œ0ï¼Œ0ï¼›é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºæ¯›ä¼šæ˜¯è¿™ä¸ªç»“æžœï¼Ÿè¦å¼„æ˜Žç™½è¿™ä¸ªå°±è¦æžæ¸…æ¥šisKindOfClass å’Œ isMemberOfClass çš„åŒºåˆ«ï¼Œå…ˆæ¥çœ‹çœ‹å®˜æ–¹çš„è¯´æ³•ï¼šisKindOfClassï¼šReturns a Boolean value that indicates whether the receiver is an instance of given class or an instance of any class that inherits from that class.isMemberOfClassï¼šReturns a Boolean value that indicates whether the receiver is an instance of a given class.å…¶å®žå°±æ˜¯è¿™ä¸ªæ„æ€ï¼šisKindOfClassï¼šåˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæŸç±»æˆ–å…¶æ´¾ç”Ÿç±»çš„å®žä¾‹ã€‚isMemberOfClassï¼šåˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæŸä¸ªç‰¹å®šç±»çš„å®žä¾‹ã€‚å¥½ï¼Œé‚£ä¹ˆå…ˆæ¥åˆ†æžres1 ä¸ºä»€ä¹ˆæ˜¯Yes.é¦–å…ˆäº†è§£ä¸€ä¸‹class æ–¹æ³•çš„å®žçŽ° ï¼ˆå›¾2ï¼‰å›¾2ä»Žå›¾2ä¸­å¯ä»¥çœ‹å‡º[NSObject class]; è¿”å›žçš„å…¶å®žè¿˜æ˜¯NSObject,åˆ°è¿™é‡Œä½ å¯èƒ½ä¼šæƒ³NSObject isKindOfClass NSObject æ‰€ä»¥ res1 = Yesã€‚But,But,But,é‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼Œäº‹å®žå¹¶éžå¦‚æ­¤ï¼ŒæŽ¥ç€æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹isKindOfClass æ–¹æ³•çš„å®žçŽ°ï¼ˆå›¾3ï¼‰å›¾3 ä»¥åŠobject_getClass çš„å®žçŽ° ï¼ˆå›¾4ï¼‰ å›¾4é€šè¿‡æŸ¥é˜…objc4 æºç  å°±æ˜¯ä¸Šé¢çš„å›¾3å’Œå›¾4ï¼Œä¼šå‘çŽ°object_getClass è¿”å›žçš„æ˜¯ä¼ å…¥çš„å¯¹è±¡çš„isa,ç”±äºŽæˆ‘ä»¬ä¼ å…¥çš„æ˜¯ç±»å¯¹è±¡ï¼Œæ‰€ä»¥isa æŒ‡å‘çš„æ˜¯ä¸€ä¸ªå…ƒç±»å¯¹è±¡ï¼Œé‚£ä¹ˆobject_getClass((id)self);è¿”å›žçš„å°±æ˜¯self çš„å…ƒç±»å¯¹è±¡ï¼Œé‚£ä¹ˆNSObject ç±»å¯¹è±¡çš„å…ƒç±»å¯¹è±¡æ˜¯è°å‘¢?å¦‚æžœä½ äº†è§£OCçš„å¯¹è±¡æ¨¡åž‹çš„è¯ä¼šçŸ¥é“ï¼ŒNSObjectçš„å…ƒç±»å¯¹è±¡ä¸º Meta NSObject Class Objectï¼ˆæˆ‘ä»¬æš‚ä¸”è¿™ä¹ˆå«ï¼‰ ã€‚ å›žåˆ°isKindOfClass çš„å®žçŽ°ä»£ç é‡Œï¼Œå¾ªçŽ¯ä¼šå…ˆèŽ·å–åˆ°NSObjectçš„å…ƒç±»å¯¹è±¡å³tclsï¼Œç„¶åŽè·ŸNSObjectç±»å¯¹è±¡(cls)ä½œæ¯”è¾ƒ,æ­¤æ—¶å…ƒç±»å¯¹è±¡ä¸ç­‰äºŽç±»å¯¹è±¡ï¼Œç»§ç»­å¾ªçŽ¯ï¼Œæ‰¾åˆ°tcls-&gt;superclass,è¿˜æ˜¯å¾—ç†Ÿæ‚‰OCçš„å¯¹è±¡æ¨¡åž‹ï¼ŒNSObject å…ƒç±»å¯¹è±¡çš„super å°±æ˜¯NSObject ï¼Œæ²¡é”™å°±æ˜¯å®ƒï¼Œæ­¤æ—¶ tcls å°±æ˜¯ NSObject ç±»å¯¹è±¡ï¼Œcls ä¹Ÿæ˜¯NSObject ç±»å¯¹è±¡ï¼Œæ‰€ä»¥tcls ç­‰äºŽcls ï¼Œæ­¤æ—¶å¾ªçŽ¯ç»“æŸï¼Œè¿”å›žYesã€‚ åˆ°è¿™é‡Œä¸çŸ¥é“å„ä½çœ‹å®˜æ˜¯å¦æ˜Žç™½æ˜¯æ€Žä¹ˆå›žäº‹äº†å‘¢ï¼Ÿ ä¸‹é¢é™„ä¸ŠisMemberOfClass çš„æºç å®žçŽ° å›¾5 å›¾5å¤§å®¶å¯ä»¥é€šè¿‡ä¸Šé¢isKindOfClass çš„åˆ†æžï¼Œä»¥åŠæˆ‘æä¾›çš„æºç æˆªå›¾ï¼Œå¯ä»¥åˆ†æžä¸€ä¸‹å…¶ä»–ä¸‰ç§res2,res3ï¼Œres4çš„ç»“æžœä¸ºä»€ä¹ˆå…¨æ˜¯0ã€‚ æ‰ç–å­¦æµ…ï¼Œæ¬¢è¿Žå¤§å®¶å‹˜è¯¯ã€‚å¤šå¤šäº¤æµï¼Œäº’ç›¸å­¦ä¹ ï¼]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>Objective-C</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Objective-Cä¸­çš„ç±»å’Œå…ƒç±»]]></title>
    <url>%2F2018%2F07%2F23%2FObjective-C%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%92%8C%E5%85%83%E7%B1%BB%2F</url>
    <content type="text"><![CDATA[ä½ çœŸçš„çŸ¥é“OCçš„ç±»ï¼ˆClassï¼‰æ˜¯ä¸ªä»€ä¹ˆçŽ©æ„å„¿ï¼Ÿ ä¼—æ‰€å‘¨çŸ¥ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ç”±å…¶å¯¹åº”çš„ç±»å®žä¾‹åŒ–è€Œæ¥ï¼Œä½†æ˜¯ç±»æœ¬èº«å…¶å®žä¹Ÿæ˜¯ä¸€ç§å¯¹è±¡ï¼Œsurpriseï¼Ÿä¸‹é¢æˆ‘ä»¬å°±æ¥æ‹¨å¼€è¿™å±‚è¿·é›¾ã€‚ ç±»åœ¨Objective-Cä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°çš„å‡ ä¹Žæ‰€æœ‰ç±»éƒ½æ˜¯NSObjectç±»çš„å­ç±»ï¼ŒæŸ¥é˜…objcæºç ä½ ä¼šå‘çŽ° NSObjectç±»å®šä¹‰ï¼ˆå¦‚å›¾1ï¼‰æˆ‘ä»¬è¿™é‡Œåªç»™å‡ºå®šä¹‰å…¶ä»–æ–¹æ³•å¤§å®¶è‡ªè¡ŒæŸ¥é˜…ã€‚ å›¾1çœ‹å®Œè¿™ä¸ª,é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šè¿™ä¸ªClass ç±»åž‹çš„ isa æ˜¯ä¸ªä»€ä¹ˆçŽ©æ„å„¿ï¼ŸClass åˆæ˜¯ä¸ªä»€ä¹ˆç±»åž‹ï¼Ÿå¸¦ç€è¿™ä¸¤ä¸ªç–‘é—®æˆ‘ä»¬æŸ¥é˜…ä¸€ä¸‹objc.hä¸­Class çš„å®šä¹‰ï¼ˆå¦‚å›¾2ï¼‰ å›¾2çœ‹å®Œè¿™ä¸ªæ˜¯ä¸æ˜¯åˆä¸€è„¸æ‡µé€¼ï¼Class è¢«å®šä¹‰ä¸ºä¸€ä¸ªæŒ‡å‘objc_class çš„ç»“æž„ä½“æŒ‡é’ˆã€‚é‚£ä¹ˆobjc_class åˆæ˜¯ä¸ªä»€ä¹ˆçŽ©æ„å„¿ï¼Ÿæˆ‘ä»¬æŽ¥ç€çœ‹æºç runtime.hä¸­å®šä¹‰ï¼ˆå¦‚å›¾3ï¼‰ å›¾3ä½ ä¼šå‘çŽ°ï¼Œæˆ‘è‰¹ï¼Œæ€Žä¹ˆåˆä¸€ä¸ªisa! ä¸‹é¢æˆ‘ä»¬æ¥è§£ç­”è¿™ä¸ªç–‘æƒ‘ã€‚ å…¶å®žåœ¨Objective-Cä¸­ä»»ä½•çš„ç±»å®šä¹‰éƒ½æ˜¯å¯¹è±¡ã€‚å³åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™ä»»ä½•ç±»å®šä¹‰éƒ½å¯¹åº”äºŽä¸€å—å†…å­˜ã€‚åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šç»™æ¯ä¸€ä¸ªç±»ç”Ÿæˆä¸€ä¸ªä¸”åªç”Ÿæˆä¸€ä¸ªâ€æè¿°å…¶å®šä¹‰çš„å¯¹è±¡â€,ä¹Ÿå°±æ˜¯è‹¹æžœå…¬å¸è¯´çš„ç±»å¯¹è±¡(class object),ä»–æ˜¯ä¸€ä¸ªå•ä¾‹(singleton), è€Œæˆ‘ä»¬åœ¨å…¶ä»–é¢å‘å¯¹è±¡è¯­è¨€ä¸­æ‰€è°“çš„å¯¹è±¡ï¼Œå«åšå®žä¾‹å¯¹è±¡(instance object)ã€‚å¯¹äºŽå®žä¾‹å¯¹è±¡æˆ‘ä»¬ä¸éš¾ç†è§£ï¼Œä½†ç±»å¯¹è±¡(class object)æ˜¯ä¸ªä»€ä¹ˆé¬¼ï¼Ÿæˆ‘ä»¬çŸ¥é“Objective-Cæ˜¯é—¨å¾ˆåŠ¨æ€çš„è¯­è¨€ï¼Œå› æ­¤ç¨‹åºé‡Œçš„æ‰€æœ‰å®žä¾‹å¯¹è±¡(instace object)éƒ½æ˜¯åœ¨è¿è¡Œæ—¶ç”±Objective-Cçš„è¿è¡Œæ—¶åº“ç”Ÿæˆçš„ï¼Œè€Œè¿™ä¸ªç±»å¯¹è±¡(class object)å°±æ˜¯è¿è¡Œæ—¶åº“ç”¨æ¥åˆ›å»ºå®žä¾‹å¯¹è±¡(instance object)çš„ä¾æ®ã€‚ é€šè¿‡ä¸Šé¢çš„è®¨è®ºï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼Œä¸ç®¡æ˜¯å®žä¾‹å¯¹è±¡ï¼Œç±»å¯¹è±¡ï¼Œå…¶ç»“æž„ä¸­éƒ½æœ‰ä¸€ä¸ªisaã€‚å®žä¾‹å¯¹è±¡ä¸­çš„isa æŒ‡é’ˆæŒ‡å‘çš„æ˜¯ è¯¥å®žä¾‹çš„ç±»å¯¹è±¡ï¼Œé‚£ä¹ˆåŒç†ï¼Œç±»å¯¹è±¡çš„isa æŒ‡å‘çš„æ˜¯è°å‘¢ï¼Ÿè¿™å°±æ˜¯ å…ƒç±»å¯¹è±¡ï¼ˆmeta class objectï¼‰ã€‚ä»–ä»¬ä¹‹é—´çš„å…³ç³»çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼ˆå¦‚å›¾4ï¼‰ï¼š å›¾4&gt;ç±»å¯¹è±¡ç±»å¯¹è±¡çš„æœ¬è´¨é€šè¿‡å‰æ–‡æˆ‘ä»¬äº†è§£åˆ°ï¼Œç±»å¯¹è±¡æ˜¯ç¼–è¯‘å™¨ç”Ÿæˆçš„â€œæè¿°ç±»å®šä¹‰çš„å¯¹è±¡â€ï¼Œå°±æ˜¯åœ¨ç¼–è¯‘æ—¶çš„ç±»ã€‚ä»»ä½•ç›´æŽ¥æˆ–è€…é—´æŽ¥ç»§æ‰¿NSObjectçš„ç±»ï¼Œå®ƒçš„å®žä¾‹å¯¹è±¡ï¼ˆinstance objectï¼‰ä¸­éƒ½æœ‰ä¸€ä¸ªisa æŒ‡é’ˆï¼ŒæŒ‡å‘å®ƒçš„ç±»å¯¹è±¡(class object)ã€‚è¿™ä¸ªç±»å¯¹è±¡(class object)ä¸­å­˜å‚¨äº†å…³äºŽè¿™ä¸ªå®žä¾‹å¯¹è±¡(instace object)æ‰€å±žçš„ç±»çš„å®šä¹‰çš„ä¸€åˆ‡ï¼šåŒ…æ‹¬å˜é‡ï¼Œæ–¹æ³•ï¼Œéµå®ˆçš„åè®®ç­‰ç­‰ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡ï¼ˆå›¾3ï¼‰æ¥ä½è¯ã€‚å› æ­¤ï¼Œç±»å¯¹è±¡èƒ½è®¿é—®æ‰€æœ‰å…³äºŽè¿™ä¸ªç±»çš„ä¿¡æ¯ï¼Œåˆ©ç”¨è¿™äº›ä¿¡æ¯å¯ä»¥äº§ç”Ÿä¸€ä¸ªæ–°çš„å®žä¾‹ï¼Œä½†æ˜¯ç±»å¯¹è±¡ä¸èƒ½è®¿é—®ä»»ä½•å®žä¾‹å¯¹è±¡çš„å†…å®¹ã€‚å½“ä½ è°ƒç”¨ä¸€ä¸ª â€œç±»æ–¹æ³•â€ ä¾‹å¦‚ [NSObject alloc],ä½ äº‹å®žä¸Šæ˜¯å‘é€äº†ä¸€ä¸ªæ¶ˆæ¯ç»™ä»–çš„ç±»å¯¹è±¡ã€‚æ‰€è°“ä¸€åˆ‡çš†å¯¹è±¡å°±æ˜¯è¿™ä¸ªæ„æ€ã€‚ é‚£ä¹ˆç±»å¯¹è±¡ä¸Žå®žä¾‹å¯¹è±¡æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿå°½ç®¡ç±»å¯¹è±¡ä¿ç•™äº†ä¸€ä¸ªç±»å®žä¾‹çš„åŽŸåž‹ï¼Œä½†å®ƒå¹¶ä¸æ˜¯å®žä¾‹æœ¬èº«ã€‚å®ƒæ²¡æœ‰è‡ªå·±çš„å®žä¾‹å˜é‡ï¼Œä¹Ÿä¸èƒ½æ‰§è¡Œé‚£äº›ç±»çš„å®žä¾‹çš„æ–¹æ³•ï¼ˆåªæœ‰å®žä¾‹å¯¹è±¡æ‰å¯ä»¥æ‰§è¡Œå®žä¾‹æ–¹æ³•ï¼‰ã€‚ç„¶è€Œï¼Œç±»çš„å®šä¹‰èƒ½åŒ…å«é‚£äº›ç‰¹æ„ä¸ºç±»å¯¹è±¡å‡†å¤‡çš„æ–¹æ³•â€“ç±»æ–¹æ³•ï¼ˆ è€Œä¸æ˜¯çš„å®žä¾‹æ–¹æ³•ï¼‰ã€‚ç±»å¯¹è±¡ä»Žçˆ¶ç±»é‚£é‡Œç»§æ‰¿ç±»æ–¹æ³•ï¼Œå°±åƒå®žä¾‹ä»Žçˆ¶ç±»é‚£é‡Œç»§æ‰¿å®žä¾‹æ–¹æ³•ä¸€æ ·ã€‚ ç±»å¯¹è±¡æ˜¯ä¸æ˜¯å°±æ˜¯ç±»åï¼Ÿåªæœ‰åœ¨æ¶ˆæ¯è¡¨è¾¾å¼ä¸­ä½œä¸ºæŽ¥æ”¶è€…ï¼Œç±»åæ‰ä»£è¡¨ç±»å¯¹è±¡ã€‚æˆ‘ç†è§£ä¸ºè°ƒç”¨é™æ€æ–¹æ³•çš„æ—¶å€™ã€‚ å…ƒç±»å¯¹è±¡å…ƒç±»å¯¹è±¡çš„å®žè´¨å®žé™…ä¸Šï¼Œç±»å¯¹è±¡æ˜¯å…ƒç±»å¯¹è±¡çš„ä¸€ä¸ªå®žä¾‹ã€‚å…ƒç±»æè¿°äº† ä¸€ä¸ªç±»å¯¹è±¡ï¼Œå°±åƒç±»å¯¹è±¡æè¿°äº†æ™®é€šå¯¹è±¡ä¸€æ ·ã€‚ä¸åŒçš„æ˜¯å…ƒç±»çš„æ–¹æ³•åˆ—è¡¨æ˜¯ç±»æ–¹æ³•çš„é›†åˆï¼Œç”±ç±»å¯¹è±¡çš„é€‰æ‹©å™¨æ¥å“åº”ã€‚å½“å‘ä¸€ä¸ªç±»å‘é€æ¶ˆæ¯æ—¶ï¼Œobjc_msgSendä¼šé€šè¿‡ç±»å¯¹è±¡çš„isaæŒ‡é’ˆå®šä½åˆ°å…ƒç±»ï¼Œå¹¶æ£€æŸ¥å…ƒç±»çš„æ–¹æ³•åˆ—è¡¨ï¼ˆåŒ…æ‹¬çˆ¶ç±»ï¼‰æ¥å†³å®šè°ƒç”¨å“ªä¸ªæ–¹æ³•ã€‚å…ƒç±»ä»£æ›¿äº†ç±»å¯¹è±¡æè¿°äº†ç±»æ–¹æ³•ï¼Œå°±åƒç±»å¯¹è±¡ä»£æ›¿äº†å®žä¾‹å¯¹è±¡æè¿°äº†å®žä¾‹åŒ–æ–¹æ³•ä¸€æ ·ã€‚ å¾ˆæ˜¾ç„¶ï¼Œå…ƒç±»ä¹Ÿæ˜¯å¯¹è±¡ï¼Œä¹Ÿåº”è¯¥æ˜¯å…¶ä»–ç±»çš„å®žä¾‹ï¼Œå®žé™…ä¸Šå…ƒç±»æ˜¯æ ¹å…ƒç±»(root classâ€™s metaclass)çš„å®žä¾‹,è€Œæ ¹å…ƒç±»æ˜¯å…¶è‡ªèº«çš„å®žä¾‹ï¼Œå³æ ¹å…ƒç±»çš„isaæŒ‡é’ˆæŒ‡å‘è‡ªèº«ã€‚ ç±»çš„super_classæŒ‡å‘å…¶çˆ¶ç±»ï¼Œè€Œå…ƒç±»çš„super_classåˆ™æŒ‡å‘çˆ¶ç±»çš„å…ƒç±»ã€‚å…ƒç±»çš„super classé“¾ä¸Žç±»çš„super classé“¾å¹³è¡Œï¼Œæ‰€ä»¥ç±»æ–¹æ³•çš„ç»§æ‰¿ä¸Žå®žä¾‹æ–¹æ³•çš„ç»§æ‰¿ä¹Ÿæ˜¯å¹¶è¡Œçš„ã€‚è€Œæ ¹å…ƒç±»(root classâ€™s metaclass)çš„super_classæŒ‡å‘æ ¹ç±»(root class)ï¼Œè¿™æ ·ï¼Œæ•´ä¸ªisaæŒ‡é’ˆé“¾å°±æ˜¯ä¸€ä¸ªé—­çŽ¯ã€‚ è®°ä½ï¼Œå½“ä¸€ä¸ªæ¶ˆæ¯å‘é€ç»™ä»»ä½•ä¸€ä¸ªå¯¹è±¡ï¼Œ æ–¹æ³•çš„æ£€æŸ¥ ä»Žå¯¹è±¡çš„ isa æŒ‡é’ˆå¼€å§‹ï¼Œç„¶åŽæ˜¯çˆ¶ç±»ã€‚å®žä¾‹æ–¹æ³•åœ¨ç±»ä¸­å®šä¹‰ï¼Œ ç±»æ–¹æ³• åœ¨å…ƒç±»å’Œæ ¹ç±»ä¸­å®šä¹‰ã€‚ï¼ˆæ ¹ç±»çš„å…ƒç±»å°±æ˜¯æ ¹ç±»è‡ªå·±ï¼‰ã€‚åœ¨ä¸€äº›è®¡ç®—æœºè¯­è¨€çš„åŽŸç†ä¸­ï¼Œä¸€ä¸ªç±»å’Œå…ƒç±»å±‚æ¬¡ç»“æž„å¯ä»¥æ›´è‡ªç”±çš„ç»„æˆï¼Œæ›´æ·±å…ƒç±»é“¾å’Œä»Žå•ä¸€çš„å…ƒç±»ç»§æ‰¿çš„æ›´å¤šçš„å®žä¾‹åŒ–çš„ç±»ã€‚Objective-C çš„ç±»æ–¹æ³• æ˜¯ä½¿ç”¨å…ƒç±»çš„æ ¹æœ¬åŽŸå› ï¼Œåœ¨å…¶ä»–æ–¹é¢è¯•å›¾åœ¨éšè—å…ƒç±»ã€‚ä¾‹å¦‚ [NSObject class] å®Œå…¨ç›¸ç­‰äºŽ [NSObject self]ï¼Œæ‰€ä»¥ï¼Œåœ¨å½¢å¼ä¸Šä»–è¿˜æ˜¯è¿”å›žçš„ NSObject-&gt;isa æŒ‡å‘çš„å…ƒç±»ã€‚ Objective-Cè¯­è¨€æ˜¯ä¸€ç»„å®žç”¨çš„æŠ˜ä¸­æ–¹æ¡ˆã€‚ä¸‹å›¾è¡¨ç¤ºäº†å¯¹è±¡é—´çš„isaçš„å…³ç³»ï¼Œä»¥åŠç±»çš„ç»§æ‰¿å…³ç³»ï¼š å›¾ç‰‡æ¥è‡ªç½‘ç»œï¼ˆå›¾5ï¼‰ç»¼ä¸Šæ‰€è¿°ï¼Œç±»å¯¹è±¡(class object)ä¸­åŒ…å«äº†ç±»çš„å®žä¾‹å˜é‡ï¼Œå®žä¾‹æ–¹æ³•çš„å®šä¹‰ï¼Œè€Œå…ƒç±»å¯¹è±¡(metaclass object)ä¸­åŒ…æ‹¬äº†ç±»çš„ç±»æ–¹æ³•(ä¹Ÿå°±æ˜¯C++ä¸­çš„é™æ€æ–¹æ³•)çš„å®šä¹‰ã€‚ç±»å¯¹è±¡å’Œå…ƒç±»å¯¹è±¡ä¸­å½“ç„¶è¿˜ä¼šåŒ…å«ä¸€äº›å…¶å®ƒçš„ä¸œè¥¿ï¼Œè‹¹æžœä»¥åŽä¹Ÿå¯èƒ½æ·»åŠ å…¶å®ƒçš„å†…å®¹ï¼Œä½†å¯¹äºŽæˆ‘ä»¬åªéœ€è¦è®°ä½ï¼šç±»å¯¹è±¡å­˜çš„æ˜¯å…³äºŽå®žä¾‹å¯¹è±¡çš„ä¿¡æ¯(å˜é‡ï¼Œå®žä¾‹æ–¹æ³•ç­‰)ï¼Œè€Œå…ƒç±»å¯¹è±¡(metaclass object)ä¸­å­˜å‚¨çš„æ˜¯å…³äºŽç±»çš„ä¿¡æ¯(ç±»çš„ç‰ˆæœ¬ï¼Œåå­—ï¼Œç±»æ–¹æ³•ç­‰)ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œç±»å¯¹è±¡(class object)å’Œå…ƒç±»å¯¹è±¡(metaclass object)çš„å®šä¹‰éƒ½æ˜¯objc_classç»“æž„ï¼Œå…¶ä¸åŒä»…ä»…æ˜¯åœ¨ç”¨é€”ä¸Šï¼Œæ¯”å¦‚å…¶ä¸­çš„æ–¹æ³•åˆ—è¡¨åœ¨ç±»å¯¹è±¡(instance object)ä¸­ä¿å­˜çš„æ˜¯å®žä¾‹æ–¹æ³•(instance method)ï¼Œè€Œåœ¨å…ƒç±»å¯¹è±¡(metaclass object)ä¸­åˆ™ä¿å­˜çš„æ˜¯ç±»æ–¹æ³•(class method)ã€‚ å†™äº†è¿™ä¹ˆå¤šä¸çŸ¥é“èƒ½å¤Ÿæ‹¨å¼€æ‚¨å¿ƒä¸­çš„è¿·é›¾å‘¢ï¼Ÿæ¬¢è¿Žå¤§å®¶å‹˜è¯¯ï¼Œäº’ç›¸å­¦ä¹ ï¼]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>Objective-C</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨ Intellij IDEA åˆ›å»ºä¸€ä¸ªç®€å•çš„SpringBooté¡¹ç›®]]></title>
    <url>%2F2018%2F07%2F23%2F%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E7%94%A8-Intellij-IDEA-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84SpringBoot%E9%A1%B9%E7%9B%AE%2F</url>
    <content type="text"><![CDATA[æ–°å»ºProject é»˜è®¤é€‰ä¸­ Default ç‚¹å‡»ä¸‹å›¾çš„Next æŒ‰é’® å¡«å†™Groupã€Artifact Package é‚£ä¸€æ å’ŒGroup ä¿æŒä¸€è‡´å°±å¥½ï¼Œå¦‚æžœæ˜¯com.jack.springtestçš„è¯ä¼šå¯¼è‡´ WhiteLabel Error Page å¼‚å¸¸ é€‰ä¸­Web é€‰é¡¹ ç„¶åŽç‚¹å‡»Next æŒ‰é’® ç„¶åŽç‚¹å‡»Finish æŒ‰é’® å·¥ç¨‹ç»“æž„å¦‚ä¸‹ï¼š åœ¨jack package ä¸‹æ–°å»ºâ€controllerâ€ package,åœ¨controller ä¸‹æ–°å»ºTestController.java,å¹¶æ·»åŠ å¦‚ä¸‹å›¾ä¸­çš„ä»£ç ï¼š æ­¤æ—¶ç‚¹å‡»è¿è¡ŒæŒ‰é’® åœ¨åœ°å€æ è¾“å…¥ï¼šhttp://localhost:8080/hello ä¼šæœ‰å¦‚ä¸‹å›¾è¾“å‡º é…ç½®ç«¯å£å· å’Œ è®¿é—®è·¯å¾„ å†æ¬¡è¿è¡Œ åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ http://localhost:8081/springboot/hello ä¼šæœ‰ä¸Šé¢åŒæ ·çš„è¾“å‡ºã€‚]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Macç»ˆç«¯è£…é€¼åˆ©å™¨ zsh]]></title>
    <url>%2F2018%2F07%2F21%2FMac%E7%BB%88%E7%AB%AF%E8%A3%85%E9%80%BC%E5%88%A9%E5%99%A8-zsh%2F</url>
    <content type="text"><![CDATA[æˆ‘åœ¨ä½¿ç”¨macç»ˆç«¯æ‰§è¡Œå„ç§å‘½ä»¤çš„æ—¶å€™ï¼Œå§‹ç»ˆæ„Ÿè§‰ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œæ¯”å¦‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­æ‰§è¡Œgit å‘½ä»¤çš„æ—¶å€™ä¸æ¸…æ¥šå½“å‰æ˜¯æ˜¯ä»€ä¹ˆåˆ†æ”¯ï¼Œå¾—åå¤çš„git branch æŸ¥çœ‹ï¼›è¾“å…¥æ–‡ä»¶å¤¹åç§°æ—¶å€™è¿˜è¦åŒºåˆ†å¤§å°å†™ï¼Œtab é”®æ‰èƒ½è”æƒ³ã€‚ã€‚ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¸€ç•ªgoogle,åŽŸæ¥æœ‰è¿™ä¹ˆå¥½ç”¨çš„å·¥å…· â€” zsh ä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹zshæ˜¯å¦‚ä½•åœ¨macç»ˆç«¯ä¸Šé¢è£…é€¼çš„ã€‚å…¶å®žzsh ä¹Ÿæ˜¯ä¸€ç§sheel,ä½†æ˜¯å¹¶ä¸æ˜¯æˆ‘ä»¬ç³»ç»Ÿé»˜è®¤çš„ shell ,unix è¡ç”Ÿç³»ç»Ÿçš„é»˜è®¤shell éƒ½æ˜¯ bash. æŸ¥çœ‹å·²å®‰è£…çš„shell1cat /etc/shells å¯ä»¥çœ‹åˆ°æ€»å…±å…­ç§123456/bin/bash/bin/csh/bin/ksh/bin/sh/bin/tcsh/bin/zsh å°†é»˜è®¤shellæ”¹æˆzsh1chsh -s /bin/zsh å®‰è£… oh my zshæ‰‹åŠ¨å®‰è£…ï¼šä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤12git clone git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zshcp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc é…ç½®zshæ‰“å¼€é…ç½®æ–‡ä»¶1vim ~/.zshrc è®¾ç½®ä¸€äº›å¸¸ç”¨å‘½ä»¤çš„åˆ«å12345alias zshconfig=&apos;vi ~/.zshrc&apos;alias vimconfig=&apos;vi ~/.vimrc&apos;alias ll=&apos;ls -l&apos;alias vi=&apos;vim&apos;alias xcode=&apos;open -a &quot;Xcode&quot;&apos; å¯ç”¨å‘½ä»¤çº é”™åŠŸèƒ½1ENABLE_CORRECTION=&quot;true&quot; æ’ä»¶123git osxautojump åªéœ€è¦åœ¨.zshvrä¸­å¯ç”¨1plugins=(git osx autojump) åˆ°è¿™é‡Œä½ å¯ä»¥é‡å¯ä¸€ä¸‹ä½ çš„ç»ˆç«¯çœ‹ä¸€ä¸‹æ•ˆæžœ å†çœ‹ä¸€ä¸‹gitæ•ˆæžœ æœ‰æ²¡æœ‰å¾ˆæƒŠè‰³ï¼ shellçš„é¢œè‰²é…ç½®åŽ»github ä¸Šé¢æœç´¢solarizedç„¶åŽclone åˆ°æœ¬åœ°ï¼Œæ‰¾åˆ°å¯¹åº”çš„ä¸»é¢˜æ¯”å¦‚æˆ‘ä»¬ç”¨çš„æ˜¯Terminalç»ˆç«¯(Mac OSXè‡ªå¸¦),å°±æ‰¾åˆ°osx-terminal.app-colors-solarizedä¸‹çš„ä¸‰ä¸ªæ–‡ä»¶,åŒå‡»å®‰è£…å³å¯ã€‚ å¦‚ä½•åˆ‡æ¢é¢œè‰²æ‰“å¼€ç»ˆç«¯çš„åå¥½è®¾ç½®æŒ‰ç…§ä¸‹å›¾æ“ä½œå³å¯ï¼š okï¼Œå†™åˆ°è¿™é‡Œzshçš„åŸºæœ¬çŽ©æ³•å°±ç»“æŸäº†ï¼æ¬¢è¿Žå¤§å®¶å‹˜è¯¯ï¼]]></content>
      <categories>
        <category>æŠ€æœ¯äººç”Ÿ</category>
      </categories>
      <tags>
        <tag>tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mac OS X - é‡ç½® MySQL Root å¯†ç ]]></title>
    <url>%2F2018%2F07%2F21%2FMac%20OS%20X%20-%20%E9%87%8D%E7%BD%AE%20MySQL%20Root%20%E5%AF%86%E7%A0%81%2F</url>
    <content type="text"><![CDATA[ä¸€ï¼šæ‚¨æ˜¯å¦å¿˜è®°äº†Mac OS çš„MySQLçš„rootå¯†ç ? é€šè¿‡ä»¥ä¸‹4æ­¥å°±å¯é‡æ–°è®¾ç½®æ–°å¯†ç ï¼š1. åœæ­¢ mysql server. é€šå¸¸æ˜¯åœ¨ â€˜ç³»ç»Ÿåå¥½è®¾ç½®â€™ &gt; MySQL &gt; â€˜Stop MySQL Serverâ€™2. æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ï¼š1$ sudo /usr/local/mysql/bin/mysqld_safe --skip-grant-tables 3. æ‰“å¼€å¦ä¸€ä¸ªæ–°ç»ˆç«¯ï¼Œä¾æ¬¡è¾“å…¥:1$ sudo /usr/local/mysql/bin/mysql -u root 1$ UPDATE mysql.user SET authentication_string=PASSWORD('æ–°å¯†ç ') WHERE User='root'; 1$ FLUSH PRIVILEGES; 1$ \q 4. é‡å¯MySQL.*ä»¥ä¸Šæ–¹æ³•é’ˆå¯¹ MySQL V5.7.9, æ—§ç‰ˆçš„mysqlè¯·ä½¿ç”¨ï¼šUPDATE mysql.user SET Password=PASSWORD(â€˜æ–°å¯†ç â€™) WHERE User=â€™rootâ€™; äºŒï¼šå®‰è£…å®Œmysql ä¹‹åŽï¼Œç™»é™†ä»¥åŽï¼Œä¸ç®¡è¿è¡Œä»»ä½•å‘½ä»¤ï¼Œæ€»æ˜¯æç¤ºè¿™ä¸ªï¼šmac mysql error You must reset your password using ALTER USER statement before executing this statement.12345step 1: SET PASSWORD = PASSWORD('your new password');step 2: ALTER USER 'root'@'localhost' PASSWORD EXPIRE NEVER;step 3: flush privileges; å®Œæˆä»¥ä¸Šä¸‰æ­¥é€€å‡ºå†ç™»ï¼Œä½¿ç”¨æ–°è®¾ç½®çš„å¯†ç å°±è¡Œäº†ï¼Œä»¥ä¸Šé™¤äº†çº¢è‰²çš„è‡ªå·±ä¿®æ”¹æˆæ–°å¯†ç å¤–ï¼Œå…¶ä»–åŽŸæ ·è¾“å…¥å³å¯ 12345å‚è€ƒ1: https://dev.mysql.com/doc/refman/5.6/en/alter-user.htmlå‚è€ƒ2: http://dev.mysql.com/doc/refman/5.7/en/password-expiration-policy.htmlå‚è€ƒ3: http://stackoverflow.com/questions/33467337/reset-mysql-root-password-using-alter-user-statement-after-install-on-mac]]></content>
      <categories>
        <category>MySql</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[hexoå¿«é€Ÿæ­å»ºä¸ªäººåšå®¢]]></title>
    <url>%2F2018%2F07%2F21%2Fhexo%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%2F</url>
    <content type="text"><![CDATA[Hexo æ˜¯é«˜æ•ˆçš„é™æ€ç½‘ç«™ç”Ÿæˆæ¡†æž¶ï¼Œå®ƒåŸºäºŽNode.js,é€šè¿‡ç¼–è¾‘markdownæ–‡ä»¶æ¥ç”Ÿæˆå¯¹åº”çš„htmlé¡µé¢ã€‚ å‡†å¤‡å·¥ä½œé¦–å…ˆå®‰è£…node.jsã€å®‰è£…Gitã€æ³¨å†Œä¸€ä¸ªgithubè´¦å·ã€‚ å¼€å§‹æ­å»ºåšå®¢å¼€å¯github pagesæœåŠ¡åœ¨GitHubä¸Šé¢æ–°å»ºä¸€ä¸ªä»“åº“å¦‚ï¼šusername.github.io è¿™ä¸ªè¿‡ç¨‹å’Œå»ºç«‹æ™®é€šçš„ä»“åº“æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå…³é”®åœ¨äºŽæ–°ä»“åº“çš„åå­—ï¼Œä¸€å®šè¦æ˜¯username+â€œgithub.ioâ€çš„å½¢å¼ã€‚è¿™ä¹Ÿæ˜¯ä¹‹å‰å¼ºè°ƒçš„è¦èµ·ä¸€ä¸ªå¥½çš„ç”¨æˆ·åçš„åŽŸå› ã€‚è¿™æ ·ä¹‹åŽæˆ‘ä»¬æœ€åŽçš„åšå®¢ç½‘ç«™çš„é“¾æŽ¥å°±ä¼šæ˜¯ï¼šhttps://username.github.ioçš„å½¢å¼ã€‚ å®‰è£…hexo:ä»¥ä¸Šæ‰€æœ‰éƒ½å®‰è£…å®Œæˆä¹‹åŽå†å®‰è£…hexo.1sudo npm install hexo-cli -g æ‰€æœ‰å¿…é¡»å·¥å…·å·²ç»å®‰è£…å®Œæˆ,æŽ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ç”Ÿæˆåšå®¢ï¼Œä¸Šä¼ è‡³æˆ‘ä»¬çš„github ä»“åº“äº†ã€‚ åˆ›å»ºæœ¬åœ°åšå®¢æ‰¾ä¸€ä¸ªåˆé€‚çš„ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š1hexo init CharlesBlog å®‰è£…ä¸»é¢˜è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ä¸€ä¸ªæ¯”è¾ƒæµè¡Œçš„ä¸»é¢˜:nextæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…ï¼š12cd CharlesBloggit clone https://github.com/iissnan/hexo-theme-next themes/next åŸºç¡€é…ç½®ï¼šæ‰“å¼€æ–‡ä»¶ä½ç½®CharlesBlog/_config.ymlä¿®æ”¹å‡ ä¸ªé”®å€¼å¯¹ï¼Œä¸‹é¢æŠŠå‡ ä¸ªå¿…é¡»è®¾ç½®çš„åˆ—å‡ºæ¥æŒ‰éœ€æ±‚ä¿®æ”¹ï¼Œè®°å¾—ä¿å­˜ï¼Œ è¿˜æœ‰æ³¨æ„é…ç½®çš„é”®å€¼ä¹‹é—´ä¸€å®šè¦æœ‰ç©ºæ ¼ã€‚title: CharlesBlog //ä½ åšå®¢çš„åå­—author: Charles //ä½ çš„åå­—language: zh-Hans //è¯­è¨€ ä¸­æ–‡theme: next //åˆšåˆšå®‰è£…çš„ä¸»é¢˜åç§°deploy:type: gitrepository: git@github.com:icloud-art/icloud-art.github.io.gitbranch: masterä¸»é¢˜é…ç½®ï¼šä¸»é¢˜é…ç½®æ–‡ä»¶åœ¨username.github.io/themes/next/_config.ymlä¸­ä¿®æ”¹ï¼Œæ­¤å¤„ä¸åšè¯¦ç»†è¯´æ˜Žã€‚ æ–°å»ºä¸€ç¯‡åšå®¢è¿›å…¥CharlesBlogç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š1hexo new testblog ä¹‹åŽä¼šåœ¨_postç›®å½•ä¸‹é¢ç”Ÿæˆä¸€ä¸ªtestblog.mdæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å°±æ˜¯ç”¨æ¥ç”Ÿæˆå¯¹åº”çš„htmlé¡µé¢ã€‚ æµ‹è¯•testblogæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š123hexo cleanhexo ghexo s ç„¶åŽå†æµè§ˆå™¨ä¸­è¾“å…¥https://localhost:4000 å°±å¯ä»¥çœ‹åˆ°åˆšæ‰åˆ›å»ºçš„åšæ–‡äº†ï¼ˆæ²¡é”™ï¼Œå°±æ˜¯testblogï¼‰ã€‚ å®‰è£…hexo-deployer-gitè‡ªåŠ¨éƒ¨ç½²å‘å¸ƒå·¥å…·æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š1npm install hexo-deployer-git --save å‘å¸ƒå·¥å…·å®‰è£…å¥½ä¹‹åŽå°±å¯ä»¥ä½¿ç”¨1hexo d å‘½ä»¤æ¥å‘å¸ƒä½ çš„åšæ–‡åˆ°GitHub.ioå½“ç„¶å®Œæˆçš„å‘å¸ƒæµç¨‹æ˜¯è¿™æ ·çš„ï¼š1hexo clean 1hexo g 1hexo d å¥½ï¼Œåˆ°è¿™é‡Œä½ å¯ä»¥é€šè¿‡githubçš„åŸŸåæ¥è®¿é—®ä½ çš„åšæ–‡äº†ã€‚ æ—¶é—´æœ‰é™ï¼Œæœ¬æ–‡åªæ˜¯ç®€å•çš„ä»‹ç»äº†çš„åšå®¢åˆ›å»ºæµç¨‹ï¼Œè¿˜æœ‰å¾ˆå¤šå¾ˆå¥½çŽ©çš„é…ç½®ä¸Žæ’ä»¶ã€‚æ¯”å¦‚è¯´è¯„è®ºã€æ ‡ç­¾ã€ç»Ÿè®¡ç­‰ç­‰ã€‚å„ä½çœ‹å®˜æ…¢æ…¢çš„çŽ©èµ·æ¥å§ï¼]]></content>
      <categories>
        <category>æŠ€æœ¯äººç”Ÿ</category>
      </categories>
  </entry>
</search>
